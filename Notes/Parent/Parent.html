<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Class Notes For STT 3850</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>Class Notes For STT 3850</h1>

<h2>Alan T. Arnholt</h2>

<pre><code>Warning: package &#39;e1071&#39; was built under R version 3.0.2
Warning: package &#39;class&#39; was built under R version 3.0.2
Warning: package &#39;MASS&#39; was built under R version 3.0.2
Warning: package &#39;lattice&#39; was built under R version 3.0.2
</code></pre>

<p>Last compiled Thursday, March 20, 2014 - 10:43:50 AM.</p>

<p>Most of the material in the notes is taken from the class text <em>Mathematical Statistics with Resampling and <code>R</code></em> by Laura Chihara and Tim Hesterberg with slight modifications.  Some material in the notes is also taken from the first chapter of <em>Practicing Statistics: Guided Investigations for the Second Course</em> by Shonda Kuiper and Jeffrey Sklar.  There are a number of places to get help with <code>R</code>.  The class text has some material online at: <a href="https://sites.google.com/site/chiharahesterberg/rtutorials">https://sites.google.com/site/chiharahesterberg/rtutorials</a>.  </p>

<h1>Exploratory Data Analysis</h1>

<h2>Reading *.csv Data</h2>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/FlightDelays.csv&quot;
FlightDelays &lt;- read.csv(file = url(site))
head(FlightDelays)  # shows first 6 rows of data frame
</code></pre>

<pre><code>  ID Carrier FlightNo Destination DepartTime Day Month FlightLength Delay Delayed30
1  1      UA      403         DEN      4-8am Fri   May          281    -1        No
2  2      UA      405         DEN     8-Noon Fri   May          277   102       Yes
3  3      UA      409         DEN      4-8pm Fri   May          279     4        No
4  4      UA      511         ORD     8-Noon Fri   May          158    -2        No
5  5      UA      667         ORD      4-8am Fri   May          143    -3        No
6  6      UA      669         ORD      4-8am Fri   May          150     0        No
</code></pre>

<pre><code class="r">str(FlightDelays)  # shows structure of data frame
</code></pre>

<pre><code>&#39;data.frame&#39;:   4029 obs. of  10 variables:
 $ ID          : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Carrier     : Factor w/ 2 levels &quot;AA&quot;,&quot;UA&quot;: 2 2 2 2 2 2 2 2 2 2 ...
 $ FlightNo    : int  403 405 409 511 667 669 673 677 679 681 ...
 $ Destination : Factor w/ 7 levels &quot;BNA&quot;,&quot;DEN&quot;,&quot;DFW&quot;,..: 2 2 2 6 6 6 6 6 6 6 ...
 $ DepartTime  : Factor w/ 5 levels &quot;4-8am&quot;,&quot;4-8pm&quot;,..: 1 4 2 4 1 1 4 4 5 5 ...
 $ Day         : Factor w/ 7 levels &quot;Fri&quot;,&quot;Mon&quot;,&quot;Sat&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
 $ Month       : Factor w/ 2 levels &quot;June&quot;,&quot;May&quot;: 2 2 2 2 2 2 2 2 2 2 ...
 $ FlightLength: int  281 277 279 158 143 150 158 160 160 163 ...
 $ Delay       : int  -1 102 4 -2 -3 0 -5 0 10 60 ...
 $ Delayed30   : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 2 1 1 1 1 1 1 1 2 ...
</code></pre>

<pre><code class="r">levels(FlightDelays$Month)
</code></pre>

<pre><code>[1] &quot;June&quot; &quot;May&quot; 
</code></pre>

<pre><code class="r">FlightDelays$Month &lt;- factor(FlightDelays$Month, levels = c(&quot;May&quot;, &quot;June&quot;))
levels(FlightDelays$Month)
</code></pre>

<pre><code>[1] &quot;May&quot;  &quot;June&quot;
</code></pre>

<h2>Creating Tables</h2>

<pre><code class="r">table(FlightDelays$Carrier)
</code></pre>

<pre><code>
  AA   UA 
2906 1123 
</code></pre>

<pre><code class="r">xtabs(~Carrier, data = FlightDelays)
</code></pre>

<pre><code>Carrier
  AA   UA 
2906 1123 
</code></pre>

<h2>Creating Barplots</h2>

<pre><code class="r">barplot(table(FlightDelays$Carrier))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Barplots" alt="plot of chunk Barplots" style="display: block; margin: auto;" /></p>

<pre><code class="r">require(ggplot2)
ggplot(data = FlightDelays, aes(x = Carrier)) + 
  geom_bar()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Barplots" alt="plot of chunk Barplots" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = FlightDelays, aes(x = Carrier, fill= Month)) + 
  geom_bar()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Barplots" alt="plot of chunk Barplots" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = FlightDelays, aes(x = Carrier, fill= Month)) + 
  geom_bar() + 
  guides(fill = guide_legend(reverse = TRUE))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Barplots" alt="plot of chunk Barplots" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = FlightDelays, aes(x = Carrier, fill= Month)) + 
  geom_bar(position=&quot;dodge&quot;) + 
  guides(fill = guide_legend(reverse = TRUE))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Barplots" alt="plot of chunk Barplots" style="display: block; margin: auto;" /></p>

<pre><code class="r">xtabs(~ Carrier + (Delay &gt; 30), data = FlightDelays)
</code></pre>

<pre><code>       Delay &gt; 30
Carrier FALSE TRUE
     AA  2513  393
     UA   919  204
</code></pre>

<pre><code class="r">addmargins(xtabs(~ Carrier + (Delay &gt; 30), data = FlightDelays))
</code></pre>

<pre><code>       Delay &gt; 30
Carrier FALSE TRUE  Sum
    AA   2513  393 2906
    UA    919  204 1123
    Sum  3432  597 4029
</code></pre>

<pre><code class="r">ggplot(data = FlightDelays, aes(x = Carrier, fill= Delayed30)) + 
  geom_bar(position=&quot;dodge&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Barplots" alt="plot of chunk Barplots" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = FlightDelays, aes(fill = Carrier, x= Delayed30)) + 
  geom_bar(position=&quot;dodge&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Barplots" alt="plot of chunk Barplots" style="display: block; margin: auto;" /></p>

<h2>Histograms of <code>Delay</code> values.</h2>

<pre><code class="r">hist(FlightDelays$Delay)  # Ugly with Defaults...you change
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAnFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVltdpltf2POQCPOTmPOWWPZgCPZo+PtY+P27WP29qP2/21ZgC1Zjm1jzm124+1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v1Dn2RmAAAANHRSTlP///////////////////////////////////////////////////////////////////8AS1ciZQAAAAlwSFlzAAALEgAACxIB0t1+/AAACklJREFUeJztnWubolYWRoOVVLRrOqPVmZ6LdlIzrZMeqSji//9vc25QeIXD5dWna60P3YqHA6zabDZw0B/2IOGHW6/AewHRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQ7UmnAy+gf9G72cN6v88XD2v/qmA179BpNklGy73tNnHMbd8H/dsFvi1pN/PNTtbr0jonyeMmdq4ohhR9MHmVdBFdzH0g+qDF2wJt26AsqcTpFWW+9ThyrjgGj2gTi8nD2gkamz00bIZ5//C/2eMmX4z+YWJ1ayabiN0mP5vp6/QtqHx7N7eJuIrOMqLfenr4NimX5Fdim9h/Ux+kbpJfkOtlazr2K2dePv7x13IXqZ2rFUOL9kHy+KcXvUp86DgbP06sHvvpq2+02SYFQWdof0X0YU9F2yDaBfcqBGllbTapnT5aFm+zyeMf03LV6+Zqp2UI0YUru5JmGzZusl37bGJWczcbLbOJ2aI0cXrGxWwPaxtLJsjmtomdVrY/Th3jUnS1JxuhZmk+dThlRo2bVD1i+LnGdlJl5dyO1myudlqGFu3e2ZWzm791Vs12uBc7nzqWxUxWtDdYTC3bXxZ92JN9cSQ67CU2fO0kv6B8YfaikJNdQ9vv46bZXO2Q5OgkxOQl0a5NKfpN/znRR6mj0pP55Fj06khZsaB9Ovr3ZLovV86Wd2l5hK2bqxWS8m4VVJ1LHXYzU7fXn4o+lzqORFd6OhXtU1FID3ZSsaCyXNwHreOK6EZzRTO06DIaVhcOhnbN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" title="plot of chunk HistoEDA" alt="plot of chunk HistoEDA" style="display: block; margin: auto;" /></p>

<pre><code class="r">library(lattice)
histogram(~Delay, data = FlightDelays)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk HistoEDA" alt="plot of chunk HistoEDA" style="display: block; margin: auto;" /></p>

<pre><code class="r">histogram(~Delay, data = FlightDelays, type = &quot;density&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk HistoEDA" alt="plot of chunk HistoEDA" style="display: block; margin: auto;" /></p>

<pre><code class="r">histogram(~Delay, data = FlightDelays, type = &quot;density&quot;,
          panel = function(...){
            panel.histogram(col = &quot;peru&quot;,...)
            panel.densityplot(col = &quot;red&quot;, lwd = 2, ...)
          }
          )
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk HistoEDA" alt="plot of chunk HistoEDA" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = FlightDelays, aes(x = Delay)) + 
  geom_histogram()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk HistoEDA" alt="plot of chunk HistoEDA" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = FlightDelays, aes(x = Delay, y = ..density..)) + 
  geom_histogram(binwidth = 10, color = &quot;blue&quot;) + 
  geom_density(color = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk HistoEDA" alt="plot of chunk HistoEDA" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = FlightDelays, aes(x = Delay)) + 
  geom_density(fill = &quot;blue&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAt1BMVEUAAAAAADoAAGYAAP8AOmYAOpAAZrY6AAA6ADo6AGY6OpA6ZrY6kNtmAABmADpmAGZmOgBmOpBmZmZmtv9/f39/f5V/lcF/q9aQOgCQOjqQOmaQ27aQ2/+VlcGVweurf6urlcGrq6ur1v+2ZgC2Zjq2/7a2///BlX/BlavB6//Wq3/W///bkDrb/7bb///l5eXrwZXr1qvr///y8vL/tmb/1qv/25D/68H//7b//9b//9v//+v////Rfe30AAAACXBIWXMAAAsSAAALEgHS3X78AAAImElEQVR4nO3dD1vTVhhA8aBjTqcyRye6VTbLBhsyhvLHCvn+n2tJiqUkaXoT0sMNnvdx2jJ3Vn5cL4HW5yapg0xy3w/gWxmhoREaGqGhERoaoaERGhqhoREaGqGhERoaoaERGppO0P/VTO0bK3Ma8psGnFooCb3OlNBQSmgoJTSUEhpKCQ2lhIZSQkMpoaGU0FBKaCglNJQSGkqtHzoZsI7Qw0sJDaWEhlJCQymhoZTQUEpoKCU0lBIaSgkNpYSGUkJDqbVDJ0KXS0KvM9Uz9GllMujqG7vOw0i5oteZcuuAUkJDKaGhlNBQSmgoJTSUEhpKrR/6cQK/S3GmhIZSQkMpoaGU0FBKaCglNJQSGkoJDaWEhlJCQymhoZTQUEpoKCU0lBIaSgkNpYSGUkJDKaGhlNBQSmgoJTSUEhpKCQ2lhIZSQkOpLtCHo1/+WbhxMhrtCN2iFAp9/vpT9mN+4zxTPpwIHV4KhT7ZTb/8/mF+4+T99YoeZVP93Rn00j8aTj7LoSfp1d8f5jcOd4pbs6l+JF3RlVIwdGlFZ8jnu8ugk8dCl0uh0DV79PIVLXS1FAo9u9j48senm6uOrwta6JBSMHTDVPpCV0tCrzMlNJQSGkoJDaWEhlJCQymhoZTQUEpoKCU0lBIaSgkNpYSGUkJDKaGhlNBQSmgoJTSUEhpKCQ2lhIZSQkMpoaGU0FBKaCglNJQSGkoJDaWEhlJCQymhoVTP0JXjinLofg5KKg4/ehApV/Q6U24dUEpoKCU0lBIaSgkNpYSGUgB0mHSUOkIPLyU0lBIaSgkNpYSGUkJDKaGhlNBQSmgoJTSUEhpKCQ2lhIZSQkMpoaGU0FBKaCglNJQSGkoJDaWEhlJCQ6lQ6OmL74W+Syp8RZ8lycZY6K6pVlvH5Zsk2Ra6Uyoc+uJJvqKnW/tCd0mF79Gbx41rWejgUjN0sZJnP5eOcCrOCRE6vNQAPX2RzCZf1qXjQbJfm0+tELpUCljR6fX6XTzwJv387mMBXXuEUwFdeauzMKFHOGXW567oNqUG6OnWX7PN49F+9QinfCU3HeEkdKkUuqIre3Tqim5VCoUuH+EkdMtSM/TR5vHRqq8LhQ4qNUJPX46zHxdPG78uFDqo1Ay9tZ+taaE7p8K3jmRjfObW0TnlN/6hlNBQKhj6bP4Fi9BdUuHfJl21PQsdWmqGbv6Gv9AtSo3Q6d5zoe+SCt863KPvlPKqA0oJDaWCoS/fJJv/vhwL3TEVCn355vnFs+OzVU+FV/pCV0uN0NnlXQa98iKv0he6WgpY0Ueu6K6pNnv07NUGQndKedUBpYSGUi1fqeRXhl1T7b7XcbTq1eiVvtDVUiP04osche6QanF5lxavORC6W6rd5d3Kv8dS6QtdLTVDh02lL3S1JPQ6U0JDKaGhlNBQSmgoJTSU6hm6clxRAd3PSUmnHuHkim5VEnqdKaGhlNBQSmgoJTSUEhpKCQ2lhIZSQkMpoaGU0FBKaCglNJQSGkoJDaWEhlJCQ6k1Q+fOQpdKQq8zJTSUEhpKCQ2lhIZSQkMpoaGU0FBKaCglNJQSGkoJDaWEhlJCQymhoZTQUKoL9O0jnK4ORqPi7AqhA0uh0KXjQc53MvGJ0OGlUOjyEU5pccZQ/RFOM+ilfzacNPwIp+xGvqhnU/44uqJrSsHQ5RV9OHcWOqQUCl3ao68OJjf/rpwvoIOko9SJ4apjfoTTYdOhZELXlIKhG6acF7qmJPQ6U0JDKaGhlNBQSmgoJTSUEhpKCQ2lhIZSQkMpoaGU0FBKaCglNJQSGkoJDaWEhlJCQymhoZTQUEpoKCU0lBIaSgkNpYSGUkJDKaGhlNBQSmgoJTSUEhpKCQ2leoYuHwt1Dd3ToVSeleWKblMSep0poaGU0FBKaCglNJRCoEOko9QRengpoaGU0FBKaCglNJQSGkoJDaWEhlLrhb52FpqCDpCOUkfo4aUo6JXSUeoMD3q1dJQ6A4ReuXlEqSP08FJCQykMOtulG62j1BkmdL6ql1tHqTNI6Bn2UukodQYL3bBVR6kzYOilF9RR6gwZuljUNdpR6gwbOr/+SCrWUeoMHLr202KUOg8A+vrz4s3F9enq7zsJvQy60Xm2hcw/O674eqbFuyR0FXpxyw55GuYbg759hNPN3bbQZfNkNtl/V3dZEvwuPRjo8hFOX+9WoJNw6EXxQjv/cr1Y6LMtZfHn2/+LZPbL/A296twvdOnAm/ndyhFOiTOfpdtD+BFO87uVFd3mAx7nMoxzRQsdWAqFDt6j2zyOOHViuOqYH+HUcNXR4nHEqTOU6+gWjyNOHaGHlxIaSgkNpYSGUkJDKaGhlNBQSmgo1TN03VROZTd1a4SGUkJDKaGhVG/QTvMIDY3Q0AgNjdDQ9AS9+ERX17k6GI1e1z1z1mlOdute+tMlNBrt9JDqB/rWU7edI/n7M6l5LrhTbLRb97Ty/T2qfqBvvRjhTqFJzasbOszndx93614o0eERvc9X9N1TPUEvvrzmDpMtn5rX67SfjON8t5/U4U7x4b9zKqoVXbxTvSzD/IVru/2kJtnHv4dURHv01cEkrX29TreH1OMefRLNHt3LVcdhsQz7uuo47/Gqo4+U19HQCA2N0NAIDY3Q0AwV+uJJ/lcZtm/uP92/x0cTMIOFzmGnL7Zv3Y95Bg2dXjw7zrSTR/vF/XyVb6d728WbY5thQ09fjtO95+nR9/n9/E72y9nzNPsR3Qwb+vLtOOedbu1fbx3Zremr4z/H9/vg6mbY0JlytnMkyca4uL+XZLvI5dvfXsW3cwwc+mzzOFvD1/fzT435m49+jnDnGDZ0cdWR7dGZd3a/+Hz4w7j4J74ZLPT8OjrbOzbGs6WcJN/9tJ1e/hrjld5QoRvm4sf7fgR18/Cgj7L1HeE8POhIR2hohIZGaGiEhkZoaISGRmho/ge7aY4S3WDG+gAAAABJRU5ErkJggg==" title="plot of chunk HistoEDA" alt="plot of chunk HistoEDA" style="display: block; margin: auto;" /></p>

<h2>Numeric Summaries</h2>

<pre><code class="r">summary(FlightDelays)
</code></pre>

<pre><code>       ID       Carrier      FlightNo    Destination    DepartTime    Day       Month     
 Min.   :   1   AA:2906   Min.   :  71   BNA: 172    4-8am   : 699   Fri:637   May :1999  
 1st Qu.:1008   UA:1123   1st Qu.: 371   DEN: 264    4-8pm   : 972   Mon:630   June:2030  
 Median :2015             Median : 691   DFW: 918    8-Mid   : 257   Sat:453              
 Mean   :2015             Mean   : 827   IAD:  55    8-Noon  :1053   Sun:551              
 3rd Qu.:3022             3rd Qu.: 787   MIA: 610    Noon-4pm:1048   Thu:566              
 Max.   :4029             Max.   :2255   ORD:1785                    Tue:628              
                                         STL: 225                    Wed:564              
  FlightLength     Delay       Delayed30 
 Min.   : 68   Min.   :-19.0   No :3432  
 1st Qu.:155   1st Qu.: -6.0   Yes: 597  
 Median :163   Median : -3.0             
 Mean   :185   Mean   : 11.7             
 3rd Qu.:228   3rd Qu.:  5.0             
 Max.   :295   Max.   :693.0             

</code></pre>

<pre><code class="r">sd(FlightDelays$Delay)
</code></pre>

<pre><code>[1] 41.63
</code></pre>

<pre><code class="r">sd(FlightDelays$Delay)^2
</code></pre>

<pre><code>[1] 1733
</code></pre>

<pre><code class="r">var(FlightDelays$Delay)
</code></pre>

<pre><code>[1] 1733
</code></pre>

<pre><code class="r">IQR(FlightDelays$Delay)
</code></pre>

<pre><code>[1] 11
</code></pre>

<pre><code class="r">quantile(FlightDelays$Delay)
</code></pre>

<pre><code>  0%  25%  50%  75% 100% 
 -19   -6   -3    5  693 
</code></pre>

<h2>Boxplots</h2>

<pre><code class="r">boxplot(Delay ~ Carrier, data = FlightDelays)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk BP" alt="plot of chunk BP" style="display: block; margin: auto;" /></p>

<pre><code class="r">bwplot(Delay ~ Carrier, data = FlightDelays)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk BP" alt="plot of chunk BP" style="display: block; margin: auto;" /></p>

<pre><code class="r">bwplot(Delay ~ Carrier | Month, data = FlightDelays, as.table = TRUE, layout = c(2, 1))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk BP" alt="plot of chunk BP" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = FlightDelays, aes(x = Carrier, y = Delay)) + geom_boxplot()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk BP" alt="plot of chunk BP" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = FlightDelays, aes(x = Carrier, y = Delay)) + geom_boxplot() + facet_grid(. ~ Month)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk BP" alt="plot of chunk BP" style="display: block; margin: auto;" /></p>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/NCBirths2004.csv&quot;
NCBirths &lt;- read.csv(file=url(site))
head(NCBirths)
</code></pre>

<pre><code>  ID MothersAge Tobacco Alcohol Gender Weight Gestation
1  1      30-34      No      No   Male   3827        40
2  2      30-34      No      No   Male   3629        38
3  3      35-39      No      No Female   3062        37
4  4      20-24      No      No Female   3430        39
5  5      25-29      No      No   Male   3827        38
6  6      35-39      No      No Female   3119        39
</code></pre>

<pre><code class="r">boxplot(Weight ~ Gender, data = NCBirths, col = c(&quot;pink&quot;, &quot;blue&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk NCBirths" alt="plot of chunk NCBirths" style="display: block; margin: auto;" /></p>

<pre><code class="r">bwplot(Weight ~ Gender, data = NCBirths)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk NCBirths" alt="plot of chunk NCBirths" style="display: block; margin: auto;" /></p>

<pre><code class="r">p &lt;- ggplot(data = NCBirths, aes(x = Gender, y = Weight, fill = Gender))
p + geom_boxplot()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk NCBirths" alt="plot of chunk NCBirths" style="display: block; margin: auto;" /></p>

<pre><code class="r">p + geom_boxplot() + 
  guides(fill = FALSE) + 
  labs( x = &quot;Newborn Gender&quot;, y = &quot;Weight in ounces&quot;, title = &quot;You Put Something Here&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk NCBirths" alt="plot of chunk NCBirths" style="display: block; margin: auto;" /></p>

<pre><code class="r">p + geom_boxplot() + 
  guides(fill = FALSE) + 
  labs( x = &quot;Newborn Gender&quot;, y = &quot;Weight in ounces&quot;, title = &quot;You Put Something Here&quot;) + 
  scale_fill_manual(values = c(&#39;pink&#39;, &#39;blue&#39;))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk NCBirths" alt="plot of chunk NCBirths" style="display: block; margin: auto;" /></p>

<pre><code class="r">p + geom_boxplot() + guides(fill = FALSE) + 
  labs( x = &quot;Newborn Gender&quot;, y = &quot;Weight in ounces&quot;, title = &quot;You Put Something Here&quot;) + 
  scale_fill_brewer() + theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk NCBirths" alt="plot of chunk NCBirths" style="display: block; margin: auto;" /></p>

<h2>Density Plots</h2>

<pre><code class="r">curve(dnorm(x), -4, 4, ylab = &quot;&quot;, xlab = &quot;&quot;)
x.region &lt;- seq(from = 1, to = 4, length.out = 200)
y.region &lt;- dnorm(x.region)
region.x &lt;- c(x.region[1], x.region, x.region[200])
region.y &lt;- c(0, y.region, 0)
polygon(region.x, region.y, col = &quot;red&quot;)
abline(h = 0, lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAY1BMVEX9/v0AAAAAADkAAGUAOTkAOY8AZrU5AAA5ADk5AGU5OWU5OY85j9plAABlADllAGVlOQBltf2POQCPOTmP29qP2/21ZgC1/v3ajzna24/a/v39tWX924/9/rX9/tr9/v3/AADQ/p7FAAAAIXRSTlP/////////////////////////////////////////AP8h58LeAAAACXBIWXMAAAsSAAALEgHS3X78AAAIAUlEQVR4nO3d61obNxSF4bhtQmkgbdNCaTCY+7/KMuZQG49ndNha2pK+9YcQP7O39FoMY/CITzsiyafaAxglQIsCtChAiwK0KECLArQoQIsCtChAiwK0KECLArQoQIsCtChAiwK0KECLArQoQIsCtChAiwK0KECLArQoQIsCtChAiwK0KECLArQoQIsCtChAiwK0KECLArQoQIsCtChAiwK0KECLArQoQIsCtChAiwK0KECLArQoQIsCtChAiwK0KECLArQoQIsCtChAixIIvb385/Q/N+QwmdAP1691fj6hXik9WHKhn6WfiedXdOKQ+kw29ET9+V+g12IA/XyKvjg9cQB9HBPopNKDBWhRrKAffn8/eQRe0AyW7le0l+e7c+iJ2Qd1NvT24szrFQ/Qr0PwQJ0L/fj9z/3H+88/IksLspn5V61kvwR//SZ48M0wsHT5bM78u0o6XtGbs5/UiMHPOpyeozeLn8rT7VXHSXdfz/vHAG2VXqFnmjt74o/TE7S/AR2kVejZ3kDbZ763vxG9p1HoM62Btg7Qmpzt7O+5fwvQVgFalB6hFxo7fPJfArRVBoP2Oagd0HbpEHq5r89RAW0WoEXpD3qlLdBWWWvrc1jtQa92BdomQIsCtCYBTV0uAKCtArQonUEH9fS4AoC2CtCijAjtcWSNQQe2BDo3oS39DQ1oqwAtSlfQwR2Bzkt4R3djA9oqPUFHNGwQenuxubr1cftb19DTDZ23065KX+vf0BnT0Nvggm5Rvr9ycYtyVL/moN9uUXawovuG3j1cT9J3Ds7RnUMnlzZPXD9no2sIOrJdq9D1N68aBDq+tHWAFiW2na/hNbR5VefQbrb6ie7WGLSbzaviu7kaX8cr2tf42tm8qnvo5NK2SWgGtKqZpwECbZVOoJN6AS3qBbSoF9CqXo5G2Ah0YiugRa2AFrUCWtXKzxDbgE7uBLSoE9CiTkCrOrkZI9BW6QE6oxHQqkZeBgm0VYAWpQPorD5Aq/o4GSXQVmkfOrMN0KI2QIvaqN4vD7SPYfqHzu0CtKgL0KIumycX4wTaKq1DZzcBWtQEaFGTzZNGGmigNU2AFvV4hpZIA90K9PZi89NNtRs6x4Gebuh8/H4F9Gqf5YcDb1G+/VIH2qBFK9Cvtyjf/XLZMnT9oYbconw1fZjZvar+6INKPGmWdNNXHRYdgBZ1aA26yuZVI0LHlzaIGbRAumVokwbNQFfcvGoo6Jpb/RhCl5e2eWVY52cdQ0FXXNE29VuBrrh51WDQyaWzYwpdXBpooDX1gRaVB1pU/g26tDTQQGvKAy2q/g5dWBpooDXVgRYVP4CuOeCRoMsuaaCB1tQ+hK444qGgiy5poIHW1AZaVPoIut6Qx4IuuaSBBlpTGmhR5WPoamMG2qzP8sODQRc8dwANtKbwB+hagx4NutySbhDati7QorofoSuNejjoYku6PWjjsifQdYYNtFmf5YfHgy517mgO2roq0KKqp9BVxj0gdKElDTTQmqJAi4qeQpeRBroR6Nf7Oefu6AT6qM/yw+sretqLLal0UuxrzkAXkc4/dTx8u0kqnZSRoVNLeyk5B60f+pjQJZa0FbRk86oiX9Kz0PKx+1rRQKeUdlHxDHSBc0c2tHDzqjLXt/PQ6sG72upnaGjl5lVCaPtzByu6EWjh5lWFfnw5D20u3dBVB9BppSuXey8LdNly72XPQFtLNwNd7K1aQJesdlD3HLSxdCvQ5d5OC3S5YkeFz0LbSgMNdKlaHyqfhzaVBhroMqVOSi9AW0oDDXSJSjO1l6ANpYEG2r7QbPFlaNUkRoe2W9INQBd1XoUWzcIBdFnnNWizJQ30GrRmGvWhCzuvQlstaaDXoI2kvUOXdg6BVkykNnRx5wBomyUN9Dq0ibRv6PLOYdDlp1IXWuAcBG2xpIEOgTaQ9gytcA6FLj0ZoK2WtF/osn8W5f82YdDZa9ottIY5HDpX2iu0yjkcOlMa6GDoPGmn0DLnGOgsaZfQou+DL70ioHOkPUILmSOhM6QdQkudI6HTpd1BK08b+35x0MnU2dCmtyiX2BJhrWUsdCJ1LrTpDZ1y5V0S9FPKesiFNrxFWb+a910ToFNWtZMVXWQflbDOadD7ZR01w+WHJbcoV0PeN0+FjrSuetVRakugmORAv2GHzKEkNDmMEfTc5lXkMEbQM6l7SvAWoEXx9cqw4zi5ju4/jl4Z9h1WtCgeXhkOEV6wqFIO+oC84tF1Dw8+GmigmzgcaNHhQIsOB1p0ONCiw8XQZDVAiwK0KECLArQoQIsCtChAiwK0KECLYgT99pvFlEzvZ0g++uF6c/rLTFHvXcy8jaDvMqi+3ey2v575a6trmSZ69yW1dV7vKeHztoHe/vZHMvT95HSbePj0Jojt5envjRW9d1HzNoF+/OvvjFPHbuHvB69l+/VH+sGZvePmbQJ9d5Vzjl76i9hrmd5tkged3jtu3rnQt5vNl+dllQg9HT19Q0uea/aKzui9i5q3xYq+27+tIR3rIv2rIfMcndU7bt71L++y5jp94WdcdWT1fukvvrzLgH5ZF6mH511H5/XeVYAmawFaFKBFAVoUoEUBWhSgRQFaFKBFAVoUoEUBWhSgRQFaFKBFAVoUoEUBWhSgRQFaFKBFAVoUoEUBWhSgRQFaFKBFAVoUoEUBWhSgRQFaFKBFAVoUoEUBWhSgRQFaFKBFAVoUoEUBWhSgRQFaFKBFAVoUoEX5D3WONXsMAKL5AAAAAElFTkSuQmCC" title="plot of chunk ND" alt="plot of chunk ND" style="display: block; margin: auto;" /></p>

<pre><code class="r"># Same now with ggplot2
p &lt;- ggplot(data = data.frame(x = c(-4, 4)), aes(x = x))
dnorm_func &lt;- function(x){
  y &lt;- dnorm(x)
  y[x&lt;1] &lt;- NA
  return(y)
}
p1 &lt;- p + stat_function(fun = dnorm_func, geom = &#39;area&#39;, fill = &#39;blue&#39;, alpha = 0.2) + 
  geom_hline(yintercept = 0) + 
  stat_function(fun = dnorm) 
p1 + theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk ND" alt="plot of chunk ND" style="display: block; margin: auto;" /></p>

<pre><code class="r">p1 + theme_bw() + 
  labs(x = &#39;&#39;, y = &#39;&#39;, title = expression(integral(frac(1, sqrt(2*pi))*e^{-x^2/2}*dx, 1, infinity)==0.1586553) ) # Break it down!
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk ND" alt="plot of chunk ND" style="display: block; margin: auto;" /></p>

<h2>Example 2.11</h2>

<p>Note this is not how <code>qqnorm</code> computes the quantiles!  The left graph of Figure 2.9 in the book is not quite correct&hellip;it does not use the data in the table&hellip;the first value 17.7 should be 21.7.</p>

<pre><code class="r">x &lt;- c(21.7, 22.6, 26.1, 28.3, 30, 31.2, 31.5, 33.5, 34.7, 36)
n &lt;- length(x)
p &lt;- (1:10)/(n + 1)
q &lt;- qnorm(p)
rbind(x, p, q)
</code></pre>

<pre><code>      [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]    [,8]    [,9]   [,10]
x 21.70000 22.6000 26.1000 28.3000 30.0000 31.2000 31.5000 33.5000 34.7000 36.0000
p  0.09091  0.1818  0.2727  0.3636  0.4545  0.5455  0.6364  0.7273  0.8182  0.9091
q -1.33518 -0.9085 -0.6046 -0.3488 -0.1142  0.1142  0.3488  0.6046  0.9085  1.3352
</code></pre>

<pre><code class="r">plot(q, x)
XS &lt;- quantile(q, prob = c(0.25, 0.75))
YS &lt;- quantile(x, prob = c(0.25, 0.75))
slopeA &lt;- (YS[2] - YS[1])/(XS[2] - XS[1])
slopeB &lt;- diff(YS)/diff(XS)
slopeA
</code></pre>

<pre><code>  75% 
5.873 
</code></pre>

<pre><code class="r">slopeB
</code></pre>

<pre><code>  75% 
5.873 
</code></pre>

<pre><code class="r">Intercept &lt;- YS[1] - slopeA * XS[1]
Intercept
</code></pre>

<pre><code>  25% 
29.83 
</code></pre>

<pre><code class="r">abline(a = Intercept, b = slopeA)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk QUANTILES" alt="plot of chunk QUANTILES" style="display: block; margin: auto;" /></p>

<pre><code class="r"># 
pc &lt;- (1:10 - 3/8)/n
qc &lt;- qnorm(pc)
rbind(x, pc, qc)
</code></pre>

<pre><code>      [,1]    [,2]    [,3]    [,4]     [,5]    [,6]    [,7]    [,8]    [,9]   [,10]
x  21.7000 22.6000 26.1000 28.3000 30.00000 31.2000 31.5000 33.5000 34.7000 36.0000
pc  0.0625  0.1625  0.2625  0.3625  0.46250  0.5625  0.6625  0.7625  0.8625  0.9625
qc -1.5341 -0.9842 -0.6357 -0.3518 -0.09414  0.1573  0.4193  0.7144  1.0916  1.7805
</code></pre>

<pre><code class="r">xs &lt;- quantile(qc, prob = c(0.25, 0.75))
ys &lt;- quantile(x, prob = c(0.25, 0.75))
slope &lt;- diff(ys)/diff(xs)
intercept &lt;- ys[1] - slope * xs[1]
c(intercept, slope)
</code></pre>

<pre><code>   25%    75% 
29.625  5.268 
</code></pre>

<p>Consider using the <code>R</code> functions <code>qqnorm()</code> and <code>qqline()</code>.</p>

<pre><code class="r">qqnorm(x)
qqline(x)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAkFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlZgBlZjlltf2POQCPOTmPOWWPZgCPj2WPtY+P29qP2/21ZgC1tWW124+1/rW1/v3ajznatWXa24/a/rXa/v39tWX9tY/924/929r9/rX9/tr9/v3Q9EabAAAAMHRSTlP//////////////////////////////////////////////////////////////wBipdB4AAAACXBIWXMAAAsSAAALEgHS3X78AAANLklEQVR4nO2dDX/iuBGHz9ByYbdbyN4d2b5Br9DdUA78/b9dLVnGNsjOyJJHb//nl9sE7EykB90w2IP5qQQs/OR7ALkA0UxANBMQzQREMwHRTEA0ExDNBEQzAdFMQDQTEM0ERDMB0UxANBMQzQREMwHRTEA0ExDNBEQzAdFMQDQTEM0ERDMRkOjrttiV5e1teSTt3Ox2eyuKYvV+39K7XcUU7Dr7Sw47Z8MmEpboyo+p6Mtaqlzs1Yb+bSV6se+LPhSZiy42SvSpED9XNxa/FYt/FD+/FcvjSazM8lxbbMRV6/elFObUGn64fd2K74diU+9fh5Vr/oV5dkGJXv66PErRB7kOX1Qa+G/RsDzWS3T13oi+rKXR6hGpl/DD7b5oFRail7+vN0L0ZS3X7GJfr89zIe4qduIeteOxEX1Wxppk8HC7lzruYbNPHcvjYfGvSnRt61Ts6oUpboqN9S3hTitaZOdq9WtEq1RzDwvRlb+fh0Sv3sWt+rmuFS1TxeFFVCxS9Pf2dh1T5W6IbpHuTkXRSx2Pok/Vk9ll3YqWyUUoVkXFw+2eaKSOGunuJuqLzpPho+hz0V/RTTknahTN7Z7oe1jxQ95Phsf6ma9b3j2IFo42J/HE2HvB0hHXu90X3YQVj0bnJQ4LAYm24rrdjd72TiqigweimYBoJiCaCYhmAqKZgGgmIJoJiGYCopmAaCYgmgmIZgKimYBoJiCaCYhmAqKZgGgmIJoJiGYCopmwEV2ALjOKtvjdqNFO3Fr0Zb0TzT+azp5cRevnbSv69raT7/i4fHkynanogWnbir5+Pd6+7eV3w9BpMpiLrVNHtZzP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" title="plot of chunk QQNORM" alt="plot of chunk QQNORM" style="display: block; margin: auto;" /></p>

<pre><code class="r"># ggplot
ggplot(data = data.frame(x), aes(sample=x)) + 
  stat_qq() + 
  geom_abline(intercept = intercept, slope = slope)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk QQNORM" alt="plot of chunk QQNORM" style="display: block; margin: auto;" /></p>

<h2>Empirical Cumulative Distribution Function</h2>

<p>The <em>empirical cumulative distribution function</em> (ecdf) is an estimate of the underlying cumulative distribution function for a sample.  The empirical cdf, denoted by \( \hat{F} \), is a step function \[ \hat{F}(x) = \tfrac{1}{n} (\text{number of values} \leq x), \]
where \( n \) is the sample size.</p>

<pre><code class="r">y &lt;- c(3, 6, 15, 15, 17, 19, 24)
plot.ecdf(y)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAe1BMVEX9/v0AAAAAADkAAGUAOTkAOY8AZo8AZrU5AAA5ADk5AGU5OY85j485j9plAABlADllAGVlOY9lZmVlZrVltbVltf2POQCPOTmPOWWPtY+P2/2zs7O1ZgC1ZmW1/rW1/v3ajzna24/a/tra/v39tWX924/9/rX9/tr9/v3IysKrAAAAKXRSTlP/////////////////////////////////////////////////////AFL0IIcAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAfpSURBVHic7Z2LdptGFACLE1dqUynpQ07q0FqN9eD/v7BahB0UyWIRaAAxc04OsdlzwePry0XsSj9lgvBT1ycwFhQNoWgIRUMoGkLREIqGUDSEoiEUDaFoCEVDKBpC0RCKhlA0hKIhFA2haAhFQygaQtEQioZQNISiIYYuejO/f87W0+TuMVvu/hWsp7MuT+oUNyE6TRbhf5Pv307fPXV3TicZkuhlkgSj2fYhSYLIsP1rfv9tt0nun5e7fevpu6fddxfZKulbSg9IdJoEZrnfYHq/TQrR3x5C5djl9iqZFIneK4Yjej3duds+vHsKaRuM5ttlUpSOvdrN/P10n+x9qx3DEb3K83d31XspC99TN82rRp7Dq5fq8v3K2A8GKXpSfOOE6GWy/zWkir6UwmSWFSVjdlg69rvX05/zXDajG7C/GN4//3gxLNXo4Pe1lnd9vocMSHRuOs/qNFSQfXv322sfHYrFMlSTdFc87Dquxyq/Cr5+YR99LbwzpPC1DskUjaFoCEVDKBpC0RCKhlA0hKIhFA2haAhFQygaQtEQioZQNISiIRQNoWgIRUM0EZ1Imaai19M8zInn9xWhR0ZT0duH/byU1fHUH0WXaSp68+npYBsfemSY0RCNa/Rmbo2OobHoi0PfCpUNRTHs/G5FVxHRuu3Hnd8dLbp0MXxpHL8Gdl/f9rb4OZPKbUuiT2BGH4w7v1vRlVij+4WiIRrfGc6LS99xI63oMo0zevvw1jIFRZdpXjo2H99YG6noMtZoCEVDKBpC0RCKhlA0hKIhFA2haAhFQygaQtEQioZQNISiIRQNoWgIRUMoGkLREIo+JnLuUc2g53ePUXTsbLqaUc/vHq3o9tZbvUQ9v3u0otuPen73GEVboweNoiHaWDk7Wboqq5LG6ww/P2bLyc73B9cZnqWNlbPLmStnKzGjIdqo0TNrdDV2HRCKhrjiyllFlzGjIRQN4XsqQfgONBC+pxKEGQ3heypB2HVAKBpC0RCKhlA0hKIhFA2haIjRi6ZeNx+7aOwJhaIvnh9a80Dnd49DNHKg87tvXrQ1+tZQNISiIRQNoWgIRUMoGkLREIqGUDSEoiEUDaFoCEVDtDA/erF9SJLjOY6KPqCN2aTpwnWGlbQwPzqs6XR+dBWNS8cunVezLFtN6oYeGc0vhmn+2O3Ys6IPsOuAUDSEK2chzGgIRUO4chZiZOsMu7tyjGvlbIfX6HFlNDV19NShz+++sZWzvc/oVX6Gi1ZDd0K/a/Rq/0rG9qGe6j6K7o4I0ZvfX8vvP8cF4uLQI8MbFogo0fuc3n6pk8+KPiQuo9fTSZbevfGJ9heGHhmxpWNVt+dQ9CFmNIQ1GiKmvfvz9Uvbu4vxhgViZLfg3eENC4SiIeqUjhMvhTYIPTLi2rt57buV6tAjI0708XOq5qFHRlzpSGfthx4ZkaXDGt0Uuw4IRUPEvNZx0aVQ0YdEij6xRKVp6JGhaAhFQ8SInhdzp2zvGmDXAdGO6PWvJ5Jd0WUaT9t9u64oukwLs0l3is3oSlooHZv5/X+KrqKVGr2enmpIFF3GrgNC0RCunIUwoyEUDeHKWYhxrTPskHGtnO0QMxpiXCtnO8SuA0LREIqGUDSEoiEUDaFoCEVDKBpC0RCKhlA0hKIhFA3RY9G39Ry9v6JvbMZCz0W3T7OTavDjnN/dtehmIfpEf0Vbo1sKPTIUDaFoCEVDKBpC0RCKhlA0RBvzo+/8hM5q2phNun2YKbqKduZHpxNFV9DS/Ojl++O1s4ou08L86Pw98ZYuuj+PXQeEoiFcOQthRkMoGsKVsxCuM4Rw5SyEGQ3hylkIuw4IRUMoGqJj0eO5Ue9W9IheEumB6P5Nsb0GPRDd4BADwhoNYdcBoWgIRUMoGkLREIqGUDSEoiEUDaFoCEVDKBpC0RCKhlA0hKIhFA2haAhFQygawonoEE7bhXAiOoQZDeFEdAi7DghFQ1xxifLXQOU2y/JtdutbMxpC0RDeGULYR0N4ZwhhRkN4Zwhxza5DylxPdEl5b0b3KfgBir7i8DKKvuLwMoq+4vAyir7i8DKKvuLwMoq+4vAy7YiWShQNoWgIRUMoGkLREIqGUDSEoiEUDdGC6M08OX6e+CbL5ORjsdOsw6fsxMfPh0ceIMyiWMQHL4bXOvsDmosOT2+Xk+jh6SI+9Cr8UPHx8+GRB9h8fMzWvzzGBi+G1zr7Q5qLDvMQ1sef7/QG28+P0ZHTu793caPj74dHHmAV7KaL2ODF8Dpn/wPNRa8/POe/8DjyZ+rRaREc1Igfhtc4wC5qnZPfjat39gc0Fx0mfMSLDn9/8XkRzNWIn/9eog8QPjywRvAwvN7ZH0BndE50pbsgo6MPkH/YWnzw4rPZIoMfQ9fonFqia8SvI3o9DWOig++HxwY/QRtdx6xG1xH+Vrdf6rR3NeK/VJqIAxTiYoMXw+ud/QFd9NF30XXmwj464gDLfHLRIjb4y/BaZ3+Ad4YQioZQNISiIRQNoWgIRUMoGkLREIqGUDSEoiEUDaFoCEVDKBpC0RCKhlA0hKIhFA2haIihi07rTCrpkqGL3nz69/hdtfrI0EVny2RWPagHDF50mOA5BAYvOv1jECV68KLXH75dPgufZOCiwxqUE2992EMGLno4KBpC0RCKhlA0hKIhFA2haAhFQygaQtEQioZQNISiIRQNoWgIRUMoGuJ/f/LLPXtYDc0AAAAASUVORK5CYII=" title="plot of chunk ECDFbase" alt="plot of chunk ECDFbase" style="display: block; margin: auto;" /></p>

<pre><code class="r">set.seed(1)  # set seed for reproducibility
rxs &lt;- rnorm(25)
plot.ecdf(rxs, xlim = c(-4, 4))
curve(pnorm(x), col = &quot;blue&quot;, add = TRUE, lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk ECDFbase" alt="plot of chunk ECDFbase" style="display: block; margin: auto;" /></p>

<p>An alternative approach to the book&#39;s Figure 2.12 is provided using <code>ggplot2</code> after first creating Figure 2.12</p>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/Beerwings.csv&quot;
Beerwings &lt;- read.csv(file=url(site))
head(Beerwings) # shows first 6 rows of data frame
</code></pre>

<pre><code>  ID Hotwings Beer Gender
1  1        4   24      F
2  2        5    0      F
3  3        5   12      F
4  4        6   12      F
5  5        7   12      F
6  6        7   12      F
</code></pre>

<pre><code class="r">str(Beerwings)  # shows structure of data frame
</code></pre>

<pre><code>&#39;data.frame&#39;:   30 obs. of  4 variables:
 $ ID      : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Hotwings: int  4 5 5 6 7 7 7 8 8 8 ...
 $ Beer    : int  24 0 12 12 12 12 24 24 0 12 ...
 $ Gender  : Factor w/ 2 levels &quot;F&quot;,&quot;M&quot;: 1 1 1 1 1 1 2 1 2 2 ...
</code></pre>

<pre><code class="r">beerM &lt;- subset(Beerwings, select = Beer, subset = Gender == &quot;M&quot;, drop = TRUE)
beerF &lt;- subset(Beerwings, select = Beer, subset = Gender == &quot;F&quot;, drop = TRUE)
plot.ecdf(beerM, xlab = &quot;ounces&quot;, col = &quot;blue&quot;, pch = 19)
plot.ecdf(beerF, col = &quot;pink&quot;, pch = 19, add = TRUE)
abline(v = 25, lty = &quot;dashed&quot;)
legend(&quot;topleft&quot;, legend = c(&quot;Males&quot;, &quot;Females&quot;), pch = 19, col = c(&quot;blue&quot;, &quot;pink&quot;))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAsVBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85Zo85ZrU5j485j9plAABlADllAGVlOQBlOTllOY9lZjllZmVlZrVltbVltf2POQCPOTmPOWWPZgCPZo+Pj2WPtY+P29qP2/2zs7O1ZgC1Zjm1ZmW1tWW124+1/tq1/v3ajznaj2Xa24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/wMsNpEb3AAAAO3RSTlP///////////////////////////////////////////////////////////////////////////8A/x/iKeEAAAAJcEhZcwAACxIAAAsSAdLdfvwAAArtSURBVHic7Z0Ne+LGFYUjr1MXlm4aSNKPFLxtUlZtU9Q2RiD+/w/rzEiyZZDg6utwR3Pe58mj3fV4fHg9uYzEjPRVRiB8de8AoUDRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBuG76MPq6SVL59HDNkvMfwXpfHnPUHVMQnQcre2fZm//HH/Y3S9TLT6JTqLIGs2OmyiyIu3xL6unX80henpJzNfS+Yed+dd1to+0DWmPRMeRZen8WtP5MSpE/7qxlcOM7X00Kwa6KvwRnc6Nu+Pmw84OW2vUHZOoKB252sPq63k+2LXVDn9E7934Ne96ZVl4G7qxqxpuDO/L6vL2zqgDL0XPin+oEZ1E+a8hpuiuFCazrCgZy/elI/9yOv+tG8sc0T3I3wyfXs7fDCs12vp9reX3zvsej0Q7025Ux7aC5NO7b1/n0bZYJLaaxKZ4cNYxHnv3Lvj6F86jx4Jnhih4rYNkFA2DokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNIg+oiNSpa/odO66qfn8/kbXYgboZ6go40W4Kfq4ydel7C+X/lB0iwg3RR++3707yrsWQ9EWP0a0AnrX6MPKgxqtgN6iO3cN70fK6XRq+R2Pj48324Qhuk0Xp1Nb04+PAtNDia68Gb7OHL8YzN+/9DwO0E/Uov3JHY3sQY7mV1AcBxJdA0d0iwgBip5I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" title="plot of chunk BEER" alt="plot of chunk BEER" style="display: block; margin: auto;" /></p>

<pre><code class="r"># Using ggplot2 now
ggplot(data = Beerwings, aes(x = Beer, colour = Gender)) + 
  stat_ecdf() + 
  labs(x = &quot;Beer in ounces&quot;, y =&quot;&quot;, title = &#39;ECDF&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAA9lBMVEUAAAAAADoAAGYAOjoAOpAAZrYAv8Q6AAA6ADo6AGY6Ojo6OmY6OpA6ZrY6kJA6kNtmAABmADpmAGZmOgBmOmZmZgBmkJBmkLZmkNtmtv9/f39/f5V/f6t/lcF/q9aQOgCQOjqQOmaQZgCQZpCQ29uQ2/+Vf3+VlcGVq9aVweurf6urlZWrlcGrq6ur1v+2ZgC2Zjq2kDq2/9u2///BlX/BlZXBlavBq8HBwdbB6//Wq3/Wq5XW///bkDrbkGbb25Db2//b/9vb///l5eXrwZXr1qvr///y8vL4dm3/tmb/1qv/25D/68H//7b//9b//9v//+v////wldweAAAACXBIWXMAAAsSAAALEgHS3X78AAAK10lEQVR4nO2dC1vbyBWGBSUh22VLml7tbpLtbmlLL9CW9BJ2abuEsmAvAf3/P1PNaCSPB0lzPCONZfx+Tx6k0eF45ns5GQTGx1mOkihb9wK2RYBOJEAnEqATCdCJBOhEAnQiATqRAJ1IgE4kQCcSoBMJ0IkE6EQCdCIBOpEAnUiATqRRgr57mSntnpnTwzy/f6uu7BxVZ1k2WfcqV9NIQVcU5/sTNXxW4FWXbgu8928P17m2UI0btIF6u3NUgs4v9i4B3Z9q0PMXR+aSAV1cAHR/Mnv0s/xWbdNaBnTxJTB79KbRHiloU9HNoDeNsda4QZut4/6/bB2DyP1mWNx78M1wCNm3d4fc3g0n880wmzT/wAJo1C5AJxKgEykI9IdS333oVt4djkz35UemfwC0MB/QYqeeOKCFVgENaJ0PaFk+oMVOPXFAC60CGtA6H9CyfECLnXriTwb0xz98o4/n01+9rz4Cun/Qs+nnGvTs9XX9D9D9g37418M/NOirY1Xb5cdiOC3U8xr6002HFp/1vEODLa1j66hAn6iz8qOJSGsisqQ88Yb8G1H6c9n0yUEvVzSghwK9SXv05oL++KfrTbrr2EzQ7Wp3urzU7jCgAa3zAd2eD+gmARrQOh/Q7fmAbhKgAa3zAd2eD+gmARrQOh/Q7fmAbhKgnxTopqdRZNMDuj2/CXTw9IBuzwd0kFNPHNCO1WCnnjigHavBTj1xQDtWg5164oB2rAY79cQB7VgNduqJA9qxGuzUEwe0YzXYqScOaMdqsFNPHNCO1WCnnjigHavBTj1xQDtWg5164lsA+juZpJ/XX/rN4/TnwdOPALS0JrrDVPSGgG56/cTjdEDHgxalAxrQgC7zAW0EaMdqsFNPHNCO1WCnnjigHavBTj1xQDtWg5164oB2rAY79cQB7VgNduqJA9qxGuzUEwe0YzXYqScOaMdqsFNPHNCO1WCnnjigHavBTj1xQDtWg5164oB2rAY79cQB7VgNduqJN4BufR1FyPSANmoCvUI6oIXpgJZaBTSgdT6gjQAttApoQOt8QBsBWmgV0IDW+alAV81Ir1TH6ONiuGhOKl1qpFNP/ImAttvrPvzz+uHv7xcx6VIjnXriTwS03TD66/f5xz/+dvpGnY+nI/rN40vDNTSPVjvoRQv0WUF49vk36lIpaU1ElpQn/vQq+muza8yOAd0/6MUerZp1a8hU9BCgy7sOBfn735fDaVXQgO4VdIekS4106okDWmgV0IDW+YA2ArTQKqABrfMBbQRooVVAA1rnA9oI0EKrgAa0zge0EaCFVgENaJ0PaCNAC62ulO5poGQE6CCn9qCBakM+oIOc2gNAdy010qk9AHTXUiOd2gNAdy010qk9AHTXUiOd2gNAdy010qk9AHTXUiOd2gNAdy010qk9AHTXUiOd2oPtBC1tdR3aI7sh/abts5Zkd+WOnH1bG3VvZ0VLlxrp1B4AumupkU7tAaC7lhrp1B4AumupkU7tAaC7lhrp1B4AumupkU7tAaC7lhrp1B4AumupkU7tAaC7lhrp1B4AumupkU7tAaC7lhrp1B6sH/TdyyzbOXp8dQLoyOldood5frF7BmilAUHXjE+z7DC/3f1Ztnt2/zb7wf7EXMmyR18FQIumd0DvXRZcs0kBvKji252j+b46Lz+qK1l3aQO6dfpl3ap6LYAW5VsU8K2GW8BfXHm8fwNaNv2y7l4+K8o6U3BL7Ap0WdHlFUCHTu9IbRzZM33YuyxBl3u0uQLo0On7FaBbpwd0ez6gg5zaA0B3LTXSqT1YP+jIP0fYYNCed04AtNipPfC8YGX12QHdnA7ocKuABrTO94Ke76tfcgDa8/A9gP5sBWaAbs13QS+9mLRH0FWjbtOi+3zRp3tLQTduHZ2/7BeBrpvAli267b7dgO5z66jbGpctuuvhmhp1r78r92Cgq0bdZYtuq283FT1MRSvNjpeG0qVGOrUHYwS9kvx7dNmimz16sB9Y6kbdZYtu7jr4yTBodkA3p68fdKQA3ZrviIoOmx3QzemADrcKaEDrfEAbrR30fF/91t/3t2CA9k3vB/3pT8/y/C8/BHTc9C7opb9r0KAP/jrJ57/4AtBx07ugH1f0wX8+y//9G0BHTi8A/e2v//bVt4COnF4A+vLi57+8B3Tk9BLQ8xdHgPY8PPfRjemADrcKaEDrfEAb8Yt/oVVAA1rnA9oI0EKrgAa0zge0EaCFVgENaJ0PaKMtAO3+NNqigTuiP398qcfZ6YheawsqWrrUSKf2ANDhVgENaJ0PaCNAC60CGtA6H9BGgBZaBTSgdf5TA930jt8rvwn46rNvIejAdEBLrQIa0Dof0EaAFloFNKB1PqCNAC20CmhA63xAGwFaaBXQgNb5gDYCtNAqoAGt8wFtBGih1ZVAe96iYvXZAd2c3kDVM/3GgK56ZD68m05fX5t23YDuHfSiCeybAvpJ2a4b0P2DXupjfHVStuvOB2jU3dCCu0GJu3L3L3+j7lwXddmu28SkNSEqKSq6rujzN4b3MaD7B714M4V3J3nVrhvQ/YOuG3Wfq1352LTrBnT/oDskXarIKaABDWjJ9IB2nAIa0ICWTA9oxymgAQ1oyfSAdpwCGtCAlkwPaMcpoAENaMn0gHacAhrQgJZMD2jHKaABDWjJ9IB2nAIa0ICWTA9oxymgAf20QDe9aEL0OgpAC61WoAPTtwG0tNW16LNa+2332ec7JH8EoKU1ISopKhrQgJZMD2jHKaABDWjJ9IB2nAIa0ICWTA9oxymgAQ1oyfSAdpwCGtCbAjr4V/q9kNom0JFOPXFAVwI0oCXTA1qWD2ixU08c0JUADWjJ9ICW5QNa7NQTB3QlQANaMj2gZfmAFjv1xAFdCdCAlkyfCnTVEd2cnC8aogO6T9CLjuj6pB4CumfQdf/o8qQeLndE737upOe1brT8HdHLE7tBer/PGYamP/WKBnTPoHvYowEtAV13RA+/6wC0CHSHpEuNdOqJA1poFdCA1vmAluUDWuzUEwe00CqgAa3zAS3LfwqghYp8O771pkfnOwL0UPmOAD1UviNAD5XvaEjQyBKgEwnQiQToRAJ0Ig0H2n5KZkU9vJtOX1/HPMLVccwCrqbqPdAjpm/QYKCXnmRcNVfZPIl4hNn0OGIB0dM3aTDQS0+bh+SfhD/C97/733HEAq7+rCo61oCj4UDbfwiyuoqqCn6Egs/sOGIB6g3ni69znAFXI61o7TX0Ea70O5lHVPSJesP5TanomC3u4d1J5CPMYvfoq43Zo2O+aZ/rkox5hFnsXUdUfpO4j04kQCcSoBMJ0IkE6ERaL+j5flZo0hL85CztagbVmkErlvMXR2tdRBqNAPT9F0f53ctstzgtD/NPf6IGRXB+8GVV8Cb0yZl9vbi4UyffZvowUo0A9PzgMj89zC+e5eYw35+Y4Hz/ML/du1SjU31WgS6v37+dqEOZdffqTD/GSDWGPXrv8u7HRwqUOZjNWQEtuRYDhbEIV6AXhzy3kkesEVR0UZfFf/6s2ATMoQm0+ljsMQ7oA1XsJkt91XbGy3oEoPPTiarXvCzb+qq8ol/VO7PZZsaoEYBW/+fLHdjaiHMHtAmpz73Yra6rPbo4lCGVD+gW1ffR5e2DOTSCNrcWF1n2o1f19fquQyWfcteBAJ1MgE4kQCcSoBMJ0IkE6EQCdCIBOpEAnUj/B6pdMZVVPy+TAAAAAElFTkSuQmCC" title="plot of chunk BEER" alt="plot of chunk BEER" style="display: block; margin: auto;" /></p>

<h2>Scatter Plots</h2>

<pre><code class="r">with(data = Beerwings, plot(Hotwings, Beer, xlab = &quot;Hot wings eaten&quot;, ylab = &quot;Beer consumed&quot;, 
                            pch = 19, col = &quot;blue&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Bplot" alt="plot of chunk Bplot" style="display: block; margin: auto;" /></p>

<pre><code class="r">p &lt;- ggplot(data = Beerwings, aes(x = Hotwings, y = Beer)) + 
  geom_point() + 
  labs(x = &quot;Hot wings eaten&quot;, y = &quot;Beer consumed in ounces&quot;)
p
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAxlBMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmkJBmtv9/f39/f5V/f6t/lcF/q9aQOgCQOjqQZgCQkGaQ2/+Vf3+VlcGVweurf6urlZWr1v+2ZgC2Zjq225C2/7a2///BlX/BlZXBlavBwdbB6//Wq3/W///bkDrb25Db/7bb///l5eXrwZXr1qvr///y8vL/tmb/1qv/25D/68H//7b//9b//9v//+v////M9htkAAAACXBIWXMAAAsSAAALEgHS3X78AAAKcklEQVR4nO2dAVfbyBVGRTYlTUpCW9wE0mXXu9CGbFtwy9IspsTo//+pzsgGYRs9aTSPD5nc7yQ+xrLviOs540EePRUlkaR46h34VoJoURAtCqJFQbQoiBYF0aIgWhREi4JoURAtCqJFQbQozaJPR6O//CvchptFfjXTsvkuv3V8njuwK88J2FX0zS9R8PTDl/AP0T2AXUV//fmH0X55MS6//nQWfhyFNHZ+0p5G0dP3Z+XF0cVRefOPs8VDOe9vHXr0A7LHdz0a0anAzj16XIYezRjdG9i5R4dZx7hk1tEbmDJ0rCSn2TqIRrQrENEiIKJFQESLgN+M6KLoyUN0ErAoVk0j+lGAiGboeGaie/MQnQlEtAiIaBEQ0SIgokVARIuAiBYBES0CIloERLQIiGgRENEiIKJFQESLgJsj+jczLZvT4w0U7yA9WgREtAiIaBEQ0SIgokVARIuAiBYBES0CIloERLQIiGgRENEiIKJFQESLgIgWARHdlLsF1T2BKwuyEd2Q+hSBfsDVUwwQ3RBEewEZOkRAPgxFQESLgIgWAREtAiJaBES0CDhc0RfUVMoAdhc9HY2p5Ngf2Fn0/37875hKjm5pLpn509k0iKaSY19gV9EXsQ9TybE/sKvosirmyBjdG5gmmllHb2CC6NXkNFsH0Yh2BSJaBES0CIhoERDRIiCiRUBEi4CIFgERLQIiWgREtAiIaBEQ0SIgokVARIuAz1b0agX01orojS9g2a4FXF0H3lrjv/kFioXok5fnk6LYQ3T6DiaJvn53GP5dvT7ZPNGbNXRc756EPr2Zot14kg/DSbF1eLmRQ4cfj1lHJhDRIuCgRM8Oipf/eXf4sOicuoY98pwrOc4Odq7enF++PKdHZwNN0WHWEUSHW0RnAzv06Ak92gFoio5jdFE0eEZ0EtAWbSan2TqIRrQr0BYd/yqcbDVM73KarYPosjqoFG451uEBNEXPDuJhDubRHkBTdHn9Nsw6XjzcoRGdBLRFm8lptg6iEe0KtEVfxi9kmsaOnGbrILqMQ3TDMX9EJwNt0Q2HkxCdDjRFl8c7iNYMHYzRzDpygYgWAYckmqHDD9ihR08aPhFzmq2D6Lpf852hA7CD6EuGDgegKXoxRrMkzAHYoUc3JafZOohGtCvQFn1vucHpaHQ05JpKq8uZk9dHN6YBuJa8BTRltey/LKf7Vem7wVYJW12gn7zivzkPA1N30BQ9n9jdTu+C6OFWcoweUn7ObiAzjT06jhqDruS40UPHypKwCyo59gfaouvE6oIX4+GO0enAgYqOs479Ic86koFDFb2enGbrIBrRrkBEi4C2aNZ1uAFN0azr8APaolnX4QY0RbOuww9o92i+nHUD2j3aTE6zdRCNaFegIfp69xNDhxuQHi0CIloERLQIiGgRENEioCF68ecKsw4XoN2jqz/BJ9v06HygKXp5uQGic4Cm6KXlBojOApqi58sNGkYORCcBbdFmcpqtg2hEuwJt0WaBwZxm6yC6bCswmFPXsEeecyVHCgz6ATv0aKZ3HkBTNAUG/YC2aDNLnNTlx8nLmVeBjcuVfZYzrwNbI1mplHrmQvqZEL+uvrFNJn3OhFgDtifnWEfTzA7RyUBbdPeVSgwdWUNH0/n266ITm63Dh2ElmgP/AxujU5utg+iS1aSeQFM0Y7Qf0O7RLAlzA9o92kxOs3UQjWhXoCmaocMP2KFHUyXMA9hBNAf+PYAdRFMlzANoiqZKmB+wQ49uSk6zdRCNaFegLXpzL1ftxxMdvdvYy1W78URH77hctejAP5erFn8Y3nwejT58oaZSb2BX0dNYueqIKmG9gbbo5XUdF0fDreS4abEq0IROPeBKjsnAIfXopcNJp/uxxCCVHHsCTdH3KtDcfD6KnZoxui+wZei4G6NP46g8ZtbRG2j3aDM5zdZBNKJdgbZoFqK7AU3RnDnrBzRFcy64H5AeLQKaohmj/YC2aDM5zdZBNKJdgbboeNB/ssW54A5AU/R8xT9fZXkATdGzg3iYtOmk+5xm6yC66tJvmxeTIjoJaIs2k9NsHUQj2hWIaBEQ0SKgKZrzDP2ApujZR86c5WShXOCQRNvJabYOohHtCrRFU2DQDWiKtgsM5jRbB9FlW4HBnLqGPfKcKzlSYNAPaIrmO0M/oC3aTE6zdRCNaFegLZrpnRvQFM30zg9oiqZ+tB+wQ49meucBNEUzvfMD2qLN5DRbB9GIdgVaoq9eFduXrOt4dNFxndIkWGZ65wE0RMdpXZh0sOLfBYhoEfCxRLeVkm8rPZ/6e9TZQNEZl0JtuzhC28UUkn+POpsnui0WFtFrWx9HNEPH2tZHEs2H4epWRGuAiBYBES0CIloERLQIiGgRsLvoqjwYNZX6AjuLno7en1ElrD+wq+ibf8bKglRy9IoxdFSiqeTYF5gomkqOfYFpohmjewPTRDPr6A3sLnotOc3WQTSiXYGIFgERLQIiWgREtAiIaBEQ0SIgokVARIuAiBYBES0CIloERLQIiGgRENEiIKJFQESLgIgWAREtAiJaBES0CIhoERDRImCG6Jy6hj3ynCs50qP9gIgWAREtAiJaBES0CIhoERDRIiCiRUBEi4CIFgERLQIiWgREtAiIaBEQ0SIgokVARIuAiBYBES0CIloERLQIiGgRENEiIKJFQESLgIgWARNFd66p1F7hfPnXoCL6UjpXCetQs3/p16DG/3I6V3KM4mxU3vM3Pm2iO1dyZOhY3ZommkqOfYFpoqnk2BuYJppKjr2BiaLvJ6fZOohGtCsQ0SIgokVARIuAiBYBES0CIloERLQImCHajvtlWryBT7uDiBYBES0CIloE/La+5njCIFoURIuCaFEQLYqX6NPRve+88rN2GVYfnhfw5vNo9OFL0g46ib75xdHyQ5dhdeA57uN0P7xtR0k76CT6688/jPZ9UOXaZVideL77WF4cJe2gk+jp++qyqW5ZuwyrA893H0OnTtpBxw/D6diP5dujyzshbvt4ul+m7aBXjx6X7j3acYye8/z28eZz5DzFGB0/0R079PplWH14Xvt4Gtd8jp9i1kHagmhREC0KokVBtCjDFH31+uTutly699CPbZxBZCNFJ3IGkaGLvn5bvDipbsrZwV559fvD8vLlv1+fXL35a1HslXH7d38KjxXxGTHz55ZXr8Lmey++ff6TZeiij3eC2PP5z5OdchJkTXbCj1evqg3V9q3D692TcrJdvTQ8EO5dvzuML18QwgO3z3+yDFT0q3h6XOyOwWCQthD/5vxv32/PPh4uFIb/cXt4IHqdJ96LD8a7u/FZiwcWz3+6X2mgom97dLwzN1tGc592//76U2VtIS64j9vjO7NVuQ4DRVHdPY7vUxQ9fwDRD+ZO9FKPLo///IfZx++3y7UeHTfOB4bb3vx2b/GsxQOIfjAPj9HhI28+SteiF2N0lLwYgesXhA/OZQKi17Iy6wgTjmpOUc05XpzcFx22/y706OP7s444ckyK4rs/7sXXzR9AdH4GNFk2suGiZwfF4lNw6Nlw0ZsTRIuCaFEQLQqiRUG0KIgWBdGi/B93LuZXXRZevwAAAABJRU5ErkJggg==" title="plot of chunk Bplot" alt="plot of chunk Bplot" style="display: block; margin: auto;" /></p>

<pre><code class="r">p + geom_smooth()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Bplot" alt="plot of chunk Bplot" style="display: block; margin: auto;" /></p>

<pre><code class="r">p + geom_smooth(method = lm) + theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Bplot" alt="plot of chunk Bplot" style="display: block; margin: auto;" /></p>

<h2>Integrating with R</h2>

<pre><code class="r">f &lt;- function(x) {
    (x - 1)^3 * exp(-x)
}
ans &lt;- integrate(f, lower = 0, upper = Inf)$value
ans
</code></pre>

<pre><code>[1] 2
</code></pre>

<h1>Can A New Drug Reduce the Spread of Schistosomiasis?</h1>

<p>Schistosomiasis (skis-tuh-soh-may&#39;-uh-sis) is a disease in humans caused by parasitic flatworms called schistosomes (skis&#39;-tuh-sohms).  Schistosomiasis affects about 200 million people worldwide and is a serious problem in sub-Saharan Africa, South America, China, and Southeast Asia.  The disease can cause death, but more commonly results in chronic and debilitating symptoms, arising primarily from the body&#39;s immune reaction to parasite eggs lodged in the liver, spleen,and intestines.</p>

<p>Currently there is one drug, praziquantel (pray&#39;-zee-kwan-tel), in common use for treatment of schistosomiasis; it is inexpensive and effective. However, many organizations are concerned about relying on a single drug to treat a serious disease that affects so many people worldwide. Drug resistance may have prompted an outbreak in the 1990s in Senegal, where cure rates were low.  In 2007, several researchers published work on a  promising drug called K11777, which, in theory, might treat schistosomiasis.</p>

<pre><code class="r">gender &lt;- c(rep(&quot;Female&quot;, 10), rep(&quot;Male&quot;, 10))
group &lt;- rep(rep(c(&quot;Treatment&quot;, &quot;Control&quot;), each = 5), 2)
worms &lt;- c(1, 2, 2, 10, 7, 16, 10, 10, 7, 17, 3, 5, 9, 10, 6, 31, 26, 28, 13, 47)
schis &lt;- data.frame(gender, group, worms)
head(schis, n = 3)
</code></pre>

<pre><code>  gender     group worms
1 Female Treatment     1
2 Female Treatment     2
3 Female Treatment     2
</code></pre>

<pre><code class="r">schis
</code></pre>

<pre><code>   gender     group worms
1  Female Treatment     1
2  Female Treatment     2
3  Female Treatment     2
4  Female Treatment    10
5  Female Treatment     7
6  Female   Control    16
7  Female   Control    10
8  Female   Control    10
9  Female   Control     7
10 Female   Control    17
11   Male Treatment     3
12   Male Treatment     5
13   Male Treatment     9
14   Male Treatment    10
15   Male Treatment     6
16   Male   Control    31
17   Male   Control    26
18   Male   Control    28
19   Male   Control    13
20   Male   Control    47
</code></pre>

<pre><code class="r">require(ggplot2)
p &lt;- ggplot(data = schis, aes(group, worms)) + geom_point(position = &quot;jitter&quot;, aes(color = group)) + 
    facet_grid(. ~ gender) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk F2" alt="plot of chunk F2" style="display: block; margin: auto;" /></p>

<h1>ACTIVITY</h1>

<ol>
<li><p>Use the previous graph to compare visually the number of worms for the treatment and control groups for both the male and female mice.  Does each of the four groups appear to have a similar center and similar spread?  Are there any outliers (extreme observations that don&#39;t fit with the rest of the data)?</p></li>
<li><p>Calculate appropriate summary statistics (e.g., the median, mean, and standard deviation) for each of the four groups.  For the female mice, calculate the difference between the treatment and control means.  Do the same for the male mice.</p></li>
</ol>

<pre><code class="r">with(data = schis, schis[order(gender, group, worms), ])
</code></pre>

<pre><code>   gender     group worms
9  Female   Control     7
7  Female   Control    10
8  Female   Control    10
6  Female   Control    16
10 Female   Control    17
1  Female Treatment     1
2  Female Treatment     2
3  Female Treatment     2
5  Female Treatment     7
4  Female Treatment    10
19   Male   Control    13
17   Male   Control    26
18   Male   Control    28
16   Male   Control    31
20   Male   Control    47
11   Male Treatment     3
12   Male Treatment     5
15   Male Treatment     6
13   Male Treatment     9
14   Male Treatment    10
</code></pre>

<pre><code class="r">with(data = schis, tapply(worms, list(gender, group), median))
</code></pre>

<pre><code>       Control Treatment
Female      10         2
Male        28         6
</code></pre>

<pre><code class="r">with(data = schis, tapply(worms, list(gender, group), mean))
</code></pre>

<pre><code>       Control Treatment
Female      12       4.4
Male        29       6.6
</code></pre>

<pre><code class="r">with(data = schis, tapply(worms, list(gender, group), sd))
</code></pre>

<pre><code>       Control Treatment
Female   4.301     3.912
Male    12.186     2.881
</code></pre>

<p>The descriptive analysis in Questions 1 and 2 points to a positive treatment effect: K11777 appears to have reduced the number of parasite worms in this sample.  But descriptive statistics are usually only the first step in ascertaining whether an effect is real; we often conduct a significance test or create a confidence interval to determine if chance alone could explain the effect.</p>

<p>We will introduce the basic concepts of randomization tests in a setting where units (mice in this example) are randomly allocated to a treatment or control group.  Using a significance test, we will decide if an observed treatment effect (the difference between the mean responses in the treatment and control) is &ldquo;real&rdquo; or if &ldquo;random chance alone&rdquo; could plausibly explain the observed effect.  The null hypothesis states that &ldquo;random chance alone&rdquo; is the reason for the observed effect.  In this initial discussion, the alternative hypothesis will be one-sided because we want to show that the true treatment mean(\( \mu_{treatment} \)) is less than the true control mean (\( \mu_{control} \)).</p>

<h1>Statistical Inference Through a Randomization Test</h1>

<p>Whether they take the form of significance tests or confidence intervals, inferential procedures rest on the <strong>fundamental question for inference:</strong> &ldquo;What would happen if we did this many times?&rdquo; Let&#39;s unpack this question in the context of the female mice schistosomiasis.  We observed a difference in means of 7.6 = 12 - 4.4 worms between the control and treatment groups.  While we expect that this large difference reflects the effectiveness of the drug, it is possible that chance alone could explain this difference.  This &ldquo;chance alone&rdquo; position is usually called the null hypothesis and includes the following assumptions:</p>

<ul>
<li>The number of parasitic worms found in the liver naturally varies from mouse to mouse.</li>
<li>Whether or not the drug is effective, there clearly is variability in the responses of mice to the infestation of schistosomes.</li>
<li>Each group exhibits this variability, and even if the drug is not effective, some mice do better than others.</li>
<li>The only explanation for the observed difference of 7.6 worms in the means is that the random allocation randomly placed mice with  larger numbers of worms in the control group and mice with smaller numbers of worms in the treatment group.</li>
</ul>

<p>In this study, the <strong>null hypothesis</strong> is that the treatment has no effect on the average worm count, and it is denoted as </p>

<blockquote>
<p>\( H_0:\mu_{control} = \mu_{treatment} \)
Another way to write this hypothesis is 
\( H_0: \text{the treatment has no effect on average worm count} \)</p>
</blockquote>

<p>Alternative hypotheses can be &ldquo;one-sided, greater-than&rdquo; (as in this investigation), &ldquo;one-sided, less-than&rdquo; (the treatment causes an increase in worm count), or &ldquo;two-sided&rdquo; (the treatment is different, in one direction or the other, from the mean).  We chose to test a one-sided hypothesis because there is a clear research interest in one direction.  In other words, we will take action (start using the drug) only if we can show that K11777 reduces worm count.</p>

<blockquote>
<p><strong>The fundamental question for inference:</strong> Every statistical inference procedure is based on the question &ldquo;How does what we observed in our data compare to what would happen if the null hypothesis were actually true and we repeated the process many times?&rdquo;</p>
</blockquote>

<p>For a randomization test comparing responses for the two groups, this question becomes &ldquo;How does the observed difference between groups compare to what would happen if the treatments actually had no effect on the individual responses and we repeated the random allocation of individuals to groups many times?&rdquo;</p>

<h1>Conducting a Randomization Test by Hand</h1>

<ol>
<li><p>To get the feel for the concept of a <em>p</em>-value, write each of the female worm counts on an index card.  Shuffle the 10 index cards, and then draw five cards at random (without replacement).  Call these five cards the treatment group and the five remaining cards the control group.  Under the null hypothesis (i.e. the treatment has no effect on the worms), this allocation mimics precisely what actually happened in our experiment, since the only cause of group differences is the random allocation.  Calculate the mean of the five cards representing the treatment group and the mean of the five cards representing the control group.  Then find the difference between the control and treatment group means that you obtained in your allocation.  To be consistent, take the control group mean minus the treatment group mean.</p></li>
<li><p>If you were to do another random allocation, would you get the same difference in means? Explain.</p></li>
<li><p>Now, perform nine more random allocations, each time computing and writing down the difference in mean worm count between the control group and the treatment group.  Graphically represent the differences.  What proportion of these differences are 7.6 or larger?</p></li>
<li><p>If you performed the simulation many times, would you expect a large percentage of the simulations to result in a mean difference greater than 7.6?  Explain.</p></li>
</ol>

<p>The reasoning in the previous activity leads us to the randomization test and an interpretation of the fundamental question for inference.  The fundamental question for this context is as follows:  &ldquo;If the null hypothesis were actually true and we randomly allocated our 10 mice to treatment and control groups many times, what proportion of the time would the observed difference in means be as big or bigger than 7.6?&rdquo;  This long-run proportion is a probability that statisticians call the <strong><em>p-value</em></strong> of the randomization test.  The <em>p</em>-values for most randomization tests are found through simulations.  Despite the fact that simulations do not give exact <em>p</em>-values, they are usually preferred over the tedious and time consuming process of listing all possible outcomes.  Researchers usually pick a round number such as 10,000 repetitions on the simulation and approximate the <em>p</em>-value accordingly.  Since this <em>p</em>-value is an approximation, it is often referred to as the <strong>empirical <em>p</em>-value.</strong></p>

<blockquote>
<p><strong>Key Concept:</strong> Assuming that nothing except the random allocation process is creating group differences, the <em>p</em>-value of a randomization test is the probability of obtaining a group difference as large as or larger than the group difference actually observed in the experiment.</p>

<p><strong>Key Concept:</strong> The calculation of an empirical <em>p</em>-value requires these steps:</p>

<ul>
<li>Repeat the random allocation process a number of times (N times).</li>
<li>Record, each time, whether or not the group difference exceeds or is the same as the one observed in the actual experiment (let X be the number of times the group difference exceeds or is the same as the one observed).</li>
<li>Compute (X + 1)/(N + 1) to get the <em>p</em>-value, the proportion of times the difference exceeds or is the same as the observed difference.</li>
</ul>
</blockquote>

<p><strong>Note:</strong> Including the observed value as one of the possible allocations is a more conservative approach and protects against getting a <em>p</em>-value of 0.  Our observation from the actual experiment provides evidence that the true <em>p</em>-value is greater than zero.</p>

<h1>Performing a Randomization Test Using Computer Simulation</h1>

<p>While physical simulations (such as the index cards activity) help us understand the process of computing an empirical <em>p</em>-value, using computer software is a much more efficient way of producing an empirical <em>p</em>-value based on a large number of iterations.  If you are simulating 10 random allocations, it is just as easy to use index cards as a computer.  However, the advantage of a computer simulation is that 10,000 random allocations can be conducted in almost the same time it takes to simulate 10 allocations.</p>

<h1>Two-Sample Permutation Test</h1>

<blockquote>
<p>Pool the <em>m + n</em> values.</p>

<ul>
<li><strong>repeat</strong>

<ul>
<li>Draw a resample of size <em>m</em> without replacement.</li>
<li>Use the remaining <em>n</em> observations for the other sample.</li>
<li>Calculate the difference in means or another test statistic that compares samples.</li>
</ul></li>
<li><strong>until</strong> 

<ul>
<li>we have enough samples</li>
</ul></li>
</ul>
</blockquote>

<p>Calculate the <em>p</em>-value as the fraction of times the random statistics are more or as extreme as the original statistic. Optionally, plot a histogram of the random statistic values.   </p>

<p><strong>Definition 3.2</strong> A <em>test statistic</em> is a numerical function of the data whose value determines the result of the test.  The function itself is generally denoted <em>T=T(X)</em>, where <strong>X</strong> represents the data.  After being evaluated for the sample data <strong>x</strong>, the result is called an <em>observed test statistic</em> and is written in lowercase, <em>t=T(x)</em>.</p>

<h1>Using Computer Simulations to Conduct a Hypothesis Test</h1>

<ol>
<li><p>Write code to allocate randomly each of the female worm counts to either the treatment or the control group.</p></li>
<li><p>Take the control group average minus the K11777 treatment group average.</p></li>
<li><p>Write code that perform steps 1. and 2. N = 99,999 times.  Compute and report the empirical <em>p</em>-value.</p></li>
<li><p>Create a histogram of the N simulated differences between group means and comment of the shape of the histogram.  </p></li>
<li><p>Based on your results in Questions 3 and 4 and assuming the null hypothesis is true, about how frequently do you think you would obtain a mean difference as large as or larger than 7.6 by random allocation alone?</p></li>
<li><p>Does your answer to Question 5 lead you to believe the &ldquo;chance alone&rdquo; position (i.e., the null hypothesis that the mean worm count is the same for both the treatment and the control), or does is lead you to believe that K11777 has a positive inhibitory effect on the schistosome worm in female mice?  Explain.</p></li>
</ol>

<h1>Using R</h1>

<pre><code class="r">ND &lt;- schis[gender == &quot;Female&quot;, ]
ND
</code></pre>

<pre><code>   gender     group worms
1  Female Treatment     1
2  Female Treatment     2
3  Female Treatment     2
4  Female Treatment    10
5  Female Treatment     7
6  Female   Control    16
7  Female   Control    10
8  Female   Control    10
9  Female   Control     7
10 Female   Control    17
</code></pre>

<pre><code class="r">tapply(ND$worms, ND$group, mean)
</code></pre>

<pre><code>  Control Treatment 
     12.0       4.4 
</code></pre>

<pre><code class="r"># OR
ANS1 &lt;- with(data = ND, tapply(worms, group, mean))
ANS1
</code></pre>

<pre><code>  Control Treatment 
     12.0       4.4 
</code></pre>

<pre><code class="r">observed &lt;- ANS1[1] - ANS1[2]
observed
</code></pre>

<pre><code>Control 
    7.6 
</code></pre>

<pre><code class="r">names(observed) &lt;- NULL
observed
</code></pre>

<pre><code>[1] 7.6
</code></pre>

<p>Since we will be working with the <strong>worms</strong> variable for females only, we will create a vector holding these values.  Then, we will draw a random sample of size 5 from the numbers 1 through 10 (there are 10 observations).  The worms values corresponding to these positions will be values for the Control group and the remaining ones for the Treatment group.  The mean difference of this permutation will be stored in <strong>result</strong>.  This will be repeated many times.</p>

<pre><code class="r">Worms &lt;- ND$worms
Worms
</code></pre>

<pre><code> [1]  1  2  2 10  7 16 10 10  7 17
</code></pre>

<pre><code class="r"># Another way:
Worms2 &lt;- subset(ND, select = worms, drop = TRUE)
Worms2
</code></pre>

<pre><code> [1]  1  2  2 10  7 16 10 10  7 17
</code></pre>

<pre><code class="r">N &lt;- 10^4 - 1  # number of times to repeat the process
result &lt;- numeric(N)  # space to save the random differences
set.seed(5)
for (i in 1:N) {
    # sample of size 5, from 1 to 10, without replacement
    index &lt;- sample(10, size = 5, replace = FALSE)
    result[i] &lt;- mean(Worms2[index]) - mean(Worms2[-index])
}
hist(result, col = &quot;blue&quot;, freq = FALSE, main = &quot;&quot;, breaks = &quot;Scott&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAb1BMVEX9/v0AAAAAADkAAGUAAP8AOTkAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBltf2POQCPOTmPOWWP29qP2/21ZgC1/rW1/v3ajzna/rXa/v39tWX924/9/rX9/tr9/v064LvqAAAAJXRSTlP///////////////////////////////////////////////8AP89CTwAAAAlwSFlzAAALEgAACxIB0t1+/AAACDxJREFUeJzt3Y12mzYAhuGSbEnWdYubJe3ixov/7v8aa2E7NbNAEhIfAr3v2eZzmoXAcyiWQYRPe5L0aewVKCWgRQEtCmhRQIsCWhTQooAWBbQooEUBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWhTQooAWBbQooEUBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFFAiwJaFNCigBblht48VKbbN8HazDgn9O7luX5d370PvjJzzgm9fXprvFK/2KNFuY/R2wXH6AQx6hAFtCiv4d3jkkNHbF5vhsuD8uYLb4YxeQ3v1o8M72LzHt6xR8flM7wz0quLY3R1bsD1ml0xow6gAwJalDe05c0Q6IDYo0UBLSrmxD/QAcWcJs0ZOrsRaMyJ/3y24rrqt7p8VnG2e/TkoDtO/OezFddNELq9fLbiOqBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWtT0oM0Jf3Om1DIPPZ+tuG6S0PXFlc1fV1/KZyuumyR0Pe2OS1lxuaEXN/9+f7NOcsxnK66bHrS5aljd79dcyoqLUYcooEV5zVS6eeXNMDaveR27l0egI/OcqbS8Bzou35lKq98/Ax2Tz0ylR/NycRPLFO5hmSB0e/lsxXVAi5ouNG+GcbFHiwJa1FzvYZkeNDP+08Q9LKLYo0VxD4soRh2igBYFtCigRQEtCmhRQIsCWhTQooAWBbQooEUBLQpoUVzKEsWJf1FcyhLFHi2KS1miGHWIAloU97CI4h4WUdzDIop7WERxD4soRh2igBbFPSyi2KNFAS2KE/+iOE0qihP/otijRXHiXxSjDlFAiwJaFNCigBYFtCigReUAPcQFG6BtyxkABWjbcsqB3i7ue3yvArrvYSVT6P1+XdXzkYKSQPcEyxZ6X//m8+o55HuBDugMfZxhZznp3BHQAZ2P0ZbHrDgDOqATdL0nW/dnwQNvioE+ndq3YioeeFMMdMu+vD9/aegH3hQE3ZHggTfFQG+ffrReF9wLHnhTDHTfgA4IaFEn6NXd+yrwcyHQQZ1GHV9fD/9sru+e6AzogD6Gd4d92gr9Mci+fjcEOqDzoaO6eV3bDx3m3jd7QAfk8WZ4OKg0/yD1zUJAOwI6oBP0uuMDS2tK6NC/Q5lCbxfOkd3I5zpC3XKFDjrhfw7ogE6HjmXbyKIroAM6Hzraj9HD3yxUEHRHglsrgDYJbhYqCXr3Ut399/8PJqevsEen6Ah9+Ji9+fJusdwrbhYqCPp4YTB0kAd0QJd79CpwcgfQAf06RttnG3QFdEBTOakEdIIKgq4//QWeuwM6qBp6XU+N3jxkfHF2FtC7b8dPKpbJSJ0BHdBxplLrp+zOgA4IaFFAi2rMj874muEsoPs2NnTXFVugbcvpC+3xfYlWMb4cfu8d0KaMT/zPCzrjS1nzgmaPTlMOv/cOaEdABwS0KKBFAS3K487ZLO5hmT90JvewFACdxz0sJUC3BnRAQIvK4YE3QDuaOLT20WolQ0t3+oJP/GcGPd/TpJlBz/fEf2bQ7NFpKvHE/3m4kRl0e5OF7ljmYAENdONrQCcoGMXjIAu0bTnB0G4poG3LAbq7vKCb54iAti3HH6V5cLbqBy8z0VY4mhi09cW2FKBtywG6O6ADAhroxte6XmwfX4C2LScS2s3eucxEW+HI68R/Bs9h6fviscxEW+HIBzqH57AUAZ3Dc1gKgM7jOSzzh87kOSwlQLcGdEBAZwOd1UylGUPnNa9jxtB5zVSaMTR7dJr6zFQa8R6WOUO3B3RAQHtvRdzf44ndwzI09HC/pmmAPTrpU4DU0B7f5r1djYaA7lrZZh7fUA508CfD4G0E2hQ+jgba1gCfDIG2xR59XomomcDuBriHZaLQ3t9m32pX6lGHGrprlAN0+zdEvjhXokBo+wxdoC//OA56EOHTi3N6dVHQQwh3vVz+WKCBtvxxX+gBjxnlQPvcfTLSy+VKzADauY1AtwZ0QEBboW3XLoAeALprE/phAQ000B8/ueWPJwZ9OfAcEzrNNUP3No4GffkyInSiKyw5KOYNneiaYQ6KeUOzR3dul3eqa4Y5KGYO3V7R0KET39JAN35qIdC2/6WjNMO7xk8Fuhe015sh0PHQXsM7oOOh2aNF0F43C1Xllg6akgS0qJibhSgg9mhRQIuK+WRIAcWMoymgmE+G0Y08BG6WfOuajbpHp9m4nJbSXsyJ/+hyIhofesByIgJ6UktpD+ikS2kP6KRLaQ/opEtpj4/gooAWBbQooEUBLQpoUUCLAloU0KKAFjUm9CrBae7twvbMozHWxNGY0Mvn6EWY6z+r+xzWxNWI0Ltvr9HLMFcyN59j98UUa+JqROj6GlnkrmSed7T9GsuUYk1cjQi9+eM1el8yl4zjoVOsiauRoJdVdTyyRh4d0+zRKdbE1djDu8jNS3OMTrEmrkaENn/td9/jkHYvjwlGHSnWxNXI4+ibBO9jacbR0WviaOxDRzEBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIuaE/Tm81uiqQcDBLSoCUJv/vzn9m27qOfZruvptoa3Vv6xyPZXEk0R+uF5v1/WE2fMRKXDywc0e3TKDKaZb3dQPk27A3qQamgz0fbm1fwKM/NfoIeohv71q7TWd+9AD1KNeThGH4TN7MTDv+YIsroFOnE15uHYYaYlLo83+ayq6u8no7x7YdRReECLAloU0KKAFgW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIv6CciNIKlvA8+LAAAAAElFTkSuQmCC" title="plot of chunk F3" alt="plot of chunk F3" style="display: block; margin: auto;" /></p>

<pre><code class="r">d.res &lt;- density(result)
plot(d.res, main = &quot;&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
polygon(d.res, col = &quot;pink&quot;)
xs &lt;- c(7.6, d.res$x[d.res$x &gt;= 7.6])
ys &lt;- c(0, d.res$y[d.res$x &gt;= 7.6])
polygon(xs, ys, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAZlBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OY85ZrU5j9plAABlADllAGVltf2POQCPOTmPOWWPtY+P29qP2/21ZgC1/v2+vr7ajzna/v39tWX924/9/rX9/tr9/v3/AAD/wMsJPBDWAAAAInRSTlP/////////////////////////////////////////AP//nkoYEQAAAAlwSFlzAAALEgAACxIB0t1+/AAACQ5JREFUeJzt3X1f2zYXxvGebmyjDyvr+rBCIOX9v8nVIRBjS8eyztElWb5+/9yfe0pk6Rs3CQHMmyOD9Kb2AvYSoUERGhShQREaFKFBERoUoUERGhShQREaFKFBERoUoUERGhShQREaFKFBERoUoUERGhShQREaFKFBERoUoUERGhShQREaFKFBERoUoUERGhShQREaFKFBERoUoUERGhShQREaFKFBERoUoUERGhShQREa1CL0/d/fj/cfRH6/RSyn31KgB+vj4R1iOf2WAn24vn06s1l+y9Af3n75PJzR13zusJTwYvhwI1fHu994Qpviuw5QhAZFaFCEBpXwrkOe4quhqeUz+uHmPWAd3Zfw1HH/8evr/yAslBk62sLUO4vQoLygA591EHocz2hQhAZlhj78cXpNDbyNJvQ4K/TDzafT/97Nv8VC6HFW6OcXwSZeDJferI5uWXIZOUfc1Bktj6mHTL+lW+bn6POHHS08R/cNnT21f/KY6kdoS7+cE/3Sb+kXoUERGlRn0Gl+hDZFaFDroNHS/UCf9JL40m/pGKFBERoUoUERGhShQe0Q+umGhM4+XKrf+YZgaUKD6gY6nY/QpggNitCgCA2K0KCe+Rb9km/oG6FBERoUoUHtGBorTWhQvUCn8xHaFKFBXfiW/AhtKhk6/RHxjdCgCA2K0KAIDYrQoDqE1gEJbSsHGiq9N+jx7QidczBCQ0r2I7QtQoMiNChCg3rlpwES2hahQaVCJz8g/ivUhwnttkJ9mNBuK9SHCe22Qn14m9BxwdTbFVihPryV6971D93IVcL6h27kunf9Q7dxRk/8ooCptyuxRH14I9e92wN09tSeTQFjgoQ2RmhQhAa1A2jlD960B536eBRZoj5s+YM3NaHDhJuGVv7gTf6q1rYL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" title="plot of chunk F3" alt="plot of chunk F3" style="display: block; margin: auto;" /></p>

<pre><code class="r">pvalue &lt;- (sum(result &gt;= observed) + 1)/(N + 1)  # p-value
pvalue  # results will vary
</code></pre>

<pre><code>[1] 0.0274
</code></pre>

<pre><code class="r"># ggplot2 approach now
DF &lt;- data.frame(x = result)
p &lt;- ggplot(data = DF) + geom_density(aes(x = x, y = ..density..), fill = &quot;pink&quot;, alpha = 0.4) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk F3" alt="plot of chunk F3" style="display: block; margin: auto;" /></p>

<pre><code class="r">x.dens &lt;- density(result)
df.dens &lt;- data.frame(x = x.dens$x, y = x.dens$y)
p + geom_area(data = subset(df.dens, x &gt;= 7.6 &amp; x &lt;= max(DF$x)), aes(x = x, y = y), fill = &quot;blue&quot;, alpha = 0.4) + 
    labs(x = expression(bar(x)[Control] - bar(x)[Treatment]), y = &quot;&quot;, title = &quot;Randomization Distribution&quot;) + 
    theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk F3" alt="plot of chunk F3" style="display: block; margin: auto;" /></p>

<p>The code snippet <strong>result &gt;= observed</strong> results in a vector of <strong>TRUE&#39;s</strong> and <strong>FALSE&#39;s</strong> depending on whether or not the mean difference computed for a resample is greater than the observed mean difference.  <strong>sum(result &gt;= observed)</strong> counts the number of <strong>TRUE&#39;s</strong>.  Thus, the computed <em>p</em>-value is just the proportion of statistics (including the original) that are as large or larger than the original mean difference. The empirical <em>p</em>-value is 0.0274.</p>

<p>Because the sample sizes in the schistosomiasis study are small, it is possible to apply mathematical methods to obtain an <strong>exact <em>p</em>-value</strong> for this randomization test.  An exact <em>p</em>-value can be obtained by writing down the set of all possibilities (assuming each possible outcome is equally likely under the null hypothesis) and then calculating the proportion of the set for which the difference is at least as large as the observed difference.  In the schistosomiasis study, this requires listing every possible combination in which five of the 10 female mice can be allocated to the treatment (and the other five mice are assigned to the control).  There are \( \binom{10}{5}= \) 252 possible combinations.  For each of these combinations, the difference between the treatment and control means is then calculated.  The exact <em>p</em>-value is the proportion of times in which the difference in the means is at least as large as the observed difference of 7.6 worms.  Of these 252 combinations, six have a mean difference of 7.6 and one has a mean difference greater than 7.6 (namely 8.8).  Since all 252 of these random allocations are equally likely, the exact <em>p</em>-value in this example is 7/252 = 0.0278.  However, most real studies are too large to list all possible samples.  Randomization tests are almost always adequate, providing approximate <em>p</em>-values that are close enough to the true <em>p</em>-value.  </p>

<blockquote>
<p>Key Concept: The larger the number of randomizations within a simulation study, the more precise the <em>p</em>-value is. If the true <em>p</em>-value is p, the estimated <em>p</em>-value has variance approximately equal to \( p(1 - p)/N \), where \( N \) is the number of resamples.</p>
</blockquote>

<p>Sometimes we have some threshold <em>p</em>-value at or below which we will reject the null hypothesis and conclude in favor of the alternative hypothesis.  This threshold value is called a <strong>significance level</strong> and is usually denoted by the Greek letter alpha (\( \alpha \)).  Common values are \( \alpha = 0.05 \) and \( \alpha = 0.01 \), but the value will depend heavily on context and the researcher&#39;s assessment of the acceptable risk of stating an incorrect conclusion.  When the study&#39;s <em>p</em>-value is less than or equal to this significance level, we state that the results are <strong>statistically significant at level \( \alpha \)</strong>.  If you see the phrase &ldquo;statistically significant&rdquo; without a specification of \( \alpha \) the writer is most likely assuming \( \alpha = 0.05 \), for reasons of history and convention alone.  However, it is best to show the <em>p</em>-value instead of simply stating a result is significant at a particular \( \alpha \)-level.</p>

<h1>Activity</h1>

<p>Explain what each line of the following code is doing.</p>

<pre><code class="r"># PROGRAMMING IS THE BEST WAY TO DEBUG YOUR THINKING!  Theoretical Answer
require(PASWR)
DATA &lt;- c(1, 2, 2, 10, 7, 16, 10, 10, 7, 17)
DATA
</code></pre>

<pre><code> [1]  1  2  2 10  7 16 10 10  7 17
</code></pre>

<pre><code class="r">OBS &lt;- mean(DATA[6:10]) - mean(DATA[1:5])
OBS
</code></pre>

<pre><code>[1] 7.6
</code></pre>

<pre><code class="r"># ANS &lt;- t(Combinations(10, 5))
ANS &lt;- t(combn(10, 5))
head(ANS)
</code></pre>

<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]    1    2    3    4    5
[2,]    1    2    3    4    6
[3,]    1    2    3    4    7
[4,]    1    2    3    4    8
[5,]    1    2    3    4    9
[6,]    1    2    3    4   10
</code></pre>

<pre><code class="r">nn &lt;- dim(ANS)[1]
nn
</code></pre>

<pre><code>[1] 252
</code></pre>

<pre><code class="r">means &lt;- numeric(nn)
for (i in 1:nn) {
    means[i] &lt;- mean(DATA[ANS[i, ]]) - mean(DATA[-ANS[i, ]])
}
sort(means)
</code></pre>

<pre><code>  [1] -8.8 -7.6 -7.6 -7.6 -7.6 -7.6 -7.6 -6.4 -6.4 -6.4 -5.6 -5.6 -5.6 -5.6 -5.6 -5.6 -5.2 -5.2 -5.2
 [20] -5.2 -5.2 -4.8 -4.8 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.0 -4.0 -4.0
 [39] -4.0 -4.0 -4.0 -4.0 -4.0 -4.0 -3.6 -3.6 -3.6 -3.2 -3.2 -3.2 -3.2 -2.8 -2.8 -2.8 -2.8 -2.4 -2.4
 [58] -2.4 -2.4 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0
 [77] -2.0 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6
 [96] -1.2 -1.2 -1.2 -1.2 -1.2 -1.2 -1.2 -1.2 -1.2 -0.8 -0.8 -0.8 -0.8 -0.8 -0.8 -0.8 -0.8 -0.8 -0.8
[115] -0.4 -0.4 -0.4 -0.4 -0.4 -0.4 -0.4 -0.4 -0.4  0.0  0.0  0.0  0.0  0.0  0.0  0.4  0.4  0.4  0.4
[134]  0.4  0.4  0.4  0.4  0.4  0.8  0.8  0.8  0.8  0.8  0.8  0.8  0.8  0.8  0.8  1.2  1.2  1.2  1.2
[153]  1.2  1.2  1.2  1.2  1.2  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6
[172]  1.6  1.6  1.6  1.6  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0
[191]  2.0  2.0  2.0  2.4  2.4  2.4  2.4  2.8  2.8  2.8  2.8  3.2  3.2  3.2  3.2  3.6  3.6  3.6  4.0
[210]  4.0  4.0  4.0  4.0  4.0  4.0  4.0  4.0  4.4  4.4  4.4  4.4  4.4  4.4  4.4  4.4  4.4  4.4  4.4
[229]  4.4  4.8  4.8  5.2  5.2  5.2  5.2  5.2  5.6  5.6  5.6  5.6  5.6  5.6  6.4  6.4  6.4  7.6  7.6
[248]  7.6  7.6  7.6  7.6  8.8
</code></pre>

<pre><code class="r"># 
sum(means &gt;= OBS)
</code></pre>

<pre><code>[1] 7
</code></pre>

<pre><code class="r">pvalue &lt;- sum(means &gt;= OBS)/nn
pvalue
</code></pre>

<pre><code>[1] 0.02778
</code></pre>

<pre><code class="r"># 7/252
DF &lt;- data.frame(x = means)
p &lt;- ggplot(data = DF) + geom_density(aes(x = x, y = ..density..), fill = &quot;pink&quot;, alpha = 0.4) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAdVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmAGZmOjpmOpBmZmZmtv9/f3+QOgCQOjqQOmaQ2/+2ZgC2/7a2///bkDrb/7bb/9vb///l5eXv1tv6+vr84+f/tmb/25D/5ur//7b//9v///9Yg4L8AAAACXBIWXMAAAsSAAALEgHS3X78AAALuElEQVR4nO3di3LbRhIF0N5Y2Y1s79pxYkbcNR1LlPj/n7hE82ECmEdPo6eJAe4tV0pKoa56jqdgSKQ9dEBcQvceYC0BtFMA7RRAOwXQTgG0UwDtFEA7BdBOAbRTAO0UQDsF0E5RQf+OCGIBnbvgb1HNTnSVYZfrWIA2qQK0UxWgnaoA7VQFaKcqQDtVAdqpCtBOVYB2qgK0UxWgnaoA7VS1fGii4MihrtGlgJZ30X6/D1EHuvhSp7ECaRu6wwtKj7vOl7qMFcoSoPcC6NCVgJZ2nfUC0sOu4JWAlnYBunQKTvGKrnpj6UEXBS8EtLBLA317JaCFXTd8Q+l+V+RCQMu6bvlWAv23SXaF19OPm1Ciq3fh8ErzsSJZyo4ebOleV+zC9nb05Ck4hSvq8wFaNAVnGnRf+rYreiGgRV2AVkzBAXRhh2IKTtmKhnx96Zuu0YWAFl01Hfp6IaAlXVLo8XWAFl0Vh76VTkJfLgS0pAvQmik4RStK+PW6QtcBWpIE9I00oBMBdGGHYgrOdOif0peu8GXn6wAt6AK0agpOyYqSgD+7IpcBWpAk9FUa0IlYQF+kAZ1IwYqizn3ozGWAznbFBc/SgE7EHDp3FaCzXQnCk+FOchGgs10pQ0bcCa4BdLYrachvl94dCNCxWEF30ru080ka0LmuDOJROucM6Gwk0Pv999wFgJZ0AVo7BQfQhR2KKTjiFeWd89CdNKAzXYBWT8EBdGGHYgoOoAs7FFNwAF3YoZiCA2jOhv7x9ecHb1+IHiMdiik40hUJnAXQR+lZQj+/+3b8df1g+3AU/xzuUEzBAXSX7ePh9ePT9YPjfw+bbkt3P1b4feca+m4S8p1aDP358Pbn0/WD7tbx6XLvwI6ut6PP/yvYoZiCA+gug3v088Ph9cPXcIdiCg6gOfyw8fqfb+fHjw3R5c9CZ2iJswR6T/OElncopuAAurBDMQUH0IUdiik4gC7sUEzBAXRhh2IKDqALOxRTcABd2KGYgiNbkchZBB345/L0YwEa0KMAurBDMQUH0IUdiik4gC7sUEzBAXRhh2IKjmhF9MMO+odotYAGdPkUHEAXdiim4AC6sEMxBQfQhR2KKTiALuxQTMGRrIj2ltCiBzxAA7p8Cg6gCzsUU3AAXdihmIID6MIOxRQcQBd2KKbgCFZEe1toiTSgAV0+BQfQhR2KKTiALuxQTMEBdGGHYgpOfkW0t4YWSAMa0OVTcABd2KGYgnMX6Lz0nKBtTpPKH0rVP/Qqle/iK7NHZ63xrKzV7+jJU3CyK6KrDqCVU3AAXdihmIID6MIOxRSc+0BnpdcHTTc6gNZNwQF0YYdiCg6gCzsUU3AyK6JbHUPonDSgAV0+BQfQhR2KKTiALuxQTMFJr4j6OoBWTcG5F3RGGtCALp+CA+jCDsUUnOSKaKgDaM0UnLtBp6UBDejyKTiALuxQTMFJrYjGOobQSWlAA7p8Cg6gCzsUU3ASK6KQjiF0ShrQgC6fggPowg7FFJz4iiisYwidkAY0oMun4ERXRDEdQ+i4NKABXT4FJ7YiiusYQkelVwNNXtCRta8FenioaTXomPRKoEeHx9aDjlB7QL++f5B8kWrQoTN6a0J3pwILxlItMbOjn+lyRJa8QzEFp7+i2EnIVaFP1pQYS73E/K2jO0To8/BQssOW6LrbK0DHz5uuDb0f7msf6Jdf+fiVj0/jA29qHkqWONbbAbp/s/a5R7Ntl+GhZJ/OO7rKoWRkdO7YhBPLzI8sS0MzLf93cCjZ5oE/Cv5mKX67Odetkzym3mVH72++f6m/o1/f0yndth7u6CPyc61DyVLObtBXaZdbx+mYty6Be3StHZ10Xib0bQaHkm2rHYWadvaDvkg73Do+/nW6efzydEjGFDrj7Ah9ll7qt+CAFncopuDwinLOC4Xevvu2vTkhUtahmIIzO+iTtMtTx4evx18v/3K8R68U+vjA/O6bJ3TW2RWapX1uHcdHuWfPW8daoWWxg847A3rSFJwZQnfSLtDPzt+wrBX69X3u9hzqUEzB2YnOwfKFPko7/1CpoEMxBWfF0IfN40EQQE+/dbjeoyXO3tB7WuBTB6DLOhRTcNYM/faF3v33Q+6NHUbQIudlQr99eXz57fwSlrxDMcXpa4sIvaGFB6ZOfrw7Qmcf8gBts6O3PjuaRDjLhOa3g1HOeeHQ30XSDT11ADobQBu9U8nlO0OS4SwR+nD+Wcc29270hUOL/ji0+Omdz+PdjKEl0pMf7w78noOiDsUU/BC9YujT413277EAuqGnDkALsnhogXQr0CTFAfSkKQAtynRoEuOsG3ryiV1UdpCY5aFksqrs0WWNHEo29x2d39K4ddhULQSa5DiAnjLF/KGz0oA2qgJ0SsewahHQVIAD6AlTtACdkwa0VRWgUzqGVQuApv6KLHUMqwCd0rGsStMA2qwK0Ckdw6rmoWm4IksdwypAp3Qsq5I2gLarAnRKx7CqcWgar8hSx7AK0Ckdy6oUDqANqwCd0jGsahqaQiuy1LGsSugA2rIK0Ckdw6qGoSm8IksdwypAp3Qsq+I8gDatAnRKx7CqWWiKrchSx7AK0Ckdy6qoD6BtqwCd0jGsahSa4iuy1LGsigEB2riqPvTgrKzNzT+UDmhD6PE5LD//Lr4WmlIrstQxrKoOPThZ6HD5Rw+mnJV19xOxNNEeoiWG7p+V1d07Jh940+KOjm3piju6+yjYIZ6iSeiIdLV79ON0aMqsyFLHsKoy9PCsrM30EzoBXZp1QYelZww9dAZ0NirokTOgs1kZdFAa0BWqmoIeOwM6m7VBh6QBXaOqIeiAc0PQAWlAV6kCdFHXCqBDzi1Bj6UBXaeqEeigc1PQI2lAV6pqAjrs3Bb0UBrQtaoagI44NwY9kAZ0tarZQ8ecW4PuSwO6XtXMoaPOzUH3pGcHTUuCpuASRUj1oSfizAn6dk/PDTrh3CQ0jZcoQ6oMnXJuEXo/U+ikc5PQV+lZQaed24S+SM8JOuPcKPRZekbQOedWoU/Ss4FOPD+LV8SZHzQ/e8wFWuDcLnQnPRNoiXPD0EfpeUCLnFuG7n03XhE6d+QYeR8kZn4oWTZEmXPLHHY0WW6dme7oY1dmU1eH7m4bq4DOSNeG5tvzOqDT0tWha6zIqMt8rDtCU50V2XTZj5XgqwtNtVZk0lVhrLhfVWjqT2G5IouuGmNFAWtC03AKyxUZdFUZKyZYEZrWCR0hrAldd0XTu+qM5Q5NoSksVzS5q9JYYcNq0BSewnJFU7tqjRVErAVNa4YOKVaD9ljRxK56YwUYK0FTYgrLFU3qWgA0rRw6IF0FeviCyvqgx9I1oEevXK0ReihZBdpzRRO6qo7lAD1+JXaN0ENpe+jAK96rhB5Im0OH3lmwTui+NKBNqgDtVAVopypAO1UB2qkK0E5VgHaqArRTFaCdqgDtVAVopypAO1UB2qnKEHp0KNn5U0BHu1TQwwNvLp8COt6lgh4c4XT9dHQoGSHXGBxKdv008Js1TvZvO3J2oqsMu1zHmrqjAx2KKTiA7iK+R6um4ACaMzqULPLUoZqCA+jCDsUUHEAXdiim4AC6sEMxBQfQhR2KKTiALuxQTMEBdGGHYgoOoAs7FFNwAF3YoZiCA+jCDsUUHEBnO2xCRj3GXVZVBtBGsfzahl11SABds6p6q//XBjRyCqCdAminANopgHbKHaE3dPPq2NQqqybLqXq5H/TbH2br6b1yPC2GU/VzP+jXf/9KDzZVvfdCTIvhVP3cD/r5l6fuzTkW6b27Z1oMp+rnTtCb07Z5fjRpM9zRXYym6ueOO/rxYLV3DO/RhlP1c9+nDqutY/vUUWND4znaK4B2CqCdAminANopgHYKoJ2yCOjN42Fb5QcUhlkE9OvHvwy/A6+TRUAftnW+m7PMMqBf/lnpp8h2WQb05tPcb9HLgH757X+1XhgxyxKg3758Plj9mLRalgDdRADtFEA7BdBOAbRTAO0UQDsF0E4BtFMA7ZT/Axbc3bTnXywbAAAAAElFTkSuQmCC" title="plot of chunk EXPLAIN" alt="plot of chunk EXPLAIN" style="display: block; margin: auto;" /></p>

<pre><code class="r">x.dens &lt;- density(means)
df.dens &lt;- data.frame(x = x.dens$x, y = x.dens$y)
p + geom_area(data = subset(df.dens, x &gt;= 7.6 &amp; x &lt;= max(DF$x)), aes(x = x, y = y), fill = &quot;blue&quot;, alpha = 0.4) + 
    labs(x = &quot;&quot;, y = &quot;&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAYFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6kNtmADpmAGZmOjpmOpBmZmZmtv9/f3+QOgCQOjqQOmaQ2/+ZivK2ZgC2///bkDrb///l5eXv1tv6+vr84+f/tmb/5ur//7b//9v////YKm/WAAAACXBIWXMAAAsSAAALEgHS3X78AAAK80lEQVR4nO3dC3PTVhAF4C1N0wf0AQEMxOD//y9rrR9Y0n3srvauda1zptNJOpqTvR8aYZrgpQMSErr3AFsJoIMC6KAAOiiADgqggwLooAA6KIAOCqCDAuigADoogA6KCfpvRBAP6NoFX0U1O9FVjl2hYwHapQrQQVWADqoCdFAVoIOqAB1UBeigKkAHVQE6qArQQVWADqoCdFDV40MTJUdOdc0uBbS8i/b7fYo60cWXBo2VSN/QA15Set51vjRkrFQeAXovgE5dCWhp11kvIT3tSl4JaGkXoLVTcNQnuurNpSddlLwQ0MIuC/TtlYAWdt3wTaXHXZkLAS3ruuXbCPRXl+yU19O3m1Cha3Th9Er3sTJ5lDt6ckuPunIX9ndHL56CozzRmA/Qoik4y6DH0rdd2QsBLeoCtGEKDqCVHYYpOLoTTfnG0jddswsBLbpqOfT1QkBLuqTQ8+sALboqD30rXYS+XAhoSRegLVNwVCcq+I26UtcBWpIC9I00oAsBtLLDMAVnOfRP6UtX+rLzdYAWdAHaNAVHc6Ii4M+uzGWAFqQIfZUGdCEe0BdpQBeiOFHWeQxduQzQ1a684Fka0IW4Q9euAnS1q0B4MtxJLgJ0tatkyIg7wTWArnYVDfnHpXcHAnQuXtCD9K7sfJIGdK2rgniUrjkDuhoJ9H7/pXYBoCVdgLZOwQG0ssMwBUd8orpzHXqQBnSlC9DmKTiAVnYYpuAAWtlhmIIDaGWHYQoOoDkv9Mv7nx/8+IfoOdNhmIIjPZHAWQB9lF4l9Ouvn4//XD/49HQUf5fuMEzBAfSQT8+H7398vH5w/PfhZbilh/+t8PcuNPTFJRQ7tRj63eHHfx+vHwyPjreXZwfu6HZ39Pk/JTsMU3AAPWTyjH59Onz//X26wzAFB9AcfrHx/a/P55cfL0SX3wuDoSXOEug9rRNa3mGYggNoZYdhCg6glR2GKTiAVnYYpuAAWtlhmIIDaGWHYQoOoJUdhik4shOJnEXQibfLs48FaEDPAmhlh2EKDqCVHYYpOIBWdhim4ABa2WGYgiM6EX3zg/4mOi2gAa2fggNoZYdhCg6glR2GKTiAVnYYpuAAWtlhmIIjORHtPaFFL/AADWj9FBxAKzsMU3AArewwTMEBtLLDMAUH0MoOwxQcwYlo7wstkQY0oPVTcACt7DBMwQG0ssMwBQfQyg7DFJz6iWjvDS2QBjSg9VNwAK3sMEzBuQt0XXpN0D7bpOpLqcZLr0r5Ir6yujpri7uyNn9HL56CUz0RXXUAbZyCA2hlh2EKDqCVHYYpOPeBrkpvD5pudABtm4IDaGWHYQoOoJUdhik4lRPRrY4jdE0a0IDWT8EBtLLDMAUH0MoOwxSc8olorANo0xSce0FXpAENaP0UHEArOwxTcIonoqkOoC1TcO4GXZYGNKD1U3AArewwTMEpnYjmOo7QRWlAA1o/BQfQyg7DFJzCiSil4whdkgY0oPVTcACt7DBMwcmfiNI6jtAFaUADWj8FJ3siyuk4QuelAQ1o/RSc3Ikor+MInZXeDDRFQWfOvhXo6VLTZtA56Y1Az5bHtoPOUG8BOrWjtyX0sBVYMJbpiKuFzm1Cbgp9sqbCWOYjiqHHS8kOn4ieMh2GKTi3J8rvm24NvZ/e18HQ84U3LZeSFdZ6B0CPH9bB0NOlZG/Pd3STpWTktHdswcYy95VlYujxUrKXJ/4o+Ys1j/KOLq6pD7mj9zd/frnzHX1Efm21lKz4zsVR0Ffp+z+jW93R5XeIfnTo6VKyT81WoVbeiTsM+iL9qK+ja+94Hgd9lgY0oPVTcPhE1bfwB/SSKTirgz5JA7oUQBcynKi+/CMSmqUBXQqgC9lJnAG9aArOCqEHaUCXAuhCdqI9WLHQR2lAlwLoQgCt7DBMwdmJNugFQ+8J0KUAuhBAKzsMU5y+togQ0EumOH1tEWE0tHBhKqAXVz0cNIlwAL1oCv7SK4X+IjIB9PIqQJd0HKseDJpkOIBeNMVhzdCi3w4B7VElUOkGmoQ4gF40BaBFATSgnarqLL1AkxQH0IumALQoy6FJjLNt6MUbu0i3SMxzKZmsqrq6rJOlZGu/o+u3NB4dPlUPAk1yHEAvmWL90FVpQDtVAbqk41j1ENCkwAH0gil6gK5JA9qrCtAlHceqB4Cm8Yk8dRyrAF3S8awq0wDarQrQJR3Hqu6haXoiTx3HKkCXdDyrijaA9qsCdEnHsapzaJqfyFPHsQrQJR3PqhIOoB2rAF3ScazqGppSJ/LU8awq6ADaswrQJR3Hqo6hKX0iTx3HKkCXdDyr8jyAdq0CdEnHsapbaMqdyFPHsQrQJR3PqqwPoH2rAF3ScazqFJryJ/LU8azKAQHauao99GRX1gvRZTsIoAtHvEYKPd/Dctp/k+gQT0GlE3nqOFY1h55sFjp+cPr3kl1Zd9+IZYl1iZYYerwra3h2LF540+MdnbulG97Rw0fJDvEUXUJnpJs9o5+XQ0/f5w7QnMmurJflGzoBrc22oNPSK4aevUMmoJUdsinm70QKaGWHbIp+oZPSgG5Q1RV04j2MAa3sEE3RM3RKGtAtqjqCTr37eT/QCWlAN6kCtKprA9DJvQkdQc+lAd2mqhPo9CKQnqBn0oBuVNUFdGazTVfQU2lAt6rqADq3qqkv6Ik0oJtVrR46u3usM+ixNKDbVa0cOr9MrzfokfTqoOmRoCl5RBFSe+iFOGuCvr2n1wZd2sLZIzTNjyhDagxd3HbaIfR+pdDlrbI9Ql+lVwVd2d7bJfRFek3QtS3JfUKfpVcEXd1G3Sn0SXo10IXXz+ITcdYHza891gItcO4XepBeCbTEuWPoo/Q6oEXOPUOP/jTeELq2coyiF4m5LyWrhqiytyzgjibPW2eld/Sxq3JTN4ceHhubgP5Qlm4NzY/nbUCXpZtD+5/Ircsb+sMdoanBidy63KFL0m2hqcWJ3Lr8oQvSTaHpOoXnidy6GkDnpVtC088pPE/k1tUCOivdEJo2Cf0mQ9gSutGJ3LqaQH94Ew1Nt1N4nsitqw105uHRDJpGU3ieyK2rEXRauhU0bRg6+ZhuBt3uRG5draA/pP7GZyNomkzheSK3rmbQqYdHG2jaOHRCugn09Bsq24OeS7eAnn3naoPQs98Qm0C3PZFbV0vo2S3dAHr+ndgtQk+l/aET3/HeJPRE2h069ZMF24Qev5oGtEsVoIOqAB1UBeigKkAHVQE6qArQQVWADqoCdFAVoIOqAB1UBeigKkAHVTlCz5aSnT8F9LnLCXq68ObyKaAvXU7QkxVO109nS8kIucZhKdn108Qv1jzVv+3I2YmucuwKHWvpHZ3oMEzBAfQQ8TPaNAUH0JzZUrLMqw7TFBxAKzsMU3AArewwTMEBtLLDMAUH0MoOwxQcQCs7DFNwAK3sMEzBAbSywzAFB9DKDsMUHEArOwxTcABd7fAJOfU4d3lVOUA7xfNrO3a1IQF0y6rmrfFfG9DIKYAOCqCDAuigADood4R+oZvvji2t8mrynGqU+0H/+NftPKPvHC+L41Tj3A/6+5+/0ZNP1ehnIZbFcapx7gf9+ubj8MM5Hhn9dM+yOE41zp2gX063zeuzS5vjHT3Eaapx7nhHPx+87h3HZ7TjVOPc91WH163j+6qjxQ2N19FRAXRQAB0UQAcF0EEBdFAAHRRABwXQQQF0UAAdFEAHBdBBAXRQAB0UQAcF0EEBdFAAHRRABwXQQQF0UAAdFEAH5X/khUXVFFKwLQAAAABJRU5ErkJggg==" title="plot of chunk EXPLAIN" alt="plot of chunk EXPLAIN" style="display: block; margin: auto;" /></p>

<pre><code class="r"># Another approach ....
P3 &lt;- t(SRS(DATA, n = 5))
P2 &lt;- t(SRS(DATA, n = 5))
# Note need to reorder the P2 values
P2R &lt;- P2[, 252:1]
apply(P2R, 2, mean)
</code></pre>

<pre><code>  [1] 12.0 10.2 10.8  9.2  9.2  9.0 11.4 12.0 10.4 10.4 10.2 10.2  8.6  8.6  8.4  9.2  9.2  9.0  7.6
 [20]  7.4  7.4 11.4 12.0 10.4 10.4 10.2 10.2  8.6  8.6  8.4  9.2  9.2  9.0  7.6  7.4  7.4 11.4  9.8
 [39]  9.8  9.6 10.4 10.4 10.2  8.8  8.6  8.6  8.6  8.6  8.4  7.0  6.8  6.8  7.6  7.4  7.4  5.8 12.0
 [58] 12.6 11.0 11.0 10.8 10.8  9.2  9.2  9.0  9.8  9.8  9.6  8.2  8.0  8.0 12.0 10.4 10.4 10.2 11.0
 [77] 11.0 10.8  9.4  9.2  9.2  9.2  9.2  9.0  7.6  7.4  7.4  8.2  8.0  8.0  6.4 12.0 10.4 10.4 10.2
 [96] 11.0 11.0 10.8  9.4  9.2  9.2  9.2  9.2  9.0  7.6  7.4  7.4  8.2  8.0  8.0  6.4 10.4 10.4 10.2
[115]  8.8  8.6  8.6  9.4  9.2  9.2  7.6  7.6  7.4  7.4  5.8  6.4 10.0 10.6  9.0  9.0  8.8  8.8  7.2
[134]  7.2  7.0  7.8  7.8  7.6  6.2  6.0  6.0 10.0  8.4  8.4  8.2  9.0  9.0  8.8  7.4  7.2  7.2  7.2
[153]  7.2  7.0  5.6  5.4  5.4  6.2  6.0  6.0  4.4 10.0  8.4  8.4  8.2  9.0  9.0  8.8  7.4  7.2  7.2
[172]  7.2  7.2  7.0  5.6  5.4  5.4  6.2  6.0  6.0  4.4  8.4  8.4  8.2  6.8  6.6  6.6  7.4  7.2  7.2
[191]  5.6  5.6  5.4  5.4  3.8  4.4 10.6  9.0  9.0  8.8  9.6  9.6  9.4  8.0  7.8  7.8  7.8  7.8  7.6
[210]  6.2  6.0  6.0  6.8  6.6  6.6  5.0  9.0  9.0  8.8  7.4  7.2  7.2  8.0  7.8  7.8  6.2  6.2  6.0
[229]  6.0  4.4  5.0  9.0  9.0  8.8  7.4  7.2  7.2  8.0  7.8  7.8  6.2  6.2  6.0  6.0  4.4  5.0  7.4
[248]  7.2  7.2  5.6  6.2  4.4
</code></pre>

<pre><code class="r">apply(P3, 2, mean)
</code></pre>

<pre><code>  [1]  4.4  6.2  5.6  7.2  7.2  7.4  5.0  4.4  6.0  6.0  6.2  6.2  7.8  7.8  8.0  7.2  7.2  7.4  8.8
 [20]  9.0  9.0  5.0  4.4  6.0  6.0  6.2  6.2  7.8  7.8  8.0  7.2  7.2  7.4  8.8  9.0  9.0  5.0  6.6
 [39]  6.6  6.8  6.0  6.0  6.2  7.6  7.8  7.8  7.8  7.8  8.0  9.4  9.6  9.6  8.8  9.0  9.0 10.6  4.4
 [58]  3.8  5.4  5.4  5.6  5.6  7.2  7.2  7.4  6.6  6.6  6.8  8.2  8.4  8.4  4.4  6.0  6.0  6.2  5.4
 [77]  5.4  5.6  7.0  7.2  7.2  7.2  7.2  7.4  8.8  9.0  9.0  8.2  8.4  8.4 10.0  4.4  6.0  6.0  6.2
 [96]  5.4  5.4  5.6  7.0  7.2  7.2  7.2  7.2  7.4  8.8  9.0  9.0  8.2  8.4  8.4 10.0  6.0  6.0  6.2
[115]  7.6  7.8  7.8  7.0  7.2  7.2  8.8  8.8  9.0  9.0 10.6 10.0  6.4  5.8  7.4  7.4  7.6  7.6  9.2
[134]  9.2  9.4  8.6  8.6  8.8 10.2 10.4 10.4  6.4  8.0  8.0  8.2  7.4  7.4  7.6  9.0  9.2  9.2  9.2
[153]  9.2  9.4 10.8 11.0 11.0 10.2 10.4 10.4 12.0  6.4  8.0  8.0  8.2  7.4  7.4  7.6  9.0  9.2  9.2
[172]  9.2  9.2  9.4 10.8 11.0 11.0 10.2 10.4 10.4 12.0  8.0  8.0  8.2  9.6  9.8  9.8  9.0  9.2  9.2
[191] 10.8 10.8 11.0 11.0 12.6 12.0  5.8  7.4  7.4  7.6  6.8  6.8  7.0  8.4  8.6  8.6  8.6  8.6  8.8
[210] 10.2 10.4 10.4  9.6  9.8  9.8 11.4  7.4  7.4  7.6  9.0  9.2  9.2  8.4  8.6  8.6 10.2 10.2 10.4
[229] 10.4 12.0 11.4  7.4  7.4  7.6  9.0  9.2  9.2  8.4  8.6  8.6 10.2 10.2 10.4 10.4 12.0 11.4  9.0
[248]  9.2  9.2 10.8 10.2 12.0
</code></pre>

<pre><code class="r">DiffMeans &lt;- apply(P3, 2, mean) - apply(P2R, 2, mean)
sort(DiffMeans)
</code></pre>

<pre><code>  [1] -8.8 -7.6 -7.6 -7.6 -7.6 -7.6 -7.6 -6.4 -6.4 -6.4 -5.6 -5.6 -5.6 -5.6 -5.6 -5.6 -5.2 -5.2 -5.2
 [20] -5.2 -5.2 -4.8 -4.8 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.4 -4.0 -4.0 -4.0
 [39] -4.0 -4.0 -4.0 -4.0 -4.0 -4.0 -3.6 -3.6 -3.6 -3.2 -3.2 -3.2 -3.2 -2.8 -2.8 -2.8 -2.8 -2.4 -2.4
 [58] -2.4 -2.4 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0 -2.0
 [77] -2.0 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6 -1.6
 [96] -1.2 -1.2 -1.2 -1.2 -1.2 -1.2 -1.2 -1.2 -1.2 -0.8 -0.8 -0.8 -0.8 -0.8 -0.8 -0.8 -0.8 -0.8 -0.8
[115] -0.4 -0.4 -0.4 -0.4 -0.4 -0.4 -0.4 -0.4 -0.4  0.0  0.0  0.0  0.0  0.0  0.0  0.4  0.4  0.4  0.4
[134]  0.4  0.4  0.4  0.4  0.4  0.8  0.8  0.8  0.8  0.8  0.8  0.8  0.8  0.8  0.8  1.2  1.2  1.2  1.2
[153]  1.2  1.2  1.2  1.2  1.2  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6  1.6
[172]  1.6  1.6  1.6  1.6  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0  2.0
[191]  2.0  2.0  2.0  2.4  2.4  2.4  2.4  2.8  2.8  2.8  2.8  3.2  3.2  3.2  3.2  3.6  3.6  3.6  4.0
[210]  4.0  4.0  4.0  4.0  4.0  4.0  4.0  4.0  4.4  4.4  4.4  4.4  4.4  4.4  4.4  4.4  4.4  4.4  4.4
[229]  4.4  4.8  4.8  5.2  5.2  5.2  5.2  5.2  5.6  5.6  5.6  5.6  5.6  5.6  6.4  6.4  6.4  7.6  7.6
[248]  7.6  7.6  7.6  7.6  8.8
</code></pre>

<pre><code class="r">sum(DiffMeans &gt;= 7.6)
</code></pre>

<pre><code>[1] 7
</code></pre>

<pre><code class="r"># Note the following:
obs &lt;- mean(DATA[6:10])
sort(apply(P3, 2, mean))
</code></pre>

<pre><code>  [1]  3.8  4.4  4.4  4.4  4.4  4.4  4.4  5.0  5.0  5.0  5.4  5.4  5.4  5.4  5.4  5.4  5.6  5.6  5.6
 [20]  5.6  5.6  5.8  5.8  6.0  6.0  6.0  6.0  6.0  6.0  6.0  6.0  6.0  6.0  6.0  6.0  6.2  6.2  6.2
 [39]  6.2  6.2  6.2  6.2  6.2  6.2  6.4  6.4  6.4  6.6  6.6  6.6  6.6  6.8  6.8  6.8  6.8  7.0  7.0
 [58]  7.0  7.0  7.2  7.2  7.2  7.2  7.2  7.2  7.2  7.2  7.2  7.2  7.2  7.2  7.2  7.2  7.2  7.2  7.2
 [77]  7.2  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4  7.4
 [96]  7.6  7.6  7.6  7.6  7.6  7.6  7.6  7.6  7.6  7.8  7.8  7.8  7.8  7.8  7.8  7.8  7.8  7.8  7.8
[115]  8.0  8.0  8.0  8.0  8.0  8.0  8.0  8.0  8.0  8.2  8.2  8.2  8.2  8.2  8.2  8.4  8.4  8.4  8.4
[134]  8.4  8.4  8.4  8.4  8.4  8.6  8.6  8.6  8.6  8.6  8.6  8.6  8.6  8.6  8.6  8.8  8.8  8.8  8.8
[153]  8.8  8.8  8.8  8.8  8.8  9.0  9.0  9.0  9.0  9.0  9.0  9.0  9.0  9.0  9.0  9.0  9.0  9.0  9.0
[172]  9.0  9.0  9.0  9.0  9.2  9.2  9.2  9.2  9.2  9.2  9.2  9.2  9.2  9.2  9.2  9.2  9.2  9.2  9.2
[191]  9.2  9.2  9.2  9.4  9.4  9.4  9.4  9.6  9.6  9.6  9.6  9.8  9.8  9.8  9.8 10.0 10.0 10.0 10.2
[210] 10.2 10.2 10.2 10.2 10.2 10.2 10.2 10.2 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4
[229] 10.4 10.6 10.6 10.8 10.8 10.8 10.8 10.8 11.0 11.0 11.0 11.0 11.0 11.0 11.4 11.4 11.4 12.0 12.0
[248] 12.0 12.0 12.0 12.0 12.6
</code></pre>

<pre><code class="r">sum(apply(P3, 2, mean) &gt;= obs)
</code></pre>

<pre><code>[1] 7
</code></pre>

<h1>Two-Sided Tests</h1>

<p>The direction of the alternative hypothesis is derived from the research hypothesis.  In this K11777 study, we enter the study expecting a reduction in worm counts and hoping the data will bear out this expectation.  It is our expectation, hope, or interest that drives the alternative hypothesis and the randomization calculation.  Occasionally, we enter a study without a firm direction in mind for the alternative, in which case we use a two-sided alternative.  Furthermore, even if we hope that the new treatment will be better than the old treatment or better than the control, we might be wrong&mdash;it may be that the new treatment is actually worse than the old treatment or even harmful (worse than the control).  Some statisticians argue that a conservative objective approach is to always consider the two-sided alternative.  For a <strong>two-sided test</strong>, the <em>p</em>-value must take into account extreme values of the test statistic in either direction (no matter which direction we actually observe in our sample data).</p>

<blockquote>
<p>Key Concept:  The direction of the alternative hypothesis does not depend on the sample data, but instead is determined by the research hypothesis before the data are collected.</p>
</blockquote>

<p>We will now make our definition of the <em>p</em>-value more general for a wider variety of significance testing situations.  The <em>p</em>-value is the probability of observing a group difference as extreme as or more extreme than the group difference actually observed in the sample data, assuming that there is nothing creating group differences except the random allocation process.</p>

<p>This definition is consistent with the earlier definition for one-sided alternatives, as we can interpret <em>extreme</em> to mean either greater than or less than, depending on the direction of the alternative hypothesis.  But in the two-sided case, <em>extreme</em> encompasses both directions.  In the K11777 example, we observed a difference of 7.6 between control and treatment group means.  Thus, the two-sided <em>p</em>-value calculation is a count of all instances among the N replications where the randomly allocated mean difference is either as small as or smaller than -7.6 worms (\( \leq -7.6 \)) or as great or greater than 7.6 worms (\( \geq 7.6 \)).  This is often written as \( |diff| \geq 7.6 \).</p>

<h1>Activity: A two-sided hypothesis test</h1>

<ul>
<li>Run the simulation study again to fine the empirical <em>p</em>-value for a two-sided hypothesis test to determine if there is a difference between the treatment and control group means for female mice.</li>
</ul>

<pre><code class="r">ND &lt;- schis[gender == &quot;Female&quot;, ]
ND
</code></pre>

<pre><code>   gender     group worms
1  Female Treatment     1
2  Female Treatment     2
3  Female Treatment     2
4  Female Treatment    10
5  Female Treatment     7
6  Female   Control    16
7  Female   Control    10
8  Female   Control    10
9  Female   Control     7
10 Female   Control    17
</code></pre>

<pre><code class="r">tapply(ND$worms, ND$group, mean)
</code></pre>

<pre><code>  Control Treatment 
     12.0       4.4 
</code></pre>

<pre><code class="r"># OR
ANS1 &lt;- with(data = ND, tapply(worms, group, mean))
ANS1
</code></pre>

<pre><code>  Control Treatment 
     12.0       4.4 
</code></pre>

<pre><code class="r">observed &lt;- ANS1[1] - ANS1[2]
observed
</code></pre>

<pre><code>Control 
    7.6 
</code></pre>

<pre><code class="r">names(observed) &lt;- NULL
observed
</code></pre>

<pre><code>[1] 7.6
</code></pre>

<pre><code class="r">Worms2 &lt;- subset(ND, select = worms, drop = TRUE)
Worms2
</code></pre>

<pre><code> [1]  1  2  2 10  7 16 10 10  7 17
</code></pre>

<pre><code class="r">N &lt;- 10^5 - 1  # number of times fo repeat the process
set.seed(13)
result &lt;- numeric(N)  # space to save the random differences
for (i in 1:N) {
    # sample of size 5, from 1 to 10, without replacement
    index &lt;- sample(10, size = 5, replace = FALSE)
    result[i] &lt;- mean(Worms2[index]) - mean(Worms2[-index])
}
hist(result, col = &quot;blue&quot;, main = &quot;&quot;, freq = FALSE, breaks = &quot;Scott&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk TWOST" alt="plot of chunk TWOST" style="display: block; margin: auto;" /></p>

<pre><code class="r">d.res &lt;- density(result)
plot(d.res, main = &quot;&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
polygon(d.res, col = &quot;pink&quot;)
xsr &lt;- c(7.6, d.res$x[d.res$x &gt;= 7.6])
ysr &lt;- c(0, d.res$y[d.res$x &gt;= 7.6])
xsl &lt;- c(-7.6, d.res$x[d.res$x &lt;= -7.6])
ysl &lt;- c(0, d.res$y[d.res$x &lt;= -7.6])
polygon(xsr, ysr, col = &quot;red&quot;)
polygon(xsl, ysl, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk TWOST" alt="plot of chunk TWOST" style="display: block; margin: auto;" /></p>

<pre><code class="r">pvalue &lt;- (sum(result &gt;= observed) + sum(result &lt;= -observed) + 1)/(N + 1)  # p-value
pvalue  # results will vary
</code></pre>

<pre><code>[1] 0.05536
</code></pre>

<pre><code class="r"># ggplot2 approach now
DF &lt;- data.frame(x = result)
p &lt;- ggplot(data = DF) + geom_density(aes(x = x, y = ..density..), fill = &quot;pink&quot;, alpha = 0.4) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk TWOST" alt="plot of chunk TWOST" style="display: block; margin: auto;" /></p>

<pre><code class="r">x.dens &lt;- density(result)
df.dens &lt;- data.frame(x = x.dens$x, y = x.dens$y)
p + geom_area(data = subset(df.dens, x &gt;= 7.6 &amp; x &lt;= max(DF$x)), aes(x = x, y = y), fill = &quot;blue&quot;, alpha = 0.4) + 
    labs(x = &quot;&quot;, y = &quot;&quot;) + geom_area(data = subset(df.dens, x &lt;= -7.6 &amp; x &gt;= min(DF$x)), aes(x = x, y = y), 
    fill = &quot;blue&quot;, alpha = 0.4) + labs(x = expression(bar(x)[Control] - bar(x)[Treatment]), y = &quot;&quot;, title = &quot;Randomization Distribution&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk TWOST" alt="plot of chunk TWOST" style="display: block; margin: auto;" /></p>

<p>The empirical <em>p</em>-value for a two-sided test is 0.0554.</p>

<ul>
<li>Is the number of simulations resulting in a difference greater than or equal to 7.6 identical to the number of simulations resulting in a difference less than or equal to -7.6?  Explain why these values are likely to be close but not identical.</li>
</ul>

<pre><code class="r">sum(result &gt;= observed)
</code></pre>

<pre><code>[1] 2759
</code></pre>

<pre><code class="r">sum(result &lt;= -observed)
</code></pre>

<pre><code>[1] 2776
</code></pre>

<ul>
<li>Explain why you expect the <em>p</em>-value for the two-sided alternative to be about double that for the one sided alternative.</li>
</ul>

<h1>What Can We Conclude from the Schistosomiasis Study?</h1>

<p>The key question in this study is whether K11777 will reduce the spread of a common and potentially deadly disease.  The result that you calculated from the one-sided randomization hypothesis test should have been close to the exact <em>p</em>-value of 0.0278.  This small <em>p</em>-value allows you to reject the null hypothesis and conclude that the worm counts are lower in the female treatment group than in the female control group.  In every study, it is important to consider how random allocation and random sampling impact the conclusions.</p>

<blockquote>
<p><em>Random allocation</em>: The schistosomiasis stude was an <strong>experiment</strong> because the units (female mice) were randomly allocated to treatment or contol groups.  To the best of our knowledge this experiment controlled for any outside influences and allows us to state that there is a cause and effect relationship between the treatment and response.  Therefore, we can conclude that K11777 did <em>cause</em> a reduction in the average number of schistosome parasites in these female mice.</p>

<p><em>Random sampling</em>: Mice for this study are typically ordered from a facility that breeds and rasies lab mice.  It is possilbe that the mice in this study were biologically related or were exposed to something that caused their response to be different from that of other mice.  Similarly, there are risks in simply assuming that male mice have the same response as females.  Since our sample of 10 female mice was not selected at random from the population of all mice, we should question whether the results from this study hold for all mice.</p>
</blockquote>

<p>More importantly, the results have not shown that this new drug will have the same impact on humans as it does on mice.  In addition, even though we found that K11777 does cause a reduction in worm counts, we did not specifically show that it will reduce the spread of the disease.  Is the disease less deadly if only two worms are in the body instead of 10?  Statistical consultants aren&#39;t typically expected to know the answers to these theoretical, biological, or medical types of questions, but they should ask questions to ensure that the study conclusions match the hypothesis that was tested.  In most cases, drug tests require multiple levels of studies to ensure that the drug is safe and to show that the results are consistent across the entire population of interest. While this study is very promising, much more work is needed before we can conclude that K11777 can reduce the spread of schistosomiasis in humans.</p>

<h1>Permutation Test versus Randomization Tests</h1>

<p>The random allocation of experimental units (e.g. mice) to groups provides the basis for statistical inference in a randomized comparative experiment.  In the schistosomiasis K11777 treatment study, we used a significance test to ascertain whether cause and effect was at work.  In the context of the random allocation study design, we called our significance test a randomization test.  In <strong>observational studies</strong>, subjects are not randomly allocated to groups.  In this context, we apply the same inferential procedures as in the previous experiment, but we commonly call the significance test a <strong>permutation test</strong> rather than a a randomization test.  More importantly, in observational studies, the results of the test cannot typically be used to claim cause and effect; a researcher should exhibit more caution in the interpretation of results.</p>

<blockquote>
<p>Key Concept: Wheras in experiments units are randomly allocated to treatment groups, observational studies do no impose a treatment on a unit.  Because the random allocation process protects against potential biases caused by extraneous variables, experiments are often used to show causation.</p>
</blockquote>

<h1>Age Discrimination Study</h1>

<p>Westvaco is a company that produces paper products.  IN 1991, Robert Martin was working in the engineering department of the company&#39;s envelope division when he was laid off in Round 2 of several rounds of layoffs by the company.  He sued the company, claiming to be a victim of age discrimination.  The ages of the 10 workers involved in Round 2 were: 25, 33, 35, 38, 48, 55, 55, 56, and 64.  The ages of the three people laid off were 55, 55, and 64.</p>

<pre><code class="r">ages &lt;- c(25, 33, 35, 38, 48, 55, 55, 55, 56, 64)
status &lt;- c(rep(&quot;Job&quot;, 6), rep(&quot;LaidOff&quot;, 2), &quot;Job&quot;, &quot;LaidOff&quot;)
west &lt;- data.frame(ages, status)
rm(ages, status)
west
</code></pre>

<pre><code>   ages  status
1    25     Job
2    33     Job
3    35     Job
4    38     Job
5    48     Job
6    55     Job
7    55 LaidOff
8    55 LaidOff
9    56     Job
10   64 LaidOff
</code></pre>

<pre><code class="r">require(ggplot2)
p &lt;- ggplot(data = west, aes(status, ages)) + geom_point(position = &quot;jitter&quot;, aes(color = status), size = 5) + 
    theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAqFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYAv8Q6AAA6ADo6AGY6Ojo6OpA6ZmY6ZrY6kJA6kNtmAABmADpmAGZmOgBmOjpmZgBmZjpmZmZmkNtmtv9/f3+QOgCQOjqQOmaQkGaQ27aQ2/+2ZgC2Zjq225C22/+2/7a2///MzMzbkDrbtmbb25Db/7bb/9vb///l5eX4dm36+vr/tmb/25D/27b//7b//9v///9f+MlrAAAACXBIWXMAAAsSAAALEgHS3X78AAAJ50lEQVR4nO2dC3vixhlGBa1tknW22NtmG2W3CXITql68rlTM//9nndEFY0CXQaMXIZ3z8LAYyXrls+Ph04Bngi1ICC59AlMB0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC3CRfTP46Y3xxlOojvkfOvwvZoQRItCEC0KQbQoBNGikCGJ/u/5fOvwvZqQIYnukEOLdtgX0R2YoOg7y/HTiPYccnd32jSi/Ybc3VWYRrTXkLu7KtOI9hqCaB8gGtGI3oFovyFUHR6gjh6SaK4Mu8NYB6IRvQPRohBEi0IQLQpBtCgE0aIQRItCEC0KQbQoBNGiEESLQhAtCkG0KATRohBEi0IQLQpBtCjkYqLjILjdbqNgtvJxKoiu2pBYy2Fy82xuHk4F0VUb4r/aFh0vt5tPa7uf4edvY+ZSoiPTouMwDrevf1sXT9GiO1DdokPTfSx3LbrrqSC6akOStWj6aF/UVh1Lqg5vUEeXIFoUgmhRCKJFIYgWhSBaFIJoUQiiRSGIFoUgWhSCaFEIokUhiBaFIFoUgmhRCKJFIYgWhSBaFIJoUQiiRSEjE/1i6XCcViFnMS7RLy99mkZ06eDlpVfTiC4cvLz0axrRiEb0DkS3p2JaqnYgujVVE62936Fq45hE91t1VE4deLBDxdZrFr3ntP86unoyzMMdTm++YtH7Vvu/MmwS3bR9SKLd1tvY9ROdV+5oxZ7Is7YPSbTTkd+/8vU/qDSmFu10ZES/Yzyim17sEO2NdtXd6KoOveimK8Ox1tHvrk4G8Q5L7X/E9Yo+WUf3ymQHlY6vDPtlsqL3QLTDvojuAKJLEC0KQbQoBNGiEESLQhAtCkG0KATRohBEi0IQLQpBtCgE0aIQRItCEC0KQbQoBNGiEESLQhAtCkG0KATRohBEi0IQLQpBtCjkYqKjwE6GzozonqgU/frVCmaOf19Uit78ZcE6LArRyXzNOiweqX0xZB0Wf1S36CXrsPiktupgHRZ/UEeXIFoUgmhRCKJFIYgWhSBaFIJoUchkRHuYMgXRLRz4mAQI0c0OvExrhehGB34makM0ohG9A9HeQupBtLeQek7+dE+rwwfnMhDRA606knIwPpmNRfTQ6ujXL0Fwa+5mvz4Ewc1/zINf5uvNQ5g9f87hByN6YFeG6Xer//1WNGRzb2+Z6Pz5MxiOaA/47DqiIJivk+wjRMGe6Pz5Mw6P6JKjn85oNX6jm+eiRc9W6SLMnz/j8IguOe6jb57TxeyXIPjDIjQPTGdtHuTPn3F4RJdMo472wxWJjm+e4yCo6IOmJPofR3Q6s0PRm8eVuaXfn35ZnZTow82eRX9amzaN6N5Fb2NbM9J19C/a4VTcuFLRb5eriPYVckr03gCMZ9GmHr/592PFSNXkRO8PKfoV/fplmd7vfSK67lTcuEbR7wbJc9HlsHT60fXwR1WHEf32Gf+DU+mwSkr/67B0DZGKzlt0TIuuER3ZAen0hwfHYenjPrp60ATRRnRi/EahvdSInAbxqDpKWoqOQ/v3PelP+V/5tAfRJc1VRxS+fi1b9P1zpxa9eQgyTr+HMDnRB3V0av/EteijPyy69dGR/XWIb08XeNMT3duVYV7YbT79frLAm6DomiccOSrvtnZQ+l/3tOgDfI91mB4ouK14+xHRHaDqKJG+w+JyKm5cnejDzd4H/qurO0R34eg9Q1OQxxUV4gRFvy3M5728y28tTsWN6xS9t9Sk5/Lu68rceHO28Lq/eKrnPto4TrJ5OppPxY1rFP1uOWB7Cb53dVH81j+tsgFP+6IWzVZRzaeoqTpK3EQXPK2yaw77SdPqLjcD0SWtRWejSlZqFMw/r/LB0nhpvvix7gO9iC5pKzr9aF/KjGhTn5kqLc4uopMlLbotrVt0bD+Zbj/TFWbvuBQtGtFtaa46ctHx8q1F2wf00Y4019Hpwo64mfvZ5zDvo2cfdlUHotsivTJ0ORU3rlR0zROOILoE0aIQRItCGPgXhfBXWaIQRItCEC0KQbQoBNGikAuKjpkR3R81opNgyTos3qgWnd7/c8k6LP2LtgOuRjTrsHiiUnT2mSXWYfFG3YthQh/tjwbRVB2+oI4uQbQoBNGiEESLQq5GdP2Ul4h22Lf2VBomcUW0w751p9I0LTGiHfatOZXGibYR7bAvojuA6BJEtwfRiKbq2HEloqmjG+DKsORqRNeDaId9Ed0BRJcgWhSCaFEIokUhiBaFIFoUgmhRCKJFIYgWhSBaFDJ40fWDSSWIdtj35Kk0DI+WINph31On0jTgX4Joh31PnErjW1gliHbY98Q6LHuie1wipS0e12HxDi26BNHtQTSiqTp2DFw0dXRLuDIsGbzodiDaYV9EdwDRJWMR3a4r7waiWxcn3UB063K7G4hufQHZDUQjGtE7EN0eRCOaqmPHOERTR3NlWDIW0R2+VxOCaFEIokUhiBaFIFoUgmhRCKJFIYgWhSBaFIJoUQiiRSGIFoUgWhRyMdFREITMiO6NStFJtsg4c/z7oq7rsGtfsw5L/6KjgHVY/FH7YhizDos3qvvopRVNH+2L2qrjlqrDG9TRJYgWhSBaFIJoUQiiRSGIFoUgWhSCaFEIokUhiBaFIFoUgmhRCKJFIYgWhSBaFIJoUQiiRSGIFoUgWhSCaFEIokUhiBaFIFoUgmhRCKJFIaMV3cN0B4g+4aCPCTwQfeyglylpEH3koJ9JlhCN6K7Lg5y7csee6C5LetSHuDEk0R1yaNEO+yK6A1QdJSMVTR1dA1eGHWCsowTRohBEi0IQLQpBtCgE0aIQRItCEC0KGZLoDgRdvlkT0pvjDBfRg89R/TDngGgRiBYx5HMbFYgWgWgRiBaBaBH9i34qZhlLP3o+cHr/vHtcTM5nsl6/BMHcfBHNVtHbBGeXZySid1mbh3C7TeZrY/5tZsQhIBGdTaGX/vBgJ9LzRyE6O7iVGgXzzys7L6KdGdF88WPWsoeCQnRiJyoM0++Ni9DjgXPR5hfl9evKTgxsdD+u4iwhWU6yRdsfPlmmP+XzcHqjaNFxEMysaJvytGvRUxMdhaa5FS3aeOmhRcfLtxZtH0y0j04X+QSnto/+sPDcRy8Cc1xzP/sc5n307MOu6piaaChBtAhEi0C0CESLGJxoe11z+GgMIFrEgEQntgDePJg7WyGH9tHfjWvrOwkGNW5xDsMRba8v4lvrdfO4sv/kt+yJfNNVMyDRj9l4atFhGLd7oh8HNLB8JsMRbS+pZ6tcdGS7ijfRxaarZkCiDcnNs23AD+H7rqPYdOmz68RwRFuTuehM73eros+I5+ti06XPsBPDEZ33F9vXL/N1HAR//HNYPPpTNjBH1QHtQLQIRItAtAhEi0C0CESLQLQIRItAtIj/AyqYIyN0CI3wAAAAAElFTkSuQmCC" title="plot of chunk AGE" alt="plot of chunk AGE" style="display: block; margin: auto;" /></p>

<ul>
<li>Conduct a permutation test to determine whether the observed difference between means is likely to occur just by chance.  Here we are interested in only a one-sided test to determine if the mean age of people who were laid off is higher than the mean age of people who were not laid off.</li>
</ul>

<pre><code class="r">OBS &lt;- with(data = west, tapply(ages, status, mean))
OBS
</code></pre>

<pre><code>    Job LaidOff 
  41.43   58.00 
</code></pre>

<pre><code class="r">obsDiff &lt;- OBS[2] - OBS[1]
names(obsDiff) &lt;- NULL
obsDiff
</code></pre>

<pre><code>[1] 16.57
</code></pre>

<pre><code class="r">Ages &lt;- subset(west, select = ages, drop = TRUE)
Ages
</code></pre>

<pre><code> [1] 25 33 35 38 48 55 55 55 56 64
</code></pre>

<pre><code class="r">set.seed(12)
N &lt;- 10^5 - 1  # number of times fo repeat the process
result &lt;- numeric(N)  # space to save the random differences
for (i in 1:N) {
    # sample of size 3, from 1 to 10, without replacement
    index &lt;- sample(10, size = 3, replace = FALSE)
    result[i] &lt;- mean(Ages[index]) - mean(Ages[-index])
}
hist(result, col = &quot;blue&quot;, main = &quot;&quot;, xlim = c(-25, 25), breaks = &quot;Scott&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAdVBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBltf2POQCPOTmPOWWPtY+P29qP2/21ZgC1/rW1/v3ajzna24/a/rXa/v39tWX924/9/rX9/tr9/v2AWYt8AAAAJ3RSTlP//////////////////////////////////////////////////wCDVpfZAAAACXBIWXMAAAsSAAALEgHS3X78AAAIoElEQVR4nO3di1bbxhqG4Yi4kKZpcVLoARe32MD9X2I9smVkayTNL818Or3vWjvpBoTtJ4M0tkfi0ztJ+jT0HVhKQIsCWhTQooAWBbQooEUBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWhTQooAWBbQooEUBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWhTQooAWBbQooEUBLaodev8lc31+FtybGdcK/fb4kP+9u31JfmfmXCv064/ni7+pW4xoUe376Nc1++gIMesQBbQopneiOBiKYnonaiIj2u28Brz5CE1kepetVrOHHkVh0GMe9l2gs6Lo96b+JsOgRzzs+0zvBoX2/TtPGrrhYDgstAd10tAN0zugDTGiRfWZ3gFtqM/0DmhDQIsKOhi6vYfnGTjQhkKg8wnH/tfKp4A2FAK9//bC9K5v7dDrm7//dCP6G9O7PgUcDN8es7v3HdO7fjHrEAW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWhTQoqa79m5u0KxUihNr70QxokWx9k4Usw5Rc4Me7Wksc5vejfbsrbkdDKcLPbHp3XShGdFxmtv0bsLQ9QFtaLJnzs4PmuldlDgYimJ6J4oRLYrpnSimd6KAFhUIvf/quaQS0IYCzjM8PTup7qSBNhRyMDwQM6L7FrLreF3f/gt0z8L20fsvvsveAW2IWYcooEUBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFHLgh5w9fTCoIcb72OADlhdtgTo9EvCAnasC4AWLKCxQ7t/+blBC5aEdYA+/N+5QY9zRE8V+nV9V/sV6ZeELQj6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" title="plot of chunk AGE2" alt="plot of chunk AGE2" style="display: block; margin: auto;" /></p>

<pre><code class="r">d.res &lt;- density(result)
plot(d.res, main = &quot;&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, xlim = c(-25, 25))
polygon(d.res, col = &quot;pink&quot;)
xs &lt;- c(obsDiff, d.res$x[d.res$x &gt;= obsDiff])
ys &lt;- c(0, d.res$y[d.res$x &gt;= obsDiff])
polygon(xs, ys, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk AGE2" alt="plot of chunk AGE2" style="display: block; margin: auto;" /></p>

<pre><code class="r"># ggplot2 approach now
DF &lt;- data.frame(x = result)
p &lt;- ggplot(data = DF) + geom_density(aes(x = x, y = ..density..), fill = &quot;pink&quot;, alpha = 0.4) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk AGE2" alt="plot of chunk AGE2" style="display: block; margin: auto;" /></p>

<pre><code class="r">x.dens &lt;- density(result)
df.dens &lt;- data.frame(x = x.dens$x, y = x.dens$y)
p + geom_area(data = subset(df.dens, x &gt;= obsDiff &amp; x &lt;= max(DF$x)), aes(x = x, y = y), fill = &quot;blue&quot;, 
    alpha = 0.4) + labs(x = &quot;&quot;, y = &quot;&quot;) + labs(x = expression(bar(x)[Job] - bar(x)[LaidOff]), y = &quot;&quot;, 
    title = &quot;Randomization Distribution&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk AGE2" alt="plot of chunk AGE2" style="display: block; margin: auto;" /></p>

<pre><code class="r">pvalue &lt;- (sum(result &gt;= obsDiff) + 1)/(N + 1)  # p-value
pvalue  # results will vary
</code></pre>

<pre><code>[1] 0.05005
</code></pre>

<p>The <em>p</em>-value is 0.05.</p>

<ul>
<li>Modify the code used in the previous problem to test if the median age of people who were laid off is higher than the median age of people who were not laid off.  Report the <em>p</em>-value and compare your results to those in the previous question.</li>
</ul>

<pre><code class="r">OBSM &lt;- with(data = west, tapply(ages, status, median))
OBSM
</code></pre>

<pre><code>    Job LaidOff 
     38      55 
</code></pre>

<pre><code class="r">obsDiffMedian &lt;- OBSM[2] - OBSM[1]
names(obsDiffMedian) &lt;- NULL
obsDiffMedian
</code></pre>

<pre><code>[1] 17
</code></pre>

<pre><code class="r">Ages &lt;- subset(west, select = ages, drop = TRUE)
Ages
</code></pre>

<pre><code> [1] 25 33 35 38 48 55 55 55 56 64
</code></pre>

<pre><code class="r">N &lt;- 10^5 - 1  # number of times fo repeat the process
MedianDiff &lt;- numeric(N)  # space to save the random differences
set.seed(11)
for (i in 1:N) {
    # sample of size 3, from 1 to 10, without replacement
    index &lt;- sample(10, size = 3, replace = FALSE)
    MedianDiff[i] &lt;- median(Ages[index]) - median(Ages[-index])
}
hist(MedianDiff, col = &quot;blue&quot;, main = &quot;&quot;, breaks = &quot;Scott&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAmVBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZrU5AAA5ADk5AGU5OY85Zo85ZrU5j7U5j9plAABlADllAGVlOQBlOTllZjllZmVlZrVltf2POQCPOTmPOWWPZgCPZo+Pj2WPtY+P29qP2/21ZgC1Zjm1tWW124+1/rW1/tq1/v3ajznaj2Xa/rXa/v39tWX924/9/rX9/tr9/v1LWnGFAAAAM3RSTlP//////////////////////////////////////////////////////////////////wBxnr2OAAAACXBIWXMAAAsSAAALEgHS3X78AAAIDklEQVR4nO2d63baRhhFIydt7OCmOOkNkt5Mm9Y0Rob3f7gyI8nGQmiuOmCx94+QteyjkfeaNfokDTOvNiDh1bFP4FxAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLSIsxRdVEjbjBFdFMc404wUbwynL7oB0QEgWgSiRSBaBKJFIFoEokUgWgSiRSBaBKJFIFoEokUgWgSiRSBaBKJFIFqEW3R5ZV9bvb7b+wmiA3CKXs9n9nP19r79I0QH4BT98PHu2ecOiA6AHi3CPUY/3DBGZ4CqQwSiRVDeieBiKILyTgQ9WgTlnQiqDhGIFkF5J4KLoYiY8o6vVkRAjxZBeSeCqkMEokV4XQzN6LE/RCM6BB/RtuAo3+/9CNEB+Igur+95epeKW/TNxZ+fTY++prxLweNiuJ4Xl5sV5V0aVB0iEC3C6+ndxS0Xw1S8nnWs51NEJ+L59G5xieg0fJ/eLb+ZIDoFn6d3U/Ox3K/vEB0AVYcIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLQLQIRItAtAhEi0C0CESLYNcKEfRoEYgWgWgRiBaBaBGV6Ieby4gsogNoevSqsHNGg0B0ADtDx3peFLOQLKIDaERXs6A7poz2gOgAmjG642uEThAdAFWHiFr0ajs6L0OvhogOoB46PhjH5f5c814QHUAluprW37EkRy+IDqAeOuyiHB3f2ewF0QFwMRSBaBGPVceB5Xz6QHQAzQ3L4Xtv1r3LQi368K03q4TloR46FtNDv8Cyxnloho6DYzQ9Og8nve7dUNMaTlP0YYYX/WYYI0cUvZ4Xb79+OLWHSuMTvZ5Py+v77mcdRyzvxie6WnOts8g75sVwfKKrHr3s6tHHLO/GJ9q+mO1aFZMenYvTLu/OSvRhEB2A886wB0QHsNujl50PPCjvsrArmvJuQHZFdy30mrhrRdrDivGJrsforqf/aT067U8an+g+kso7RDcMXN4huuHZ0BFY4CE6gLpHLy+bf9qk7VqB6Ibdl7Od5V3arhWIbnh8erc53KMTdq1AdMPu07vOLwyl7VqB6IaBd61AdAPlnYiBX86OUnTUcwX3y9meBj1+ZZSiY+LOl7N9DQ50Tq30mET3vZw9fNOI6ACcL2frGruzwYHOqZUeleg+Hg5dJBEdgHN+dF+DA51TKz0m0etPoSsb2AYHOqdWekyiB3sLjugG7gxFcUSL4kZ03KUQ0UE0ojuegrobHOicWmlEt5vqeNiC6IasovdPANENVnTUO3BEB5Gz6kB0D4gWxREtiiNaFEe0KI5oURzRojiiRfGcu1Ygugd6tCiOaFEc0aI4okVxRIviiBbFES2KI1oUR7QojmhRHNGiOKJFcUSL4ogWxREtiiNaFEe0KI5oURzRojiiRXFEi+Ju0f5LZiK6B6dorwUG6+kHiD6MU7TXiuh104g+TKYejWgXeZbMRLSTPFUHop0gWhTPU94h2gkXQ1Gc8k4Up0eL4pR3ojhVhyie56sViHZCeSeKczEUxSnvRHF6tChOeSeKU96J4ogWxb0uhs4NbxDtxEe0e8MbRDvxEe3e8AbRTtyifTa8OUvRYXtX5Nnw5mWKjt0+9OBf28c5Vx2xR0d02HER3UojGtGI9jkuoltpRCMa0T7HRXQrjWhEI9rnuIhupRGNaET7HBfRrTSiEY1on+MiupVGNKIR7XPcUxM93vnRpyV6xLNJT0t0x/zojq9WnC/ZRPf0aAggZX40BJBSdUAAiBaBaBGIFoFoEflFH7muTSO7jUcGEH3M+FEb7wXRGeN9IDpjvA9EZ4z3geiM8T4QnTHeB6IzxvvghkUEokUgWgSiRSBaBKJFIFoEokUgWgSiReQVbebpzexUkMjpNuXkLj4e32xy026yin74cLsp392ayU3Ly5gDrMw8ndh4fLPJTXuQVfTKnONiZqbp2f4RyuLij20sNh7dbHrTHmQfo7e92qxzZTp3BOavjI0nNJvatAe5Ra/nUzsfMkF0bDyh2dSmPcgmelEUl+ZiMo3rWlWcHu1JeWXm+CaMdOWxxui0pj3IKrrybIePyGu3+Stj4wnNpjbtQVbRSzvbZ0Yd3QF3hiIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLeJliC6v7GSzZwtoreezvZkB1WKIM/umdT0vvp8XU+Vp9vFCRL/77n7z8OOkJXr/96o32bP6/wNN0YjihYie/HS7KX+e2O1vX1fTAr79wfboaqZwef2r/bBmy+v7cvKPXUXuYpBZRzG8FNF/zzb/mfmei2qGy/ZjVRjRdqbwtu9e2Sl/lWgzz9J2Z3p0KOXky/v15y+V13q74acx2myLO7l7GivWnxAdSTn597evv5gOfGPHA2twUYlemFUmn4mmR0ezNfbX71Mj+mPTh+seba58tdJHs9UYgugItsZWVT9eVNOvH8doa/jd7a7oJ/eIDuXJ23bsMJXEtkiuq45l8Vh/mGviUx2N6PME0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEi/gf3zUaoncRItQAAAABJRU5ErkJggg==" title="plot of chunk MEDAGE" alt="plot of chunk MEDAGE" style="display: block; margin: auto;" /></p>

<pre><code class="r"># ggplot2 approach now
DF &lt;- data.frame(x = MedianDiff)
p &lt;- ggplot(data = DF) + geom_density(aes(x = x, y = ..density..), fill = &quot;pink&quot;, alpha = 0.4) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk MEDAGE" alt="plot of chunk MEDAGE" style="display: block; margin: auto;" /></p>

<pre><code class="r">x.dens &lt;- density(MedianDiff)
df.dens &lt;- data.frame(x = x.dens$x, y = x.dens$y)
p + geom_area(data = subset(df.dens, x &gt;= obsDiffMedian &amp; x &lt;= max(DF$x)), aes(x = x, y = y), fill = &quot;blue&quot;, 
    alpha = 0.4) + labs(x = &quot;&quot;, y = &quot;&quot;) + labs(x = expression(tilde(x)[Job] - tilde(x)[LaidOff]), y = &quot;&quot;, 
    title = &quot;Randomization Distribution&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk MEDAGE" alt="plot of chunk MEDAGE" style="display: block; margin: auto;" /></p>

<pre><code class="r">####### 
pvalueMED &lt;- (sum(MedianDiff &gt;= obsDiffMedian) + 1)/(N + 1)  # p-value
pvalueMED  # results will vary
</code></pre>

<pre><code>[1] 0.1675
</code></pre>

<p>The <em>p</em>-value is 0.1675.</p>

<p>Since there was no random allocation (i.e., people were not randomly assigned to layoff group), statistical significance does not give us the right to assert that greater age is <em>causing</em> a difference in being laid off.  We &ldquo;imagine&rdquo; an experiment in which workers are randomly allocated to a layoff group and then determine if the observed average difference between the ages of laid-off workers and those not laid off is significantly larger than would be expected to occur by chance is a randomized comparative experiment.</p>

<p>While age could be the cause for the difference &mdash;hence proving the allegation of age discrimination&mdash;there are many other possibilities (i.e., extraneous variables), such as educational levels of the workers, their competence to do the job, and ratings on past performance evaluations.  Rejecting the null hypothesis in a nonrandomized context can be a <em>useful step</em> toward establishing causality; however, it cannot establish causality unless the extraneous variables have been properly accounted for.  </p>

<p>In the actual court case, data from all three rounds of layoffs were statistically analyzed.  The analysis showed some evidence that older people were more likely to be laid off; however, Robert Martin ended up settling out of court.</p>

<h1>Verizon Repair Times</h1>

<p>Verizon is the primary local telephone company (incumbent local exchange carrier ILEC) for a large area of the eastern United States.  AS such, it is responsible for providing repair service for the customers of other telephone companies known as competing local exchange carriers (CLECs) in this region.  Verizon is subject to fines if the repair times (the time it takes to fix a problem) for CLEC customers are substantially worse than those for Verizon customers.  The data set <strong>Verizon.csv</strong> stored in the class <strong>Data</strong> directory contains a random sample of repair times for 1664 ILEC and 23 CLEC customers.  The mean repair time for ILEC customers is 8.4 hours, while that for CLEC customers is 16.5 hours.  Could a difference this large be easily explained by chance?</p>

<p>The permutation distribution (difference of means) is skewed to the left, but that does not matter; both the observed statistic and the permutation resamples are affected by imbalance and skewness in the same way.  This test works fine even with unbalanced sample sizes of 1664 and 23, and even for very skewed data.</p>

<p>Note that the Verizon data has long tails.  The mean is not the best measure of center to use with long tailed distributions.  We may want to use a statistic that is less sensitive to skewed distributions.  There are a number of reasons to do this.  One is to get a better measure of what is important in practice, how inconvenienced customers are by the repairs.  After a while, each additional hour probably does not matter as much, yet a sample mean treats an extra 10 hours on a repair time of 100 hours the same as an extra 10 hours on a repair of 1 hour.  Second, a large recorded repair time might just be a blunder; for example, a repair time of \( 10^6 \) hours must be a mistake.  Third, a more robust statistic could be more sensitive at detecting real differences in the distributions &ndash; the mean is so sensitive to large observations that it pays less attention to moderate observations, whereas a statistic more sensitive to moderate observations could detect differences between populations that show up in the moderate observations.</p>

<h1>Using Means</h1>

<pre><code class="r">Ver &lt;- read.csv(&quot;http://www1.appstate.edu/~arnholta/Data/Verizon.csv&quot;)
head(Ver)
</code></pre>

<pre><code>   Time Group
1 17.50  ILEC
2  2.40  ILEC
3  0.00  ILEC
4  0.65  ILEC
5 22.23  ILEC
6  1.20  ILEC
</code></pre>

<pre><code class="r">ANS &lt;- tapply(Ver$Time, Ver$Group, mean)
observed &lt;- ANS[1] - ANS[2]
observed
</code></pre>

<pre><code> CLEC 
8.098 
</code></pre>

<pre><code class="r">N &lt;- 10^4 - 1  # number of times fo repeat the process
result &lt;- numeric(N)  # space to save the random differences
set.seed(10)
for (i in 1:N) {
    # sample of size 5, from 1 to 10, without replacement
    index &lt;- sample(1687, size = 23, replace = FALSE)
    result[i] &lt;- mean(Ver$Time[index]) - mean(Ver$Time[-index])
}
hist(result, col = &quot;blue&quot;, main = &quot;&quot;, breaks = &quot;Scott&quot;)
abline(v = observed)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAb1BMVEX9/v0AAAAAADkAAGUAAP8AOTkAOY8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBltf2POQCPOTmPOWWPtY+P2/21ZgC1/rW1/v3ajzna24/a/rXa/v39tWX924/9/rX9/tr9/v27t5fhAAAAJXRSTlP///////////////////////////////////////////////8AP89CTwAAAAlwSFlzAAALEgAACxIB0t1+/AAACGdJREFUeJzt3Q132jYYhuE6YUnWdSUd6QYLW/j6/79xSLb5mA3Wi6THNrnvc9aujXHdq4pRsCO+7EjSl74P4LMEtCigRQEtCmhRQIsCWhTQooAWBbQooEUBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWhTQooAWBbQooEUBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWhTQooAWBbSoO4Mu+j6AiwEtCmhRQIsCWhTQooAWBbQoPXThyrbzXDuOrgfoyWQCtCCgRQEt6gw69Qkb6GPn0ImHN9DHgBYFtCigRXnb+jkQ6Hx529oX6HwdoH1AZ+sAPTkd2ql2nnBfaQNa1BCgE355CPSxJvQk3bAG+hjQooAWBbQooEUBLQpoUUCLAloU0KKAzt/xlVGgm61fPM/je/wfdmYL9Hnbt5n/efX0Ef2HAX2lzY/3s59jAvpKjOg0dZ+jN1PO0QnSzjqA1nQNOs3lrDFDi6Z3aUb1iKFVT4afHrplelfUWf8woK90ZUQDbShmege0oZhZB9CGgBYVMr2bbd+KomXSAbShoCfDxf75cP2NJ8OYQqZ325/z1lfvgDbUferYD+fV9/307rnxEaANBTwZLvz0rumcHjr+9Y5RQ18sOXT8qAa6fADQNwW0IaBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWhTQooAWBbQooEXJoOtvMQTang26QdoOHXcpHOhg6EnUsAYa6IjHAm0IaFFAiwJaFNCigBYFtKgSejNtuf25M6AN1SN6VRQPc+NjgTZ0cupw33s1szwWaEM19PrFjWjbej5AG6rP0besXQC0IWYdoiro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" title="plot of chunk VER" alt="plot of chunk VER" style="display: block; margin: auto;" /></p>

<pre><code class="r">pvalue &lt;- (sum(result &gt;= observed) + 1)/(N + 1)  # p-value
pvalue
</code></pre>

<pre><code>[1] 0.0195
</code></pre>

<pre><code class="r">DF &lt;- data.frame(x = result)
p &lt;- ggplot(data = DF) + geom_density(aes(x = x, y = ..density..), fill = &quot;pink&quot;, alpha = 0.4) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk VER" alt="plot of chunk VER" style="display: block; margin: auto;" /></p>

<pre><code class="r">x.dens &lt;- density(result)
df.dens &lt;- data.frame(x = x.dens$x, y = x.dens$y)
p + geom_area(data = subset(df.dens, x &gt;= observed &amp; x &lt;= max(DF$x)), aes(x = x, y = y), fill = &quot;blue&quot;, 
    alpha = 0.4) + labs(x = expression(bar(x)[CLEC] - bar(x)[ILEC]), y = &quot;&quot;, title = &quot;Permutation Distribution&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk VER" alt="plot of chunk VER" style="display: block; margin: auto;" /></p>

<h1>Using Medians</h1>

<pre><code class="r">ANS &lt;- tapply(Ver$Time, Ver$Group, median)
observed &lt;- ANS[1] - ANS[2]
observed
</code></pre>

<pre><code> CLEC 
10.74 
</code></pre>

<pre><code class="r">N &lt;- 10^4 - 1  # number of times fo repeat the process
result &lt;- numeric(N)  # space to save the random differences
set.seed(9)
for (i in 1:N) {
    # sample of size 5, from 1 to 10, without replacement
    index &lt;- sample(1687, size = 23, replace = FALSE)
    result[i] &lt;- median(Ver$Time[index]) - median(Ver$Time[-index])
}
hist(result, col = &quot;blue&quot;, main = &quot;Difference in Medians&quot;, breaks = &quot;Scott&quot;)
abline(v = observed)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAk1BMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5j485j9plAABlADllAGVlOQBlZjllZmVlj49ltbVltf2POQCPOTmPOWWPtY+P27WP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v1moGCZAAAAMXRSTlP///////////////////////////////////////////////////////////////8AH5pOIQAAAAlwSFlzAAALEgAACxIB0t1+/AAACklJREFUeJztnYt66sYVRiPbLaZpTwMn6cU+TaFNrKTm9v5P17lIGGEJNBrNL4HW+r5jLkfSbBab0UYaDd8dQMJ3QwcwFRAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLQLRIgYRvVtmlhd77/HtsJ1nDyv3p+PWzDZO2b9m2cLc5lk2ez9fdvb+aXkJQ4p2Ngxrq9z96Yf968OfjWHru050X82EMZBom1Ob7PHN3PvV+Mj++FPmrOQ+0Y2qv9kEPz58/E+W2XWsPJePxf+UW/tY4uDXNnd3y7/OrdZyUbvuP8uM3pgnTQMf65lPVJYy0wcUbZP4TPS6SHTr5Pxhlj0Xd8zK65NPhBddLGExon+evxiX/7CizzbiRfvP1Oz9uF75RLLXPKTo3Il+++g6tnP3iXfeng+Vhwvjbfa+nfvFj/9Tbu24hH3CiP73cnHIH/87t6sUi7p18+yjj66s5xZLyahEb3zX/bAyqlaHs4e2e90USXz8n3JrxyXsE/bBeva/19lvc7tKsejGvncfO0ObwifruYy+766jlWjX5VprvnOoEV0sYZ+wa+ePvywX20bRtkf2osv13DMd6542DL8zPO86LF70ycNCR/HxX1Q+6LWit/O/2z8nfUKl6zDbcE9U1uuz8vnEwOVdVXSx47L7KJdbHw8LHWc7Q++nVrRpwubtcWd43O950T7PT9YrUzzZax7DF5aTOnrt9RWiPx4eNa6Lz/f6o0aoFW0WeC4+EuWi1vQPZR9tnlyYfUS160jYc/AVXAWiRSBaBKJFIFoE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" title="plot of chunk VER2" alt="plot of chunk VER2" style="display: block; margin: auto;" /></p>

<pre><code class="r">pvalue &lt;- (sum(result &gt;= observed) + 1)/(N + 1)  # p-value
pvalue
</code></pre>

<pre><code>[1] 0.0017
</code></pre>

<pre><code class="r">DF &lt;- data.frame(x = result)
p &lt;- ggplot(data = DF) + geom_density(aes(x = x, y = ..density..), fill = &quot;pink&quot;, alpha = 0.4) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk VER2" alt="plot of chunk VER2" style="display: block; margin: auto;" /></p>

<pre><code class="r">x.dens &lt;- density(result)
df.dens &lt;- data.frame(x = x.dens$x, y = x.dens$y)
p + geom_area(data = subset(df.dens, x &gt;= observed &amp; x &lt;= max(DF$x)), aes(x = x, y = y), fill = &quot;blue&quot;, 
    alpha = 0.4) + labs(x = &quot;&quot;, y = &quot;&quot;) + geom_vline(xintercept = observed, lty = &quot;dashed&quot;) + labs(x = expression(tilde(x)[CLEC] - 
    tilde(x)[ILEC]), y = &quot;&quot;, title = &quot;Permutation Distribution&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk VER2" alt="plot of chunk VER2" style="display: block; margin: auto;" /></p>

<h1>Using 25% Trimmed Means</h1>

<pre><code class="r">ANS &lt;- tapply(Ver$Time, Ver$Group, mean, trim = 0.25)
observed &lt;- ANS[1] - ANS[2]
observed
</code></pre>

<pre><code> CLEC 
10.34 
</code></pre>

<pre><code class="r">N &lt;- 10^4 - 1  # number of times fo repeat the process
result &lt;- numeric(N)  # space to save the random differences
set.seed(8)
for (i in 1:N) {
    # sample of size 5, from 1 to 10, without replacement
    index &lt;- sample(1687, size = 23, replace = FALSE)
    result[i] &lt;- mean(Ver$Time[index], trim = 0.25) - mean(Ver$Time[-index], trim = 0.25)
}
hist(result, col = &quot;blue&quot;, main = &quot;Difference in Trimmed Means&quot;, breaks = &quot;Scott&quot;)
abline(v = observed, lty = &quot;dashed&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAmVBMVEX9/v0AAAAAADkAAGUAAP8AOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j485j9plAABlADllAGVlOQBlZjllZmVlj49ltbVltf2POQCPOTmPOWWPtY+P27WP29qP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v2SJOyhAAAAM3RSTlP//////////////////////////////////////////////////////////////////wBxnr2OAAAACXBIWXMAAAsSAAALEgHS3X78AAAKCElEQVR4nO2diZrbthVGQ407nalbJ5GcpK0VJ5HadNR0tL3/w5UAF4mLJIIEfm7nfJ+thRQInAEvr0CI/OYMEr7puwJzAdEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtAtEiEC0C0SIQLQLRIhAtIqTo4yoyfDHPnt7Oh9dosbH/tSwtLuOa09oWH73UL75T0PN79vll/LiLouSNoAhE29bEbI1y+58fiqJdqpWJXvw1fmaKGb1o08n20dNb/Ow/Rsuffoxsq3ZJR4+b+pPp4PnLp39FkfmMabztoOmSrLTLGgmHV2vKlPJrvHgf/XkdL92Zz1w/v5RjCv7nRfRPcVHH1bemlHyVffwY1+myqXgnjJruLbcJL9p04pLobdrRbZ8svTQ9NHkSf3h7tUckoot9OBVtSvnDis4oPj+XtpCL/uXV/EX+YUrJVkl2w+f3fFPZGx1lCETvrOi3S+hI9VhvL+fCy2Xc7uf3w2uyer4kKy1fI91CJvolWWx2nrj/xZtbbK6f5+XYgncX0b+ulufd079fzSZvbcou6U4fotPOttjETd2cSy9NBN2nnThfkpWWr5FuIQsdm0z0S75a8Xlazj75k+SiN9vn/62f//tqNplvynThq03ZHj2i0NFItA2ZptVJcKgRna6RbqFWtNntM9HZ81uid0+/r5aHa9EmIieis03Zd1qmShdkB8Ny6DAkiq5epm1L9/BlYa/tIDovpxw64iV/Txbnq8SbtasVN9U9WdKkd0XR6YEnkXC+fpm2rXQwTBrbQfTVFooHw01cRRO5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" title="plot of chunk TM1" alt="plot of chunk TM1" style="display: block; margin: auto;" /></p>

<pre><code class="r">pvalue1 &lt;- (sum(result &gt;= observed) + 1)/(N + 1)  # p-value
pvalue1
</code></pre>

<pre><code>[1] 5e-04
</code></pre>

<pre><code class="r">DF &lt;- data.frame(x = result)
p &lt;- ggplot(data = DF) + geom_density(aes(x = x, y = ..density..), fill = &quot;pink&quot;, alpha = 0.4) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk TM1" alt="plot of chunk TM1" style="display: block; margin: auto;" /></p>

<pre><code class="r">x.dens &lt;- density(result)
df.dens &lt;- data.frame(x = x.dens$x, y = x.dens$y)
p + geom_area(data = subset(df.dens, x &gt;= observed &amp; x &lt;= max(DF$x)), aes(x = x, y = y), fill = &quot;blue&quot;, 
    alpha = 0.4) + labs(x = expression(bar(x)[T.25.CLEC] - bar(x)[T.25.ILEC]), y = &quot;&quot;, title = &quot;Permutation Distribution&quot;) + 
    geom_vline(xintercept = observed, color = &quot;red&quot;, lty = &quot;dashed&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk TM1" alt="plot of chunk TM1" style="display: block; margin: auto;" /></p>

<p>It seems that the more robust statistics (median, 25% trimmed mean) are more sensitive to a possible difference between the populations; the tests are significant with estimated <em>p</em>-values of 0.0017 and 5 &times; 10<sup>-4</sup>, respectively.</p>

<h1>Cocaine Addiction</h1>

<p>Two different methods to read in the data are illustrated next.</p>

<pre><code class="r">Outcome &lt;- c(rep(&quot;relapse&quot;, 10), rep(&quot;no relapse&quot;, 14), rep(&quot;relapse&quot;, 18), rep(&quot;no relapse&quot;, 6))
Drug &lt;- c(rep(&quot;Desipramine&quot;, 24), rep(&quot;Lithium&quot;, 24))
Cocaine &lt;- data.frame(Outcome, Drug)
head(Cocaine)
</code></pre>

<pre><code>  Outcome        Drug
1 relapse Desipramine
2 relapse Desipramine
3 relapse Desipramine
4 relapse Desipramine
5 relapse Desipramine
6 relapse Desipramine
</code></pre>

<pre><code class="r">ANS &lt;- with(data = Cocaine, tapply(Outcome == &quot;relapse&quot;, Drug, mean))
ANS
</code></pre>

<pre><code>Desipramine     Lithium 
     0.4167      0.7500 
</code></pre>

<pre><code class="r">obsDiffProp &lt;- ANS[1] - ANS[2]
names(obsDiffProp) &lt;- NULL
obsDiffProp
</code></pre>

<pre><code>[1] -0.3333
</code></pre>

<pre><code class="r">Outcome2 &lt;- c(rep(1, 10), rep(0, 14), rep(1, 18), rep(0, 6))
Drug2 &lt;- c(rep(&quot;Desipramine&quot;, 24), rep(&quot;Lithium&quot;, 24))
Cocaine2 &lt;- data.frame(Outcome2, Drug2)
head(Cocaine2)
</code></pre>

<pre><code>  Outcome2       Drug2
1        1 Desipramine
2        1 Desipramine
3        1 Desipramine
4        1 Desipramine
5        1 Desipramine
6        1 Desipramine
</code></pre>

<pre><code class="r">ANS2 &lt;- with(data = Cocaine2, tapply(Outcome2, Drug2, mean))
ANS2
</code></pre>

<pre><code>Desipramine     Lithium 
     0.4167      0.7500 
</code></pre>

<pre><code class="r">obsDiffProp2 &lt;- ANS2[1] - ANS2[2]
names(obsDiffProp2) &lt;- NULL
obsDiffProp2
</code></pre>

<pre><code>[1] -0.3333
</code></pre>

<p>Regardless of the method used to read in the data, the observed difference in proportion of addicts who relapse using Desipramine and Lithium is -0.3333. </p>

<h1>Repeating the Experiment</h1>

<p>The following code can be used when reading the data into a data frame using the second approach.</p>

<pre><code class="r">N &lt;- 10^4 - 1
DiffProp &lt;- numeric(N)
set.seed(4)
for (i in 1:N) {
    # sample of size 24 # from the total 48 addicts
    index &lt;- sample(48, size = 24, replace = FALSE)
    DiffProp[i] &lt;- mean(Cocaine2$Outcome2[index]) - mean(Cocaine2$Outcome2[-index])
}
hist(DiffProp, col = &quot;blue&quot;, breaks = &quot;Scott&quot;, xlab = &quot;&quot;, main = &quot;&quot;)
abline(v = obsDiffProp2, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk coke1rep" alt="plot of chunk coke1rep" style="display: block; margin: auto;" /></p>

<pre><code class="r">pvalue1 &lt;- (sum(DiffProp &lt;= obsDiffProp2) + 1)/(N + 1)
pvalue1
</code></pre>

<pre><code>[1] 0.0184
</code></pre>

<pre><code class="r"># ggplot2 approach
DF &lt;- data.frame(x = DiffProp)
p &lt;- ggplot(data = DF) + geom_density(aes(x = x, y = ..density..), fill = &quot;pink&quot;, alpha = 0.4) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAe1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmAGZmOjpmOpBmZmZmtv9/f3+QOgCQOjqQOmaQkLaQ2/+2ZgC2/7a2///bkDrbtmbb/7bb/9vb///l5eXv1tv6+vr84+f/tmb/25D/5ur//7b//9v///+4UOMdAAAACXBIWXMAAAsSAAALEgHS3X78AAALPElEQVR4nO3dcX/bthEGYKRxtzjNVidtrUbbYseybH7/TziKosgDgQNPBHAEqPf95Y8EJo7AE5ihKAU2DaISs/YAbiWAVgqglQJopQBaKYBWCqCVAmilAFopgFYKoJUCaKUAWiky6K/I9VkEPfzuSXT8T9FRwmKrVIsvBmilYoBWKgZopWKAVioGaKVigFYqBmilYoBWKgZopWKAVioGaKVigFYqtl1o4RNfQEdWM4BmA2i+E6ClxQAtOgrQbMyzbC6AjqwGaD6A5jsBWlpMDL0z5sOj0wnQ0mJS6Pc/Hsc/APr6YlLot3/9au66I9p8fSo/LfTaQ7AihT788r3ZPzh/O1jR0mLX/GN4uHc6FQttjpVCn5BrWtHVQp/uOi4LGtALim31PhrQgQCa7wRoaTFAi44CNBdABwJovlPJ0EfRZAAdVw3QgQCa7wRoaTFAi84JaC6ADgTQfCdAS4sBWnROQHMBdCCA5jsBWloM0KJzApoLoAMBNN8J0NJiy6B/XvL0M2FSFjMvzy8mXbn4oWFFi86JSwcTcwQ0H0DznQAtLQZo0TkBzQTQoQCa7wRoaTFAi84JaCYctPs/xAEdVQ3QoQCa71Q0tEca0PJigF50fpqls/FdIgAdSH5o4zYBWl7Ns6sPC+20AVpeDdCC89MsnI3netCCApoPoPlOgJYWA3TOoZEAOufQSG4K+tRcAfS+0P06tgZ9KHVjlI1Bv376Twdd3i5h5tnZEKxtOsXXvNbeYeLt2L58PxS7or1Lt9IVvT+t5DJ3CdsWdEN2YwO0dGgkm4aetlcC7esEaGmx+qF9eoAOBtB8J0BLi90c9LQN0NJqPj1ABwNovhOgpcUAnXFoNIDOODQaQGccGg2gMw6NBtAZh0YD6IxDowF0xqHR3BJ0dySgAR3qBGhpMUBnHBoNoDMOjQbQGYdGU//mVealjXHbnp3m7shlW1ph86qNr+grBwDojUJ3TYBms2g2Pj1AhwNovhOgpcUAnW9oVgCdb2hWNgJt8wE6HB3oSSOghdUALTs/DaD5ToCWFgN0vqFZAXS+oVkBdL6hWQF0vqFZ2Ta0pxnQgA51ArS0GKDzDc0KoPMNzcoNQfdHAhrQXXbGPLidAC0tJoU+3J12+3E6AVpa7IpLxxm6tM2rfPtU9W2TZuNp04scelfmdmwbXNHjDoOAFg3NShD67fPd5benDZUAfd3QrMys6IMxHx6737V3HYM6oEVDszJ/6Xj/Rm7spp0ALS02A/3662lFjzd2006AlhabuUZ//BHutDq0V68+6G4lT9czoGVDsxOAfvtsznGWNaAlQ7MjWNGhToCWFqv96d0WoN++/H2+ePyCazRW9EXPJQU0m7WgPT9rK8XQ7ISh9x9/7J3XhbVD29In6OmH09MMzU74ruO3x/bX6z8ruEZTq3NbVdBfvrdrGtAKlw7z4fFQ0KWju5puEXq20xagjfMfiJYMrS/GpjLoE8kWoQ+FvWDZKvTbZ+fyPOmkC30myQA9K31jD5Vc6AGvbuhmd9/4Amgmyy8dZV2jNws93wnQVpJDJ9w9i2S2mGE2/pps/nVufJ5uCWY8h/qrLhjabMLQ79/Mx//+9sj/7aiv6HbtbXBFv3+7f/3041DMe4ZR0N5DC4Fub+9a6HLeBb8emjSXDH1e0fuKV7QX2mL9aRz7JUPri/Ffmr1Gez5tAGguG7q9A/TC89PMFetJNgc9fFKplFeGW4Vu+mcd+7tmku1Bz0nf1occtwvd3t413WcO2E6AthJ3e+dcOQDNBXcdDaBJRNBHA+gl56cBNN8J0FZuAdohBTQbQPOdAG0F0NyhgPYF0BHnp1kF2rhNC4bWZxvQF5JtQ5+eegwPlwDNJAH04a5pdpfPlgKaSaJLx/4Evd7mVeFtqsZ20kaP9h3KVM2RK6APK+9AI13RfVu1K3o3PpcuBprgRULPSGv+Y0g+/A9oJgmgd6dr87q7hN0GNNMJ0FYA3QCaRAbtPuIHtOD8NFmhvYf6q14/tEsADWgaNWhfCUAPAXTM+WlyQA/NgB4DaL4ToK0AGtA0gOY7KUKbgNJyaPMC6EkAHXV+GkDznQBt5Sagp6SAZrMqdFga0IAWnp8G0HwnQFsBdK3QCTd1IgkWG7epIjtNkcaxuW989rbyFYL7V+XevGr2b0dvRY8r8sX7hus2V/SVAwB05dAWHqCVoS+NgGYDaL7ThqCD0oAGtPD8NDmh/f9uAtoNoOPOT6MHTS4ogJ4E0HHnpwE036l86L4Z0CSA5jvlg56OBNBx56exoSdDAXTc+WloMedH3wE67vw0kdAT0lho61tqs9DGmTiB9j+/CEJPjhRAG6vhdqCJVEJocwQ0oBtAL5kooHlo0rJpaGvm2tCTAWhCk63+s0MbZ+bLobtmCbR7vlWgD+SnhBQC7derHPr9r/c/O2iVXcIMt5mXtaWX1XZpnjaem72HTpud86XcOkx+6eih7b+ddVa0/9XeZO1WuqIBHTlRQHuhzaQF0BuE9nbKCu2ZeSroscJNQxt25oBeen4aQPOdioMe2wDNJh+0c+T4BATQ1sypFKCXnJ8G0HynjUKbaROgBdBtM6CtONDj1FWgPacD9LTRJQU0m0sxE5h5T+O9N04G7Q4A0IAWnp/GhfZMHdDLzk+TAJq0PXtbAd3kgz56jhwqAHoJ9NEP7cvlVjAMfWm6ZWifMw2g2fDQFiqgl5yfpi9m3KnrQnsGAOjF0JebvrKhE27qRNIXM+4uU9bOU/0X3DY7zzNf91TwnM2kmmfhK9r3VOOFrMe0K9pztg1fOswxPPVk0GasBmgees55Fvoogu6bbhfa+2rvOmhaDdAs9GwAzaYQaN8AbgTabtKFPrcNL1qn/0VdPNHSoT2Pj1aFPgI6BbTvqSCFNsdjULps6OHbsSs2vZsoDjokXTS0sV8VrA7tG4D1zVYpNFkklUAHpGuGdl9sK0N3g7OGViU0XSQM9LQlJ7TvGcoF2tCGqydaCLS7bMhEwzRclkF7Xto70Lx0udCGn42YhslCaDfbgj4Nvmxoz1vGV0x0ZWh78IVC90PzPKWWTxTQtwfdDv5J5LwStOfZ6RUTXRnaHrwpFbpbA76Hp+KJNiVBH810NhE0x7TQ5sn3AEQ+0UYZ2n6a67wSMfNvBEppjkmhPe9QkpmYLtZEg2bnTiK4RdBnRmLtDD4lTeJqbrHh42P9k6ZuXimgd+bDYwQ0Wa3G8/ZUeprc0P2bBGStt/NKAH34+KP9JYUm300dtH1ROH81M0126KMzi+D7XFLo/X2/H5u7eZVB/Fm0edX+gWxBo7FRd1nV9N4FH1a03QnQ0mJ5rtHy89MA+pTIuw5JAM13ArS0GKCVigFaqRiglYoBWqkYoJWKAVqpGKCVigFaqdgy6CHma8IkLVbc0JZALz9er1jJQ1tQsODZFDy0BQULnk3BQ8tREPEH0EoBtFIArRRAK+UK6OG9rb0xd7HnHYrtjHlIV2t89y1BseiB0cihh3drD63yLnIMtBj5cX6Rtej7yQUMzIocevj8wf73+BVNP8wQO59xYPfxNikHZuUK6MsnanZ33R+iQj6eszP3iWpZn/kpYGBWhNA7czcunBb5EDMGWuyUfdyEsq3o2IFZWXiNjl3RY7H76PlkukbHD8zKtXcdb//+cbrriB7BUGwXf8EntRLddSQaGA3uo5UCaKUAWimAVgqglQJopQBaKVVD7+6bfcp73ZypGvrty98pn/tkTdXQ7WvUlM99sqZu6Nd/RL/k1krd0Lvfa7lE1w39+ul/f9SypGuGfv/20EQ/F9VKzdBVBdBKAbRSAK0UQCsF0EoBtFIArRRAKwXQSvk/ayLKBN79zicAAAAASUVORK5CYII=" title="plot of chunk coke1rep" alt="plot of chunk coke1rep" style="display: block; margin: auto;" /></p>

<pre><code class="r">x.dens &lt;- density(DiffProp)
df.dens &lt;- data.frame(x = x.dens$x, y = x.dens$y)
p + geom_area(data = subset(df.dens, x &lt;= obsDiffProp &amp; x &gt;= min(DF$x)), aes(x = x, y = y), fill = &quot;blue&quot;, 
    alpha = 0.4) + labs(x = expression(hat(p)[Desipramine] - hat(p)[Lithium]), y = &quot;&quot;, title = &quot;Randomization Distribution&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk coke1rep" alt="plot of chunk coke1rep" style="display: block; margin: auto;" /></p>

<p>The following code can be used when reading the data into a data frame using the first approach.</p>

<pre><code class="r">N &lt;- 10^4 - 1
DiffProp &lt;- numeric(N)
set.seed(4)
for (i in 1:N) {
    # sample of size 24 # from the total 48 addicts
    index &lt;- sample(48, size = 24, replace = FALSE)
    DiffProp[i] &lt;- mean(Cocaine$Outcome[index] == &quot;relapse&quot;) - mean(Cocaine$Outcome[-index] == &quot;relapse&quot;)
}
hist(DiffProp, col = &quot;blue&quot;, breaks = &quot;Scott&quot;, xlab = &quot;&quot;, main = &quot;&quot;)
abline(v = obsDiffProp, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk coke2rep" alt="plot of chunk coke2rep" style="display: block; margin: auto;" /></p>

<pre><code class="r">pvalue &lt;- (sum(DiffProp &lt;= obsDiffProp) + 1)/(N + 1)
pvalue
</code></pre>

<pre><code>[1] 0.0184
</code></pre>

<pre><code class="r"># ggplot2 approach
DF &lt;- data.frame(x = DiffProp)
p &lt;- ggplot(data = DF) + geom_density(aes(x = x, y = ..density..), fill = &quot;pink&quot;, alpha = 0.4) + theme_bw()
p
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAe1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmAGZmOjpmOpBmZmZmtv9/f3+QOgCQOjqQOmaQkLaQ2/+2ZgC2/7a2///bkDrbtmbb/7bb/9vb///l5eXv1tv6+vr84+f/tmb/25D/5ur//7b//9v///+4UOMdAAAACXBIWXMAAAsSAAALEgHS3X78AAALPElEQVR4nO3dcX/bthEGYKRxtzjNVidtrUbbYseybH7/TziKosgDgQNPBHAEqPf95Y8EJo7AE5ihKAU2DaISs/YAbiWAVgqglQJopQBaKYBWCqCVAmilAFopgFYKoJUCaKUAWiky6K/I9VkEPfzuSXT8T9FRwmKrVIsvBmilYoBWKgZopWKAVioGaKVigFYqBmilYoBWKgZopWKAVioGaKVigFYqtl1o4RNfQEdWM4BmA2i+E6ClxQAtOgrQbMyzbC6AjqwGaD6A5jsBWlpMDL0z5sOj0wnQ0mJS6Pc/Hsc/APr6YlLot3/9au66I9p8fSo/LfTaQ7AihT788r3ZPzh/O1jR0mLX/GN4uHc6FQttjpVCn5BrWtHVQp/uOi4LGtALim31PhrQgQCa7wRoaTFAi44CNBdABwJovlPJ0EfRZAAdVw3QgQCa7wRoaTFAi84JaC6ADgTQfCdAS4sBWnROQHMBdCCA5jsBWloM0KJzApoLoAMBNN8J0NJiy6B/XvL0M2FSFjMvzy8mXbn4oWFFi86JSwcTcwQ0H0DznQAtLQZo0TkBzQTQoQCa7wRoaTFAi84JaCYctPs/xAEdVQ3QoQCa71Q0tEca0PJigF50fpqls/FdIgAdSH5o4zYBWl7Ns6sPC+20AVpeDdCC89MsnI3netCCApoPoPlOgJYWA3TOoZEAOufQSG4K+tRcAfS+0P06tgZ9KHVjlI1Bv376Twdd3i5h5tnZEKxtOsXXvNbeYeLt2L58PxS7or1Lt9IVvT+t5DJ3CdsWdEN2YwO0dGgkm4aetlcC7esEaGmx+qF9eoAOBtB8J0BLi90c9LQN0NJqPj1ABwNovhOgpcUAnXFoNIDOODQaQGccGg2gMw6NBtAZh0YD6IxDowF0xqHR3BJ0dySgAR3qBGhpMUBnHBoNoDMOjQbQGYdGU//mVealjXHbnp3m7shlW1ph86qNr+grBwDojUJ3TYBms2g2Pj1AhwNovhOgpcUAnW9oVgCdb2hWNgJt8wE6HB3oSSOghdUALTs/DaD5ToCWFgN0vqFZAXS+oVkBdL6hWQF0vqFZ2Ta0pxnQgA51ArS0GKDzDc0KoPMNzcoNQfdHAhrQXXbGPLidAC0tJoU+3J12+3E6AVpa7IpLxxm6tM2rfPtU9W2TZuNp04scelfmdmwbXNHjDoOAFg3NShD67fPd5benDZUAfd3QrMys6IMxHx6737V3HYM6oEVDszJ/6Xj/Rm7spp0ALS02A/3662lFjzd2006AlhabuUZ//BHutDq0V68+6G4lT9czoGVDsxOAfvtsznGWNaAlQ7MjWNGhToCWFqv96d0WoN++/H2+ePyCazRW9EXPJQU0m7WgPT9rK8XQ7ISh9x9/7J3XhbVD29In6OmH09MMzU74ruO3x/bX6z8ruEZTq3NbVdBfvrdrGtAKlw7z4fFQ0KWju5puEXq20xagjfMfiJYMrS/GpjLoE8kWoQ+FvWDZKvTbZ+fyPOmkC30myQA9K31jD5Vc6AGvbuhmd9/4Amgmyy8dZV2jNws93wnQVpJDJ9w9i2S2mGE2/pps/nVufJ5uCWY8h/qrLhjabMLQ79/Mx//+9sj/7aiv6HbtbXBFv3+7f/3041DMe4ZR0N5DC4Fub+9a6HLeBb8emjSXDH1e0fuKV7QX2mL9aRz7JUPri/Ffmr1Gez5tAGguG7q9A/TC89PMFetJNgc9fFKplFeGW4Vu+mcd+7tmku1Bz0nf1occtwvd3t413WcO2E6AthJ3e+dcOQDNBXcdDaBJRNBHA+gl56cBNN8J0FZuAdohBTQbQPOdAG0F0NyhgPYF0BHnp1kF2rhNC4bWZxvQF5JtQ5+eegwPlwDNJAH04a5pdpfPlgKaSaJLx/4Evd7mVeFtqsZ20kaP9h3KVM2RK6APK+9AI13RfVu1K3o3PpcuBprgRULPSGv+Y0g+/A9oJgmgd6dr87q7hN0GNNMJ0FYA3QCaRAbtPuIHtOD8NFmhvYf6q14/tEsADWgaNWhfCUAPAXTM+WlyQA/NgB4DaL4ToK0AGtA0gOY7KUKbgNJyaPMC6EkAHXV+GkDznQBt5Sagp6SAZrMqdFga0IAWnp8G0HwnQFsBdK3QCTd1IgkWG7epIjtNkcaxuW989rbyFYL7V+XevGr2b0dvRY8r8sX7hus2V/SVAwB05dAWHqCVoS+NgGYDaL7ThqCD0oAGtPD8NDmh/f9uAtoNoOPOT6MHTS4ogJ4E0HHnpwE036l86L4Z0CSA5jvlg56OBNBx56exoSdDAXTc+WloMedH3wE67vw0kdAT0lho61tqs9DGmTiB9j+/CEJPjhRAG6vhdqCJVEJocwQ0oBtAL5kooHlo0rJpaGvm2tCTAWhCk63+s0MbZ+bLobtmCbR7vlWgD+SnhBQC7derHPr9r/c/O2iVXcIMt5mXtaWX1XZpnjaem72HTpud86XcOkx+6eih7b+ddVa0/9XeZO1WuqIBHTlRQHuhzaQF0BuE9nbKCu2ZeSroscJNQxt25oBeen4aQPOdioMe2wDNJh+0c+T4BATQ1sypFKCXnJ8G0HynjUKbaROgBdBtM6CtONDj1FWgPacD9LTRJQU0m0sxE5h5T+O9N04G7Q4A0IAWnp/GhfZMHdDLzk+TAJq0PXtbAd3kgz56jhwqAHoJ9NEP7cvlVjAMfWm6ZWifMw2g2fDQFiqgl5yfpi9m3KnrQnsGAOjF0JebvrKhE27qRNIXM+4uU9bOU/0X3DY7zzNf91TwnM2kmmfhK9r3VOOFrMe0K9pztg1fOswxPPVk0GasBmgees55Fvoogu6bbhfa+2rvOmhaDdAs9GwAzaYQaN8AbgTabtKFPrcNL1qn/0VdPNHSoT2Pj1aFPgI6BbTvqSCFNsdjULps6OHbsSs2vZsoDjokXTS0sV8VrA7tG4D1zVYpNFkklUAHpGuGdl9sK0N3g7OGViU0XSQM9LQlJ7TvGcoF2tCGqydaCLS7bMhEwzRclkF7Xto70Lx0udCGn42YhslCaDfbgj4Nvmxoz1vGV0x0ZWh78IVC90PzPKWWTxTQtwfdDv5J5LwStOfZ6RUTXRnaHrwpFbpbA76Hp+KJNiVBH810NhE0x7TQ5sn3AEQ+0UYZ2n6a67wSMfNvBEppjkmhPe9QkpmYLtZEg2bnTiK4RdBnRmLtDD4lTeJqbrHh42P9k6ZuXimgd+bDYwQ0Wa3G8/ZUeprc0P2bBGStt/NKAH34+KP9JYUm300dtH1ROH81M0126KMzi+D7XFLo/X2/H5u7eZVB/Fm0edX+gWxBo7FRd1nV9N4FH1a03QnQ0mJ5rtHy89MA+pTIuw5JAM13ArS0GKCVigFaqRiglYoBWqkYoJWKAVqpGKCVigFaqdgy6CHma8IkLVbc0JZALz9er1jJQ1tQsODZFDy0BQULnk3BQ8tREPEH0EoBtFIArRRAK+UK6OG9rb0xd7HnHYrtjHlIV2t89y1BseiB0cihh3drD63yLnIMtBj5cX6Rtej7yQUMzIocevj8wf73+BVNP8wQO59xYPfxNikHZuUK6MsnanZ33R+iQj6eszP3iWpZn/kpYGBWhNA7czcunBb5EDMGWuyUfdyEsq3o2IFZWXiNjl3RY7H76PlkukbHD8zKtXcdb//+cbrriB7BUGwXf8EntRLddSQaGA3uo5UCaKUAWimAVgqglQJopQBaKVVD7+6bfcp73ZypGvrty98pn/tkTdXQ7WvUlM99sqZu6Nd/RL/k1krd0Lvfa7lE1w39+ul/f9SypGuGfv/20EQ/F9VKzdBVBdBKAbRSAK0UQCsF0EoBtFIArRRAKwXQSvk/ayLKBN79zicAAAAASUVORK5CYII=" title="plot of chunk coke2rep" alt="plot of chunk coke2rep" style="display: block; margin: auto;" /></p>

<pre><code class="r">x.dens &lt;- density(DiffProp)
df.dens &lt;- data.frame(x = x.dens$x, y = x.dens$y)
p + geom_area(data = subset(df.dens, x &lt;= obsDiffProp &amp; x &gt;= min(DF$x)), aes(x = x, y = y), fill = &quot;blue&quot;, 
    alpha = 0.4) + labs(x = expression(hat(p)[Desipramine] - hat(p)[Lithium]), y = &quot;&quot;, title = &quot;Randomization Distribution&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk coke2rep" alt="plot of chunk coke2rep" style="display: block; margin: auto;" /></p>

<p>Recall that if the true <em>p</em>-value is 0.02, then we can expect the standard deviation of our simulated <em>p</em>-value to be approximately \( \sqrt{p\times(1-p)/N} \), or approximately 0.0014.</p>

<h1>Mathematical Symbols</h1>

<p>There are many online references for writing in \( \LaTeX \).  Here is a <a href="http://mirrors.ibiblio.org/CTAN/info/examples/Math_into_LaTeX-4/SymbolTables.pdf">link to a pdf</a> that you may find useful.</p>

<p>Try writing a few equations with \( \LaTeX \).  Once you get the hang of \( \LaTeX \), you will \( \heartsuit \) it!  </p>

<p>\[ \bar{y} = \sum_{i=1}^{n} \frac{y_i}{n} \]</p>

<h1>Permutation and Randomization Tests for Matched Pairs Design</h1>

<p>The ideas developed with the Schistosomiasis example can be extended to other study designs, such as a basic two-variable design called a <strong>matched pairs design</strong>.  In a matched pairs design, each experimental unit provides both measurements in a study with two treatments (one of which could be a control).  Conversely, in the completely randomized situation of schistosomiasis K11777 treatment study, half of the units were assigned to control and half to treatment; no mouse received both treatments.</p>

<h3>Music and Relaxation</h3>

<p>College students Anne Tillema and Anna Tekippe conducted an experiment to study the effect of music on a person&#39;s level of relaxation.  They hypothesized that fast songs would increase pulse rate more than slow songs.  The file called <code>Music.csv</code> contains the data from their experiment.  They decided to use a person&#39;s pulse rate as an operational definition of the person&#39;s level of relaxation and to compare pulse rates for two selections of music: a fast song and a slow song.  For the fast song they chose <a href="http://www.youtube.com/watch?v=_XT9RO1emjo">&ldquo;Beyond This Twilight&rdquo;</a> by Nine Inch Nails, and for the slow song they chose Rachmaninoff&#39;s <a href="http://www.youtube.com/watch?v=h7UZhorAki4">&ldquo;Vocalise&rdquo;</a>.  They recruited 28 student subjects for the experiment.</p>

<p>Anne and Anna came up with a <strong>matched pairs design</strong>.  Their fundamental question involved two treatments: (1) listening to the fast song and (2) listening to the slow song.  They could have randomly allocated 14 subjects to hear the fast song and 14 subjects to hear the slow song, but their more efficient approach was to have each subject provide both measurements.  That is, each subject listened to both songs, giving rise to two data values for each subject, called a matched pairs.  Randomization came into play when it was decided by a coin flip whether each subject would listen first to the fast song or the slow song.</p>

<p>In experiments, units are <strong>randomly allocated to groups</strong> which allosw researchers to make statements about causation.  In this example, Anne and Anna <strong>randomize the order</strong> to prescribe two conditions on a single subject. </p>

<p>Specifically, as determined by coin flips, half the subjects experienced the following procedure:</p>

<p>[one minute rest; measure pulse (prepulse)] \( \Rightarrow \) [listen to fast song for 2 minutes; measure pulse for second minute (fast song pulse)] \( \Rightarrow \) [rest for one minute] \( \Rightarrow \) [listen to slow song for 2 minutes; measure pulse for second minute (slow song pulse)].</p>

<p>The other half of the subjects experienced the procedure the same way except that they heard the slow song first and the fast song second as shown below.</p>

<p>[one minute rest; measure pulse (prepulse)] \( \Rightarrow \) [listen to slow song for 2 minutes; measure pulse for second minute (slow song pulse)] \( \Rightarrow \) [rest for one minute] \( \Rightarrow \) [listen to fast song for 2 minutes; measure pulse for second minute (fast song pulse)].</p>

<p>Each subject gives us two measurements of interest for analysis: (1) fast song minus prepulse and (2) slow song pulse minus prepulse.  In the <code>Music.csv</code> file, these two measurements are called <code>Fastdiff</code> and <code>Slowdiff</code>, repsectively.</p>

<p>The graph below shows a dotplot of the 28 <code>Fastdiff</code>-minus<code>Slowdiff</code> values.  Notice that positive numbers predominate and the mean difference is 1.857 beats per minute, both suggesting that the fast song does indeed heighten response (pulse rate) more than the slow song.  We need to confirm this suspicion with a randomization test.</p>

<pre><code class="r">Music &lt;- read.csv(&quot;http://www1.appstate.edu/~arnholta/Data/Music.csv&quot;)
head(Music)
</code></pre>

<pre><code>  Prepulse Slowsong Fastsong Favmusic Slowdiff Fastdiff Fastdiff.Slowdiff
1       72       78       80        1        6        8                 2
2       66       66       69        3        0        3                 3
3       70       86       78        3       16        8                -8
4       58       63       59        2        5        1                -4
5       65       80       74        3       15        9                -6
6       62       61       63        2       -1        1                 2
</code></pre>

<pre><code class="r">require(ggplot2)
ggplot(data = Music, aes(x = Fastdiff.Slowdiff)) + geom_dotplot(fill = &quot;blue&quot;) + theme_bw() + labs(x = &quot;FastDiff - SlowDiff&quot;, 
    y = &quot;&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk music" alt="plot of chunk music" style="display: block; margin: auto;" /></p>

<p>To perform a randomization test, we mimic the randomization procedure of the study design.  Here, the randomization determined the order in which the subject heard the songs, so randomization is applied to the two measurements of interest for each subject.  To compute a <em>p</em>-value, we determine how frequently we would obtain an observed difference as large or larger than 1.857. </p>

<h2>Testing the Effect of Music on Relaxation</h2>

<ol>
<li><p>Before they looked at the data, Anne and Anna decided to use a one- sided test to see whether fast music increased pulse rate more than slow music.  Why is it important to determine the direction of the test before looking at the data?</p></li>
<li><p>Create a simulation to test the <code>Music</code> data.  Randomly multiply each
each observed difference by a 1 or a -1.  This randomly assigns an order (<code>Fastdiff - Slowdiff</code>) or (<code>Slowdiff - Fastdiff</code>).  Then for each iteration, calculate the mean difference.  The <em>p</em>-value is the proportion of times your simulation found a mean difference greater than or equal to 1.8571.</p>

<ul>
<li>Create a histogram of the mean differences.  Mark the area on the histogram that represets your <em>p</em>-value.</li>
<li>Use the <em>p</em>-value to state your conclusions in the context of the problem.  Address random allocation and random sampling (or lack of either) when stating your conclusions.</li>
</ul></li>
</ol>

<p>CAUTION: the type of randomization in Question 1. does not account for extraneous variables such as a great love for Nine Inch Nails on the part of some students or complete boredom with this band on the part of others (i.e., &ldquo;musical taste&rdquo; is a possible confounder that randomizing the order of listening cannot randomize away).  There will always be a caveat in theis type of study, since we are rather crudely letting one Nine Inch Nails song &ldquo;represent&rdquo; fast songs.</p>

<h1>Contingency Tables</h1>

<p>To obtain information from the General Social Survey, go to <a href="sda.berkley.edu">sda.berkley.edu</a>. Click the ARCHIVE button.  In what follows, we will use information obtained from the <a href="http://sda.berkeley.edu/cgi-bin/hsda?harcsda+gss10">General Social Survey (GSS) Cumulative Datafile 1972-2010</a>. The following data file is obtained by clicking Download &gt; Customized Subset.  Click in the radio button to the left of CSV file (Comma Separated Values with header record).  Enter <code>age(18-65)</code> in the Selection Filter(s) box.  Type <code>DEATHPEN SEX</code> in the Enter names of individual variables (original or created) to include box.  Scroll to the bottom of the page, and click the Continue button.  Review the page that appears to make sure you have selected the desired variables; then, click the <code>Create the Files</code> button.  You should have two hot links: the <code>Data file</code> and the <code>Codebook</code>.  By clicking on the <code>Data file</code> link, the information should open in your browser.  To read the data into <code>R</code>, copy the url and store it as follows.  Note the url <code>site</code> is temporary.  Consequently, we download the data to a folder on the hard drive.  The initial code is commented out as the url will no longer work after a day or so.  That is, you will need to get a new url if you want to duplicate the entire process.  </p>

<pre><code class="r"># site &lt;- &#39;http://sda.berkeley.edu/TMPDIR/AAELN0Q9.csv&#39; download.file(url = site, destfile =
# &#39;../data/DPS.csv&#39;)
DPS &lt;- read.csv(file = &quot;../data/DPS.csv&quot;)
xtabs(~SEX + DEATHPEN, data = DPS)
</code></pre>

<pre><code>   DEATHPEN
SEX     0     1     2     3     4     5     8     9
  1 20263   257   103    28    37    35    11     0
  2 24601   283   160    58    67    37    32     2
</code></pre>

<p>Based on the <code>Codebook</code>, values 0, 8, and 9 are missing data values for the variable DEATHPEN.  We would like to store those values in our data frame as NA&#39;s (how <code>R</code> stores missing data).  Further, it would be nice to label the various categories according to their labels versus their numerical values.  To map character values to the numerical entries, we will use the <code>plyr</code> package (it can also be done using straight <code>R</code> commands).  </p>

<pre><code class="r">library(plyr)
DPS$DEATHPEN &lt;- mapvalues(DPS$DEATHPEN, from = c(0, 1, 2, 3, 4, 5, 8, 9), to = c(NA, &quot;Strongly Agree&quot;, 
    &quot;Agree&quot;, &quot;Neither Agree nor Disagree&quot;, &quot;Disagree&quot;, &quot;Strongly Disagree&quot;, NA, NA))
DPS$SEX &lt;- mapvalues(DPS$SEX, from = c(1, 2), to = c(&quot;Male&quot;, &quot;Female&quot;))
xtabs(~SEX + DEATHPEN, data = DPS)
</code></pre>

<pre><code>        DEATHPEN
SEX      Agree Disagree Neither Agree nor Disagree Strongly Agree Strongly Disagree
  Female   160       67                         58            283                37
  Male     103       37                         28            257                35
</code></pre>

<p>The problem with the latest table is that the labels for the values appear in alphabetical order.  To solve this problem, we convert the character variables, <code>SEX</code> and <code>DEATHPEN</code> to factors and assign the order of the levels using the <code>levels=</code> command.</p>

<pre><code class="r">DPS$DEATHPEN &lt;- factor(DPS$DEATHPEN, levels = c(&quot;Strongly Agree&quot;, &quot;Agree&quot;, &quot;Neither Agree nor Disagree&quot;, 
    &quot;Disagree&quot;, &quot;Strongly Disagree&quot;))
DPS$SEX &lt;- factor(DPS$SEX, levels = c(&quot;Male&quot;, &quot;Female&quot;))
T1 &lt;- xtabs(~SEX + DEATHPEN, data = DPS)
T1
</code></pre>

<pre><code>        DEATHPEN
SEX      Strongly Agree Agree Neither Agree nor Disagree Disagree Strongly Disagree
  Male              257   103                         28       37                35
  Female            283   160                         58       67                37
</code></pre>

<pre><code class="r">addmargins(T1)
</code></pre>

<pre><code>        DEATHPEN
SEX      Strongly Agree Agree Neither Agree nor Disagree Disagree Strongly Disagree  Sum
  Male              257   103                         28       37                35  460
  Female            283   160                         58       67                37  605
  Sum               540   263                         86      104                72 1065
</code></pre>

<pre><code class="r">prop.table(T1, 1)
</code></pre>

<pre><code>        DEATHPEN
SEX      Strongly Agree   Agree Neither Agree nor Disagree Disagree Strongly Disagree
  Male          0.55870 0.22391                    0.06087  0.08043           0.07609
  Female        0.46777 0.26446                    0.09587  0.11074           0.06116
</code></pre>

<h1>Test for Independence</h1>

<p>If SEX and DEATHPEN are independent, the expected count \( E_{ij} \) for any cell is the row total times the column proportion, which is equivalent to the column total times the row proportion: \[ E_{ij} = R_i(C_j/n) = C_j(R_i/n) = R_iC_j/n. \]</p>

<p>If SEX and DEATHPEN are independent, then the observed and the expected values for all cells should be similar.  The degree of similarity is measured with the statistic \[ \sum_{cells}\dfrac{(OBS - EXP)^2}{EXP} \]</p>

<h2>Null and Alternative Hypotheses</h2>

<p>The hypotheses to be tested are written as follows:</p>

<p>\( H_0: \) Death penalty opinion is independent of gender (there is no association between death penalty opinion and gender).</p>

<p>\( H_A: \) Death penalty opionion is dependent on gender (there is an association between death penalty opinion and gender).</p>

<h2><code>R</code> interlude</h2>

<p>Consider how the <code>outer()</code> function works, which we will use to compute expected values.</p>

<pre><code class="r">outer(1:3, 1:3)
</code></pre>

<pre><code>     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    2    4    6
[3,]    3    6    9
</code></pre>

<pre><code class="r">outer(1:3, 3:1)
</code></pre>

<pre><code>     [,1] [,2] [,3]
[1,]    3    2    1
[2,]    6    4    2
[3,]    9    6    3
</code></pre>

<pre><code class="r">outer(1:3, 3:1, &quot;+&quot;)
</code></pre>

<pre><code>     [,1] [,2] [,3]
[1,]    4    3    2
[2,]    5    4    3
[3,]    6    5    4
</code></pre>

<pre><code class="r">outer(1:3, 3:1, &quot;^&quot;)
</code></pre>

<pre><code>     [,1] [,2] [,3]
[1,]    1    1    1
[2,]    8    4    2
[3,]   27    9    3
</code></pre>

<p>The expected counts for <code>T1</code> are</p>

<pre><code class="r">EC &lt;- function(TAB) {
    outer(apply(TAB, 1, sum), apply(TAB, 2, sum))/sum(TAB)
}
EC(T1)
</code></pre>

<pre><code>       Strongly Agree Agree Neither Agree nor Disagree Disagree Strongly Disagree
Male            233.2 113.6                      37.15    44.92              31.1
Female          306.8 149.4                      48.85    59.08              40.9
</code></pre>

<p>To remove all of the <code>NA</code> values from <code>DPS</code>, use <code>na.omit()</code> as follows.</p>

<pre><code class="r">str(DPS)
</code></pre>

<pre><code>&#39;data.frame&#39;:   45974 obs. of  3 variables:
 $ CASEID  : int  1 3 4 5 6 7 8 9 10 11 ...
 $ DEATHPEN: Factor w/ 5 levels &quot;Strongly Agree&quot;,..: NA NA NA NA NA NA NA NA NA NA ...
 $ SEX     : Factor w/ 2 levels &quot;Male&quot;,&quot;Female&quot;: 2 2 2 2 1 1 1 2 2 2 ...
</code></pre>

<pre><code class="r">DPSC &lt;- na.omit(DPS)
str(DPSC)
</code></pre>

<pre><code>&#39;data.frame&#39;:   1065 obs. of  3 variables:
 $ CASEID  : int  26266 26267 26268 26270 26271 26272 26274 26275 26278 26279 ...
 $ DEATHPEN: Factor w/ 5 levels &quot;Strongly Agree&quot;,..: 1 1 2 1 2 3 2 1 1 2 ...
 $ SEX     : Factor w/ 2 levels &quot;Male&quot;,&quot;Female&quot;: 2 2 1 2 1 1 2 2 1 1 ...
 - attr(*, &quot;na.action&quot;)=Class &#39;omit&#39;  Named int [1:44909] 1 2 3 4 5 6 7 8 9 10 ...
  .. ..- attr(*, &quot;names&quot;)= chr [1:44909] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
</code></pre>

<p>Note that <code>DPSC</code> has 1065 observations where <code>DPS</code> has 45974 observations, but 44909 of the observations in <code>DPS</code> are <code>NA</code>.  To perform a permutation test, we will need to use the cleaned up version of the data frame <code>DPSC</code>.  </p>

<h2>Permutation Test for Independence</h2>

<p>To perform a permutation test for independence between two categorical variables, the data will need to be stored in two columns.  For example, if a contingency tables has 1065 entries, that data will need to be stored in an object with 1065 rows and a column for each categorical variable.  If the null hypothesis that <code>SEX</code> and <code>DEATHPEN</code> are independent is correct, then we could permute either the <code>SEX</code> or <code>DEATHPEN</code> values, and any other permutation would be equally likely.  For each permutation resample, we will obtain a contingency table and compute the statistic<br/>
\[ \sum_{cells}\dfrac{(OBS - EXP)^2}{EXP} \] for that permutation.  Note that for every resample, the row and column totals in the contingency table are the same; only the counts in the table change.</p>

<pre><code class="r">set.seed(123)
addmargins(table(DPSC$SEX, sample(DPSC$DEATHPEN)))
</code></pre>

<pre><code>
         Strongly Agree Agree Neither Agree nor Disagree Disagree Strongly Disagree  Sum
  Male              256   107                         27       48                22  460
  Female            284   156                         59       56                50  605
  Sum               540   263                         86      104                72 1065
</code></pre>

<pre><code class="r">addmargins(table(DPSC$SEX, sample(DPSC$DEATHPEN)))
</code></pre>

<pre><code>
         Strongly Agree Agree Neither Agree nor Disagree Disagree Strongly Disagree  Sum
  Male              230   115                         38       43                34  460
  Female            310   148                         48       61                38  605
  Sum               540   263                         86      104                72 1065
</code></pre>

<pre><code class="r">addmargins(xtabs(~sample(SEX) + DEATHPEN, data = DPSC))
</code></pre>

<pre><code>           DEATHPEN
sample(SEX) Strongly Agree Agree Neither Agree nor Disagree Disagree Strongly Disagree  Sum
     Male              232   117                         35       47                29  460
     Female            308   146                         51       57                43  605
     Sum               540   263                         86      104                72 1065
</code></pre>

<pre><code class="r">addmargins(xtabs(~sample(SEX) + DEATHPEN, data = DPSC))
</code></pre>

<pre><code>           DEATHPEN
sample(SEX) Strongly Agree Agree Neither Agree nor Disagree Disagree Strongly Disagree  Sum
     Male              218   126                         38       46                32  460
     Female            322   137                         48       58                40  605
     Sum               540   263                         86      104                72 1065
</code></pre>

<p>To perform the permutation test, randomly permute one of the catgorical variables.  Each time the categorical variable is permuted, compute the statistic \( \sum_{cells}\dfrac{(OBS - EXP)^2}{EXP} \) on the resulting contingency table and store the result.  Repeat this process a large number of times.  The \( p \)-value will be the fraction of times the simulated statistics equal or exceed the value of the observed statistic.  </p>

<pre><code class="r">N &lt;- 10^4 - 1  # Change this for slower computers
result &lt;- numeric(N)
set.seed(3)
for (i in 1:N) {
    # T2 &lt;- table(sample(DPSC$SEX), DPSC$DEATHPEN)
    T2 &lt;- xtabs(~sample(SEX) + DEATHPEN, data = DPSC)
    result[i] &lt;- chisq.test(T2)$statistic
}
obs &lt;- chisq.test(xtabs(~SEX + DEATHPEN, data = DPSC))$statistic
pvalue &lt;- (sum(result &gt;= obs) + 1)/(N + 1)
pvalue
</code></pre>

<pre><code>[1] 0.0096
</code></pre>

<pre><code class="r">pvalueCH &lt;- chisq.test(xtabs(~SEX + DEATHPEN, data = DPSC))$p.value
pvalueCH
</code></pre>

<pre><code>[1] 0.009966
</code></pre>

<pre><code class="r"># Or chisq.test(DPSC$SEX, DPSC$DEATHPEN)$p.value
hist(result, breaks = &quot;Scott&quot;, col = &quot;pink&quot;, freq = FALSE, main = &quot;&quot;)
curve(dchisq(x, 4), 0, 20, add = TRUE, col = &quot;red&quot;, lwd = 4)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk perEXP" alt="plot of chunk perEXP" style="display: block; margin: auto;" /></p>

<pre><code class="r">### Using ggplot2 now
library(ggplot2)
DF &lt;- data.frame(x = result)
p &lt;- ggplot(data = DF, aes(x = x)) + geom_density(fill = &quot;pink&quot;) + theme_bw()
p + stat_function(fun = dchisq, arg = list(df = 4), color = &quot;red&quot;, lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk perEXP" alt="plot of chunk perEXP" style="display: block; margin: auto;" /></p>

<p>The simulated permutation \( p \)-value is 0.0096.  The \( p \)-value that is returned from the <code>chisq.test()</code> is 0.01.  In this case, the two \( p \)-values are fairly similar.  This will not always be the case.  </p>

<h2>Formatting the Data</h2>

<p>Some times, you will have only access to data that has been summarized (contingency tables).  To get your data into the needed format, you may want to use the following function written by <a href="https://stat.ethz.ch/pipermail/r-help/2006-October/115290.html">Marc Schwartz</a> which will take a contingency table and convert it to a flat file.  The function <code>expand.dft()</code> is also in the package <code>vcdExtra</code>.  </p>

<pre><code class="r">expand.dft &lt;- function(x, na.strings = &quot;NA&quot;, as.is = FALSE, dec = &quot;.&quot;) {
    # Take each row in the source data frame table and replicate it using the Freq value
    DF &lt;- sapply(1:nrow(x), function(i) x[rep(i, each = x$Freq[i]), ], simplify = FALSE)

    # Take the above list and rbind it to create a single DF Also subset the result to eliminate the Freq
    # column
    DF &lt;- subset(do.call(&quot;rbind&quot;, DF), select = -Freq)

    # Now apply type.convert to the character coerced factor columns to facilitate data type selection
    # for each column
    for (i in 1:ncol(DF)) {
        DF[[i]] &lt;- type.convert(as.character(DF[[i]]), na.strings = na.strings, as.is = as.is, dec = dec)
    }

    DF
}
</code></pre>

<h3>Example Conversion</h3>

<p>The <code>x=</code> argument to <code>expand.dft()</code> is a table that has been converted to a data frame.  In the following example, a matrix of values is created that resembles a contingency table.  To convert the matrix to a table, we use the function <code>as.table()</code>.To convert the table to a data frame, we use the function <code>as.data.frame()</code>.  Finally, we apply the <code>expand.dft()</code> function to the contingency table that was converted to a data frame and stored in the object <code>HADF</code>.</p>

<pre><code class="r">HA &lt;- c(110, 277, 50, 163, 302, 63)
HAM &lt;- matrix(data = HA, nrow = 2, byrow = TRUE)
dimnames(HAM) &lt;- list(Gender = c(&quot;Male&quot;, &quot;Female&quot;), Giddy = c(&quot;Very Happy&quot;, &quot;Pretty Happy&quot;, &quot;Not to Happy&quot;))
HAM
</code></pre>

<pre><code>        Giddy
Gender   Very Happy Pretty Happy Not to Happy
  Male          110          277           50
  Female        163          302           63
</code></pre>

<pre><code class="r">HAT &lt;- as.table(HAM)
HAT
</code></pre>

<pre><code>        Giddy
Gender   Very Happy Pretty Happy Not to Happy
  Male          110          277           50
  Female        163          302           63
</code></pre>

<pre><code class="r">addmargins(HAT)
</code></pre>

<pre><code>        Giddy
Gender   Very Happy Pretty Happy Not to Happy Sum
  Male          110          277           50 437
  Female        163          302           63 528
  Sum           273          579          113 965
</code></pre>

<pre><code class="r">HADF &lt;- as.data.frame(HAT)
HATflatfile &lt;- vcdExtra::expand.dft(HADF)
head(HATflatfile)
</code></pre>

<pre><code>  Gender      Giddy
1   Male Very Happy
2   Male Very Happy
3   Male Very Happy
4   Male Very Happy
5   Male Very Happy
6   Male Very Happy
</code></pre>

<pre><code class="r">str(HATflatfile)
</code></pre>

<pre><code>&#39;data.frame&#39;:   965 obs. of  2 variables:
 $ Gender: Factor w/ 2 levels &quot;Female&quot;,&quot;Male&quot;: 2 2 2 2 2 2 2 2 2 2 ...
 $ Giddy : Factor w/ 3 levels &quot;Not to Happy&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
</code></pre>

<h2>Questions</h2>

<p>From the <a href="http://sda.berkeley.edu/cgi-bin/hsda?harcsda+gss10">http://sda.berkeley.edu/cgi-bin/hsda?harcsda+gss10</a> page, click Download &gt; Customized Subset.  Click in the radio button to the left of CSV file (Comma Separated Values with header record).  Type <code>DEATHPEN DEGREE</code> in the Enter names of individual variables (original or created) to include box.  Click in the radio button All for CASE IDENTIFICATION AND YEAR.  Scroll to the bottom of the page, and click the Continue button.  Review the page that appears to make sure you have selected the desired variables; then, click the <code>Create the Files</code> button.  You should have two hot links: the <code>Data file</code> and the <code>Codebook</code>.  By clicking on the <code>Data file</code> link, the information should open in your browser.  To read the data into <code>R</code>, copy the url and store it as follows.</p>

<pre><code class="r"># site &lt;- &#39;http://sda.berkeley.edu/TMPDIR/AAO0mzEh.csv&#39; download.file(url = site, destfile =
# &#39;../data/dpy.csv&#39;)
dpy &lt;- read.csv(file = &quot;../data/dpy.csv&quot;)
str(dpy)
</code></pre>

<pre><code>&#39;data.frame&#39;:   55087 obs. of  5 variables:
 $ CASEID  : int  1 2 3 4 5 6 7 8 9 10 ...
 $ DEATHPEN: int  0 0 0 0 0 0 0 0 0 0 ...
 $ DEGREE  : int  3 0 1 3 1 1 1 3 1 1 ...
 $ YEAR    : int  1972 1972 1972 1972 1972 1972 1972 1972 1972 1972 ...
 $ ID      : int  1 2 3 4 5 6 7 8 9 10 ...
</code></pre>

<pre><code class="r">xtabs(~DEATHPEN + DEGREE, data = dpy)
</code></pre>

<pre><code>        DEGREE
DEATHPEN     0     1     2     3     4     8     9
       0 12106 27564  2854  7450  3595    30   129
       1   120   381    30    79    29     0     3
       2    78   168    16    52    12     0     1
       3    20    63     4    14     3     0     0
       4    23    74     9    22     9     0     1
       5    12    36     4    20    12     0     0
       8    17    23     2    11     5     0     1
       9     3     2     0     0     0     0     0
</code></pre>

<p>What is the only YEAR these two questions were asked?</p>

<p>There are several ways to answer this question, here is the first one that comes to mind.   </p>

<pre><code class="r">YQ &lt;- subset(x = dpy, subset = DEATHPEN != 0 &amp; DEGREE != 0)
head(YQ)
</code></pre>

<pre><code>      CASEID DEATHPEN DEGREE YEAR ID
26266  26266        1      1 1991  1
26267  26267        1      4 1991  2
26268  26268        2      4 1991  3
26269  26269        8      3 1991  4
26270  26270        1      1 1991  5
26273  26273        1      3 1991  8
</code></pre>

<pre><code class="r">xtabs(~YEAR, data = YQ)
</code></pre>

<pre><code>YEAR
1991 
1086 
</code></pre>

<p>To satisfy the curious, the answer is 1991. </p>

<h2>Some code to answer Problem 10</h2>

<pre><code class="r">women &lt;- c(35, 146)
men &lt;- c(8, 97)
stuff &lt;- rbind(women, men)
dimnames(stuff) &lt;- list(Gender = c(&quot;Women&quot;, &quot;Men&quot;), Diet = c(&quot;Yes&quot;, &quot;No&quot;))
stuff
</code></pre>

<pre><code>       Diet
Gender  Yes  No
  Women  35 146
  Men     8  97
</code></pre>

<pre><code class="r">stuffT &lt;- as.table(stuff)
stuffDF &lt;- as.data.frame(stuffT)
head(stuffDF)
</code></pre>

<pre><code>  Gender Diet Freq
1  Women  Yes   35
2    Men  Yes    8
3  Women   No  146
4    Men   No   97
</code></pre>

<pre><code class="r">DFL &lt;- vcdExtra::expand.dft(stuffDF)
head(DFL)
</code></pre>

<pre><code>  Gender Diet
1  Women  Yes
2  Women  Yes
3  Women  Yes
4  Women  Yes
5  Women  Yes
6  Women  Yes
</code></pre>

<pre><code class="r">set.seed(2)
N &lt;- 10^4 - 1  # Change this for slower computers
result &lt;- numeric(N)
for (i in 1:N) {
    T2 &lt;- xtabs(~sample(Gender) + Diet, data = DFL)
    result[i] &lt;- chisq.test(T2)$statistic
}
obs &lt;- chisq.test(xtabs(~Gender + Diet, data = DFL))$statistic
pvalue &lt;- (sum(result &gt;= obs) + 1)/(N + 1)
pvalue
</code></pre>

<pre><code>[1] 0.0092
</code></pre>

<h2>Test of Homogeneity</h2>

<p>The major difference between testing for homogeneity and testing for independence is that you will have samples from two or more populations when testing for homogeneity. Recall that we only had one sample when we tested for independence.  Consider testing whether the proportion of boys is the same as the proportions of girls that favor three different flavors of candy.  That is, \( H_0: \pi_{B1} = \pi_{G1}, \pi_{B2} = \pi_{G2}, \pi_{B3} =\pi_{G3} \) versus
\( H_A: \) at least one of the inequalities does not hold.</p>

<pre><code class="r">candy &lt;- c(42, 20, 38, 33, 27, 50)
candyM &lt;- matrix(data = candy, nrow = 2, byrow = TRUE)
dimnames(candyM) &lt;- list(Gender = c(&quot;Boys&quot;, &quot;Girls&quot;), Flavor = c(&quot;Flavor 1&quot;, &quot;Flavor 2&quot;, &quot;Flavor 3&quot;))
candyM
</code></pre>

<pre><code>       Flavor
Gender  Flavor 1 Flavor 2 Flavor 3
  Boys        42       20       38
  Girls       33       27       50
</code></pre>

<pre><code class="r">candyT &lt;- as.table(candyM)
candyT
</code></pre>

<pre><code>       Flavor
Gender  Flavor 1 Flavor 2 Flavor 3
  Boys        42       20       38
  Girls       33       27       50
</code></pre>

<pre><code class="r">addmargins(candyT)
</code></pre>

<pre><code>       Flavor
Gender  Flavor 1 Flavor 2 Flavor 3 Sum
  Boys        42       20       38 100
  Girls       33       27       50 110
  Sum         75       47       88 210
</code></pre>

<pre><code class="r">candyDF &lt;- as.data.frame(candyT)
candyflatfile &lt;- vcdExtra::expand.dft(candyDF)
head(candyflatfile)
</code></pre>

<pre><code>  Gender   Flavor
1   Boys Flavor 1
2   Boys Flavor 1
3   Boys Flavor 1
4   Boys Flavor 1
5   Boys Flavor 1
6   Boys Flavor 1
</code></pre>

<pre><code class="r">str(candyflatfile)
</code></pre>

<pre><code>&#39;data.frame&#39;:   210 obs. of  2 variables:
 $ Gender: Factor w/ 2 levels &quot;Boys&quot;,&quot;Girls&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ Flavor: Factor w/ 3 levels &quot;Flavor 1&quot;,&quot;Flavor 2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">E &lt;- chisq.test(candyT)$expected
E
</code></pre>

<pre><code>       Flavor
Gender  Flavor 1 Flavor 2 Flavor 3
  Boys     35.71    22.38     41.9
  Girls    39.29    24.62     46.1
</code></pre>

<pre><code class="r">obsstat &lt;- chisq.test(candyT)$statistic
obsstat
</code></pre>

<pre><code>X-squared 
     3.29 
</code></pre>

<pre><code class="r"># Now we will run a permutation test.
N &lt;- 10^4 - 1  # Change this for slower computers
result &lt;- numeric(N)
set.seed(1)
for (i in 1:N) {
    T2 &lt;- xtabs(~sample(Gender) + Flavor, data = candyflatfile)
    result[i] &lt;- chisq.test(T2)$statistic
}
pvalue &lt;- (sum(result &gt;= obsstat) + 1)/(N + 1)
pvalue
</code></pre>

<pre><code>[1] 0.1941
</code></pre>

<p>In this case, there is no evidence to suggest the proportions of boys favoring flavors one, two, and three is any different than the proportions of girls favoring flavors one, two and three.</p>

<h2>Goodness of Fit</h2>

<p>A quality engineer has taken 50 samples of size 13 each from a production process.  The numbers of defectives for these samples are given in the code.  Test the null hypothesis at an \( \alpha =0.05 \) level that the number of defective follows (a) the Poisson distribution, (b) the binomial distribution.</p>

<pre><code class="r">numberDefectives &lt;- c(0, 1, 2, 3, 4, 5, &quot;6 or more&quot;)
numberSamples &lt;- c(10, 24, 10, 4, 1, 1, 0)
names(numberSamples) &lt;- numberDefectives
numberSamples
</code></pre>

<pre><code>        0         1         2         3         4         5 6 or more 
       10        24        10         4         1         1         0 
</code></pre>

<p>Since no parameters are specified, they must be estimated from the data in order to carry out the test in both (a) and (b).</p>

<p>See <a href="http://asulearn.appstate.edu/file.php/66695/STT3850/dist.pdf">dist.pdf</a> for a summary of various probability distributions.  The Poisson pdf is \( P(X =x|\lambda) = \frac{\lambda e^{-\lambda}}{x!} \) with \( E[X] =\lambda \). And estimate of the mean number of defectives in the 50 samples is 1.3.</p>

<pre><code class="r">muest &lt;- sum(numberSamples[-7] * c(0, 1, 2, 3, 4, 5))/50
muest
</code></pre>

<pre><code>[1] 1.3
</code></pre>

<p>Using \( \hat{\lambda} = 1.3 \), we compute the probabilities for each category and subsequent expected values.</p>

<pre><code class="r">ps &lt;- dpois(0:4, muest)
p5m &lt;- 1 - ppois(4, muest)
psf &lt;- c(ps, p5m)
psf
</code></pre>

<pre><code>[1] 0.27253 0.35429 0.23029 0.09979 0.03243 0.01066
</code></pre>

<pre><code class="r">exh &lt;- psf * 50
exh
</code></pre>

<pre><code>[1] 13.6266 17.7146 11.5145  4.9896  1.6216  0.5332
</code></pre>

<pre><code class="r">((numberSamples[-7] - exh)^2/exh)
</code></pre>

<pre><code>     0      1      2      3      4      5 
0.9652 2.2302 0.1992 0.1963 0.2383 0.4088 
</code></pre>

<pre><code class="r">stat &lt;- sum((numberSamples[-7] - exh)^2/exh)
stat
</code></pre>

<pre><code>[1] 4.238
</code></pre>

<pre><code class="r">epvalue &lt;- pchisq(stat, 6 - 1 - 1, lower = FALSE)
epvalue
</code></pre>

<pre><code>[1] 0.3748
</code></pre>

<p>Since the \( p \)-value is 0.3748, we can not reject the null hypothesis that the distribution follows a Poisson distribution.  That is, there is no evidence to suggest the distribution is something other than the Poisson distribution.</p>

<p>One really needs the expected cell counts to be at least five.  Consider collapsing the number of defectives greater than or equal to 3 to a single category.</p>

<pre><code class="r">ps &lt;- dpois(0:2, muest)
p3m &lt;- 1 - ppois(2, muest)
psf &lt;- c(ps, p3m)
psf
</code></pre>

<pre><code>[1] 0.2725 0.3543 0.2303 0.1429
</code></pre>

<pre><code class="r">exh &lt;- psf * 50
exh
</code></pre>

<pre><code>[1] 13.627 17.715 11.514  7.144
</code></pre>

<pre><code class="r">((numberSamples[-c(7, 6, 5)] + c(0, 0, 0, 2) - exh)^2/exh)
</code></pre>

<pre><code>     0      1      2      3 
0.9652 2.2302 0.1992 0.1833 
</code></pre>

<pre><code class="r">stat &lt;- sum((numberSamples[-c(7, 6, 5)] + c(0, 0, 0, 2) - exh)^2/exh)
stat
</code></pre>

<pre><code>[1] 3.578
</code></pre>

<pre><code class="r">epvalue2 &lt;- pchisq(stat, 4 - 1 - 1, lower = FALSE)
epvalue2
</code></pre>

<pre><code>[1] 0.1671
</code></pre>

<pre><code class="r"># Could use the following but the degrees of freedom will be incorrect for this test!
chisq.test(c(10, 24, 10, 6), p = psf)
</code></pre>

<pre><code>
    Chi-squared test for given probabilities

data:  c(10, 24, 10, 6)
X-squared = 3.578, df = 3, p-value = 0.3108
</code></pre>

<p>Note the substantial drop in \( p \)-value (0.1671) although the final conclusion is still the same.</p>

<p>For part (b), the null hypothesis is that the number of defectives in each sample of 13 follows the binomial distribution with \( n = 13 \) and \( \pi \) equal the probability of a defective in any sample.  An estimate of \( \pi \), \( \hat{\pi} \) is the total number of defectives (65) divided by the total number of observations (650).  That is \( \hat{\pi} = 0.1 \).</p>

<pre><code class="r">pihat &lt;- 65/650
ps &lt;- dbinom(0:2, 13, pihat)
p3m &lt;- 1 - pbinom(2, 13, pihat)
psf &lt;- c(ps, p3m)
psf
</code></pre>

<pre><code>[1] 0.2542 0.3672 0.2448 0.1339
</code></pre>

<pre><code class="r">exh &lt;- psf * 50
exh
</code></pre>

<pre><code>[1] 12.709 18.358 12.239  6.694
</code></pre>

<pre><code class="r">((numberSamples[-c(7, 6, 5)] + c(0, 0, 0, 2) - exh)^2/exh)
</code></pre>

<pre><code>      0       1       2       3 
0.57757 1.73402 0.40947 0.07198 
</code></pre>

<pre><code class="r">stat &lt;- sum((numberSamples[-c(7, 6, 5)] + c(0, 0, 0, 2) - exh)^2/exh)
stat
</code></pre>

<pre><code>[1] 2.793
</code></pre>

<pre><code class="r">epvalue3 &lt;- pchisq(stat, 4 - 1 - 1, lower = FALSE)
epvalue3
</code></pre>

<pre><code>[1] 0.2475
</code></pre>

<p>This example illustrates a common result with chi-square goodness-of-fit tests, i.e., that each to two (or more) different null hypotheses may be accepted for the same data set.  Obviously, the true distribution cannot be both binomial and Poisson at the same time which is why the conclusion is that there is not sufficient evidence to suggest the alternative.  This does not make the null hypothesis true!</p>

<h1>Sampling Distributions (Chapter 4)</h1>

<p>A <strong>sampling distribution</strong> is the distribution of a <em>statistic</em> is its probability distribution.  In other words, the sampling distribution of a statistic summarizes a data set, and represents how the statistic varies across random data sets.</p>

<p>The standard deviation of a statistic <em>T</em> is written \( \sigma_{T} = SE[T] \).  An estimate for the standard deviation of a statistic <em>T</em> is written \( \hat{\sigma}_{T} = \widehat{SE[T]} \).</p>

<p><strong>EXAMPLE:</strong> Toss a fair coin \( n = 10 \) times and note the proportion of heads \( \hat{p} \).  If you repeat the experiment, you probably would not get the same proportion of heads.  If you toss 50 sets of 10 coin flips, you might see outcomes (i.e., proportions of heads, \( \hat{p} \)) such as those below.</p>

<pre><code class="r">set.seed(12)
cointoss &lt;- rbinom(50, 10, 1/2)
phat &lt;- cointoss/10
xtabs(~phat)
</code></pre>

<pre><code>phat
0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 
  1   3   6  10  12  11   6   1 
</code></pre>

<pre><code class="r">plot(xtabs(~phat), ylab = &quot;count&quot;, xlab = expression(hat(p)))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk sampDIST" alt="plot of chunk sampDIST" style="display: block; margin: auto;" /></p>

<p>Although proportions between 0.3 and 0.7 occur most often, we see there is a proportion as low as 0.1 heads and as high as 0.8 heads.  Instead of 50 sets of 10 coin flips, the next simulation performs 50,000 sets of 10 tosses.</p>

<pre><code class="r">set.seed(12)
cointoss &lt;- rbinom(50000, 10, 1/2)
phat &lt;- cointoss/10
xtabs(~phat)
</code></pre>

<pre><code>phat
    0   0.1   0.2   0.3   0.4   0.5   0.6   0.7   0.8   0.9     1 
   47   480  2187  5837 10252 12238 10321  5853  2264   469    52 
</code></pre>

<pre><code class="r">mean(phat)
</code></pre>

<pre><code>[1] 0.5006
</code></pre>

<pre><code class="r">sd(phat)
</code></pre>

<pre><code>[1] 0.1581
</code></pre>

<pre><code class="r">plot(xtabs(~phat), ylab = &quot;count&quot;, xlab = expression(hat(p)))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk sampDISTsim" alt="plot of chunk sampDISTsim" style="display: block; margin: auto;" /></p>

<p>The previous plot is an approximation to the <em>sampling distribution of \( \hat{p} \)</em>.  The mean of the sampling distribution of \( \hat{p} \) is \( \mu_{\hat{p}} = p \), and the standard deviation of the sampling distribution of \( \hat{p} \), \( \sigma_{\hat{p}} = \sqrt{p\times(1-p)/n} \).  The standard deviation of the simulated \( \hat{p} \) values, the standard deviation of a statistic, is called a <em>standard error</em>.  In this simulation, the estimated mean of the statistic is written as \( \hat{\mu}_{\hat{p}}= \) 0.5006. The standard error of \( \hat{p} \), sometimes written as \( SE(\hat{p}) \) or \( \sigma_{\hat{p}} \) is 0.1581.</p>

<h2>Probability Review</h2>

<p>Let \( X:S \rightarrow \textbf{R} \) denote a random variable and \( f \) denote its density function.  The mean of \( X \), also known as the <em>expected value</em> of \( X \), is</p>

<p>\[ E[X] = \mu_X = \mu = \int_{-\infty}^{\infty}xf(x)\,dx \]
and the variance of \( X \) is
\[ V[X]=\sigma^2_{X}=\int_{-\infty}^{\infty}(x - \mu_{X})^2f(x)\,dx. \]</p>

<p>If \( X:S\rightarrow {x_1, x_2, \ldots} \) is a discrete random variable with \( P(X = x_i)=p_i \), then</p>

<p>\[ E[X] = \mu_X = \mu = \sum_{i=1}x_i\cdot p_i \]
and the variance of \( X \) is
\[ V[X]=\sigma^2_{X}=\sum_{i = 1}(x_i - \mu_X)^2\cdot p_i. \]</p>

<p>If \( X_1, X_2, \ldots , X_n \) are identically distributed random variables with mean \( \mu \) and variance \( \sigma^2 \), then</p>

<p>\[ E[\bar{X}] = \mu_{\bar{X}} = \mu, \] and
\[ Var[\bar{X}] = \sigma^2_{\bar{X}} = \frac{\sigma^2}{n} \]</p>

<p>If \( X \) and \( Y \) are random variables, then</p>

<p>\[ E[X + Y] = E[X] + E[Y], \] and if X and Y are <strong>independent</strong> then
\[ V[X + Y] = V[X] + V[Y]. \]</p>

<p>Given constants \( a \) and \( b \) and random variables \( X \) and \( Y \),</p>

<p>\[ E[aX \pm bY] = aE[X] \pm bE[Y], \]
and if \( X \) and \( Y \) are independent then
\[ V[aX \pm bY] = a^2V[X] + b^2V[Y]. \]</p>

<p><strong>Theorem:</strong> Let \( X_1, X_2, \ldots, X_n \) be independent normal random variables with mean \( \mu_i \),
and variance \( \sigma^2_i, i = 1, 2, \ldots, n, \) respectively. Let \( a_1, a_2, \ldots, a_n \) be arbitrary constants.  Then \( a_1X_1 + a_2X_2 + \cdots + a_nX_n \) is a normal variable with mean \( a_1\mu_1 + a_2\mu_2 + \cdots a_n\mu_n \) and variance \( a_1^2\sigma_1^2 + a_2^2\sigma_2^2 + \cdots + a_n^2\sigma_n^2. \)</p>

<p><strong>Corollary:</strong>  Let \( X_1, X_2, \ldots, X_n \) be independent normal random variables 
with common mean \( \mu \), and common variance \( \sigma^2 \).  Then 
\[  \bar{X} \sim N(\mu_\bar{X}, \sigma_{\bar{X}}) \]</p>

<p>Recall that \( \mu_{\bar{X}} = \mu \) and that \( \sigma_{\bar{X}} = \frac{\sigma}{\sqrt{n}} \), so the previous result is often written as </p>

<p>\[  \bar{X} \sim N(\mu, \sigma/\sqrt{n}) \]</p>

<p><strong>Do problem 13 now.</strong></p>

<h2>Calculating Sampling Distributions</h2>

<p><strong>Theorem 4.1</strong> Suppose we have continuous random variables \( X_1, X_2, \ldots, X_n \) that are i.i.d with pdf \( f \) and cdf \( F \).  Define their minimum and maximum to be the random variables</p>

<p>\[ X_{\textrm{min}} = \textrm{min}\{X_1, X_2, \ldots, X_n\}, \]
\[ X_{\textrm{max}} = \textrm{max}\{X_1, X_2, \ldots, X_n\}. \]</p>

<p>Then the pdf&#39;s for \( X_{\textrm{min}} \) and \( X_{\textrm{max}} \) are</p>

<p>\[ f_{\textrm{min}}(x) = n\left(1 - F(x)\right)^{n-1}f(x), \]
\[ f_{\textrm{max}}(x) = nF^{n-1}(x)f(x). \]</p>

<p><strong>Example 4.5</strong>  Let \( X_1, X_2, \ldots, X_{10} \) be a random sample from a distribution with pdf
\( f(x)  = 2/x^3, x \geq1. \)  Let \( X_{\textrm{min}} \) denote the minimum of the sample.  Find the probability that \( X_{\textrm{min}} \) is less than or equal to 1.2.</p>

<p><strong>Solution:</strong>  First, we compute the cdf \( F \) corresponding to \( f \):
\[ F(x) = \int_{1}^{x}\frac{2}{t^3}\,dt = \frac{-1}{t^2}\Bigr|_{1}^{x} = 1 - \frac{1}{x^2} \]</p>

<p>If follows that</p>

<p>\[ f_{\textrm{min}}(x) = 10\left(1 - \left(1 - \frac{1}{x^2}\right)\right)^{10-1}\frac{2}{x^3} =  \frac{20}{x^{21}}, x \geq 1. \]</p>

<p>Therefore,</p>

<p>\[ P(X_{\textrm{min}} \leq 1.2) = \int_{1}^{1.2}\frac{20}{x^{21}}\,dx = \frac{-1}{x^{20}}\Bigr|_{1}^{1.2} = 1 - \frac{1}{1.2^{20}} = 0.9739 \].</p>

<p>One might also choose to integrate numerically using the function <code>integrate()</code>.</p>

<pre><code class="r">fmin &lt;- function(x) {
    20/x^21
}
integrate(fmin, 1, 1.2)
</code></pre>

<pre><code>0.9739 with absolute error &lt; 1.1e-14
</code></pre>

<h2>The Central Limit Theorem</h2>

<p>Let \( X_1, X_2,...,X_n \) be independent identically distributed random variables with mean \( \mu \) and variance \( \sigma^2 \), both finite.  Then for any constant z,</p>

<p>\[ \lim_{n \to \infty} P\left(\frac{\bar{X} - \mu}{\sigma/\sqrt{n}} \leq z \right) = \Phi(z)  \]</p>

<p>Where \( \Phi \) is the cdf of the standard normal distribution.  The central limit theorem means that for &ldquo;sufficiently large&#39;&#39; \( n \), the sampling distribution of \( \bar{X} \) is approximately normal with mean \( \mu_{\bar{X}}= \mu \), and standard deviation \( \sigma_{\bar{X}} = \sigma/\sqrt{n} \).  Recall that the standard deviation of a statistic is called a standard error.  Consequently, our text refers to \( \sigma_{\bar{X}} \) as \( SE(\bar{X}) \).</p>

<h4>Note:  If you one is sampling from a normal distribution, then the resulting sampling distribution of the sample mean is exactly normal.  It is always the case that \( \mu_{\bar{X}} = \mu \) and \( \sigma_{\bar{X}} = \sigma/\sqrt{n} \) regardless of the population one is sampling from.</h4>

<h2>Just how large is &#39;&#39;sufficiently large&#39;&#39;?</h2>

<p>Consider the following simulations</p>

<pre><code class="r">set.seed(123)
par(mfrow = c(4, 3))
# X~N(50,15)
x &lt;- seq(0, 100, 0.01)
y &lt;- dnorm(x, 50, 15)
plot(x, y, type = &quot;l&quot;, col = &quot;tomato2&quot;, lwd = 2, main = &quot;X~N(50,15)&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)

# X~U(0,1)
x &lt;- seq(0, 1, 0.001)
y &lt;- dunif(x, 0, 1)
plot(x, y, type = &quot;l&quot;, col = &quot;tomato2&quot;, lwd = 2, main = &quot;X~U(0,1)&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)

# X~Exp(1)
x &lt;- seq(0, 5, 0.01)
y &lt;- dexp(x, 1)
plot(x, y, type = &quot;l&quot;, col = &quot;tomato2&quot;, lwd = 2, main = &quot;X~Exp(1)&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)

m &lt;- 20000  # Number of Samples
EX &lt;- 1.2  # Character expansion

xbar.5 &lt;- apply(matrix(rnorm(m * 5, 50, 15), nrow = m), 1, mean)
hist(xbar.5, breaks = &quot;Scott&quot;, col = &quot;tomato2&quot;, xlim = c(0, 100), prob = T, xlab = &quot;&quot;, ylab = &quot;&quot;, main = &quot;&quot;)
mtext(expression(bar(x)[5]), side = 3, line = 1, cex = EX)

xbar.5 &lt;- apply(matrix(runif(m * 5, 0, 1), nrow = m), 1, mean)
hist(xbar.5, breaks = &quot;Scott&quot;, col = &quot;tomato2&quot;, xlim = c(0, 1), prob = T, xlab = &quot;&quot;, ylab = &quot;&quot;, main = &quot;&quot;)
mtext(expression(bar(x)[5]), side = 3, line = 1, cex = EX)

xbar.5 &lt;- apply(matrix(rexp(m * 5, 1), nrow = m), 1, mean)
hist(xbar.5, breaks = &quot;Scott&quot;, col = &quot;tomato2&quot;, xlim = c(0, 5), prob = T, xlab = &quot;&quot;, ylab = &quot;&quot;, main = &quot;&quot;)
mtext(expression(bar(x)[5]), side = 3, line = 1, cex = EX)

xbar.10 &lt;- apply(matrix(rnorm(m * 10, 50, 15), nrow = m), 1, mean)
hist(xbar.10, breaks = &quot;Scott&quot;, col = &quot;tomato2&quot;, xlim = c(0, 100), prob = T, xlab = &quot;&quot;, ylab = &quot;&quot;, main = &quot;&quot;)
mtext(expression(bar(x)[10]), side = 3, line = 1, cex = EX)

xbar.10 &lt;- apply(matrix(runif(m * 10, 0, 1), nrow = m), 1, mean)
hist(xbar.10, breaks = &quot;Scott&quot;, col = &quot;tomato2&quot;, xlim = c(0, 1), prob = T, xlab = &quot;&quot;, ylab = &quot;&quot;, main = &quot;&quot;)
mtext(expression(bar(x)[10]), side = 3, line = 1, cex = EX)

xbar.10 &lt;- apply(matrix(rexp(m * 10, 1), nrow = m), 1, mean)
hist(xbar.10, breaks = &quot;Scott&quot;, col = &quot;tomato2&quot;, xlim = c(0, 5), prob = T, xlab = &quot;&quot;, ylab = &quot;&quot;, main = &quot;&quot;)
mtext(expression(bar(x)[10]), side = 3, line = 1, cex = EX)

xbar.30 &lt;- apply(matrix(rnorm(m * 30, 50, 15), nrow = m), 1, mean)
hist(xbar.30, breaks = &quot;Scott&quot;, col = &quot;tomato2&quot;, xlim = c(0, 100), prob = T, xlab = &quot;&quot;, ylab = &quot;&quot;, main = &quot;&quot;)
mtext(expression(bar(x)[30]), side = 3, line = 1, cex = EX)

xbar.30 &lt;- apply(matrix(runif(m * 30, 0, 1), nrow = m), 1, mean)
hist(xbar.30, breaks = &quot;Scott&quot;, col = &quot;tomato2&quot;, xlim = c(0, 1), prob = T, xlab = &quot;&quot;, ylab = &quot;&quot;, main = &quot;&quot;)
mtext(expression(bar(x)[30]), side = 3, line = 1, cex = EX)

xbar.30 &lt;- apply(matrix(rexp(m * 30, 1), nrow = m), 1, mean)
hist(xbar.30, breaks = &quot;Scott&quot;, col = &quot;tomato2&quot;, xlim = c(0, 5), prob = T, xlab = &quot;&quot;, ylab = &quot;&quot;, main = &quot;&quot;)
mtext(expression(bar(x)[30]), side = 3, line = 1, cex = EX)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAogAAANgCAMAAACY92nTAAAAtFBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVlZrVltbVltf2POQCPOTmPOWWPZmWPZo+PjzmPj2WPj7WPtY+P29qP2/21ZgC1Zjm1ZmW1jzm1j4+1tbW124+1/rW1/v3ajznaj2XatWXa29ra/rXa/v3uXEL9tWX924/9/rX9/tr9/v1zw27DAAAAPHRSTlP//////////////////////////////////////////////////////////////////////////////wC7iOunAAAACXBIWXMAAAsSAAALEgHS3X78AAAgAElEQVR4nO2dC3vjNnaGy3FjN8l25Ek73TjKzLqXSJ7NtlK7sXXh//9f5UWyRIkHBIgD4CP0vc/sxYJwiAO+AgiJl38oCQHgH1I3gJAaikggoIgEAopIIKCIBAKKSCCgiAQCikggoIgEAopIIKCIBAKKSCCgiAQCikggoIgEAopIIAgo4ubDotwU88Mf1f/Z3K3K5axcFkVVsi6KWVu0/adF2b64vg/XGm262VWZHbLr5jWljBo6aW0fiop55w1VikEyCzkiLu/3vx52SpXcd6/Vrtp9WrSvVbk0AtbZVrkfXvx+FbA5ynSya0WssrvIa1IZNZyndcjknCrFMJmFFHH3+PN3r5WCVbP/trn793m1q+q99VgU981ue5yXdbL/VaXbvti+MhG62TUiHhOcl6e85omb6cp5WgcRqxGy/vfhh3YwCZNZ0GPEdT1L/a22rJLwfz7/391qXaXyYVElUf2fYyp1uu2Lp8/iFOhk14hYJXWR17QyajhLq5ma68Oof/yXWbuLZlV+YTILKeLm7r/fx/ZqN/3vf9ytlnUedRLvI8f7BFC9uP91QodUnezqI6smu4u8JpVRw3lax6l591gPkvUx8P3yJKJuZgFFrD4/ZSteWbZTcTsiNrvqdCzVjojNi1MaPzrZbR/m5brJ7iKvKWXU0E3rkEnl3309QU90RFxWH6Htw6G5zeepOYSqF8izsl1dNpkeV82zSR1RdbKrszl8LdDNa0oZNXTSalfNs+ojVr20ufu39hgxTGaRv0es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" title="plot of chunk CLTsim" alt="plot of chunk CLTsim" style="display: block; margin: auto;" /></p>

<pre><code class="r">
par(mfrow = c(1, 1))
</code></pre>

<h4>Note:  The usual rule of thumb, found in most textbooks, is that the CLT is reasonably accurate if \( n \geq 30 \).  Such rules are wishful thinking, dating to a pre-computer age when one had few realistic alternatives to using the CLT because most other methods were computationally infeasible.</h4>

<h2>CLT for Binomial Data</h2>

<p><strong>Example 4.9</strong> Toss a fair coin 300 times.  Find the approximate probability of getting at most 160 heads.</p>

<p><strong>Solution:</strong> Let \( X= \) the number of heads in 300 flips of a fair coin.  Since \( X \sim Bin(n = 300, p = 1/2) \) it follows that \( \mu_X = np \) and \( \sigma_{X} =\sqrt{np\times(1 - p)} \), and \( Y \dot{\sim} N(np, \sqrt{np\times(1 - p)}) \).  It follows that \( P(X \leq 160) = P\left(\frac{X - np}{\sqrt{np \times (1 - p)}} = Z \leq \frac{160 - 150}{\sqrt{300/4}}\right). \)  Furthermore, \( P(Z \leq 1.154701)= \) 0.8759.  Solve the problem in class using \( \hat{p} \) as the random variable.</p>

<p><strong>Exact Solution:</strong> \( P(X \leq 160)= \sum_{x = 0}^{x = 160}\binom{300}{x} 0.5^x 0.5^{300-x}= \) 0.8874.</p>

<pre><code class="r">pbinom(160, 300, 1/2)
</code></pre>

<pre><code>[1] 0.8874
</code></pre>

<h1>THE BOOTSTRAP (Chapter 5)</h1>

<p>We now move from the realm of probability to statistics, from situations where the population is known to where it is unknown. If all be have are data and a statistic estimated from the data, we need to estimate the sampling distribution of the statistic. One way to do this is with the <strong>bootstrap</strong>.</p>

<p>The birth weight of a baby is of interest to health officials since many studies have shown possible links between this weight and conditions in later life, such as obesity or diabetes. Researchers look for possible relationships between the birth weight of a baby and age of the mother or whether or not she smokes cigarettes or drink alcohol during her pregnancy. The centers for disease control and prevention CDC, using data provided by the U.S. Department of Health and Human Services, National Center for Health Statistics, the Division of Vital Statistics as well as the CDC, maintain a database on all babies born in a given year. We will investigate different samples taken from the CDC&#39;s database of births.</p>

<h3>INTRODUCTION TO THE BOOTSTRAP</h3>

<pre><code class="r">require(xtable)
site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/NCBirths2004.csv&quot;
Babies &lt;- read.csv(file = url(site))
</code></pre>

<p>For the North Carolina data, the mean weight of the 1009 babies in the sample is 3448.2597 g. We are interested in \( \mu \), the true birth weight mean for all North Carolina babies born in 2004; this is probably not the same as the sample mean. We have already mentioned the different samples of the same size will yield different sample means, so how can we gauge the accuracy of the 3448.2597 as an estimate to \( \mu \)?</p>

<p>If we knew the sampling distribution of sample means for samples of size 1009 from the population of all 2004 North Carolina births, then this would give us an idea of how means vary from sample to sample, for the standard error of the sampling distribution tells us how far means deviate from the population mean \( \mu \). But of course, since we do not have all the birth weights, we cannot guarantee the sampling distribution (and if we did have all the weights, we would know the true \( \mu \)!).</p>

<p>The bootstrap is a procedure that uses the given sample to create a new distribution, called the <strong>bootstrap distribution</strong>, that approximates the sampling distribution for the sample mean (or for other statistics). We will begin by considering only a small subset of the birth weights&mdash; three observations, 3969, 3204, and 2892.</p>

<p>To find the bootstrap distribution of the mean, we draw samples (called <em>re-samples</em> or <em>bootstrap samples</em>) of size \( n \), with replacement, from the original sample and then compute the mean of each resample. In other words, we now treat the original sample as the population. For instance, Table 1, created with the folowing code shows all \( 3^3 \) or 27 samples of size 3, taking order into account (the notation \( x^* \) indicates a resampled observation and \( \bar{x}^* \) or \( \bar{\theta}^* \) the statistic for the bootstrap sample).</p>

<pre><code class="r">rs &lt;- c(3969, 3204, 2892)
xstar1 &lt;- rep(rs, each = 9)
xstar2 &lt;- rep(rep(rs, each = 3), 3)
xstar3 &lt;- rep(rs, 9)
XD &lt;- data.frame(xstar1, xstar2, xstar3)
xbarstar &lt;- apply(XD, 1, mean)
BD &lt;- cbind(XD, xbarstar)
WD &lt;- BD
</code></pre>

<!-- html table generated in R 3.0.1 by xtable 1.7-1 package -->

<!-- Thu Mar 20 10:44:58 2014 -->

<TABLE border=1>
<CAPTION ALIGN="bottom"> Table 1 &mdash; All possible Samples of Size 3 from 3969, 3204, and 2892 </CAPTION>
<TR> <TH> \( x^*_1 \) </TH> <TH> \( x^*_2 \) </TH> <TH> \( x^*_3 \) </TH> <TH> \( \bar{x}^* \) </TH>  </TR>
  <TR> <TD align="right"> 3969.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3969.00 </TD> </TR>
  <TR> <TD align="right"> 3969.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3714.00 </TD> </TR>
  <TR> <TD align="right"> 3969.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3610.00 </TD> </TR>
  <TR> <TD align="right"> 3969.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3714.00 </TD> </TR>
  <TR> <TD align="right"> 3969.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3459.00 </TD> </TR>
  <TR> <TD align="right"> 3969.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3355.00 </TD> </TR>
  <TR> <TD align="right"> 3969.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3610.00 </TD> </TR>
  <TR> <TD align="right"> 3969.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3355.00 </TD> </TR>
  <TR> <TD align="right"> 3969.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3251.00 </TD> </TR>
  <TR> <TD align="right"> 3204.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3714.00 </TD> </TR>
  <TR> <TD align="right"> 3204.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3459.00 </TD> </TR>
  <TR> <TD align="right"> 3204.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3355.00 </TD> </TR>
  <TR> <TD align="right"> 3204.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3459.00 </TD> </TR>
  <TR> <TD align="right"> 3204.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3204.00 </TD> </TR>
  <TR> <TD align="right"> 3204.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3100.00 </TD> </TR>
  <TR> <TD align="right"> 3204.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3355.00 </TD> </TR>
  <TR> <TD align="right"> 3204.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3100.00 </TD> </TR>
  <TR> <TD align="right"> 3204.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 2996.00 </TD> </TR>
  <TR> <TD align="right"> 2892.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3610.00 </TD> </TR>
  <TR> <TD align="right"> 2892.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3355.00 </TD> </TR>
  <TR> <TD align="right"> 2892.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3251.00 </TD> </TR>
  <TR> <TD align="right"> 2892.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3355.00 </TD> </TR>
  <TR> <TD align="right"> 2892.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 3100.00 </TD> </TR>
  <TR> <TD align="right"> 2892.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 2996.00 </TD> </TR>
  <TR> <TD align="right"> 2892.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3969.00 </TD> <TD align="right"> 3251.00 </TD> </TR>
  <TR> <TD align="right"> 2892.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 3204.00 </TD> <TD align="right"> 2996.00 </TD> </TR>
  <TR> <TD align="right"> 2892.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 2892.00 </TD> <TD align="right"> 2892.00 </TD> </TR>
   </TABLE>

<p>The idea behind the bootstrap is that if the original sample is representative of the population, then the bootstrap distribution of the mean will look approximately like the sampling distribution of the mean; that is, have roughly the same spread and shape. However, the mean of the bootstrap distribution will be the same as the mean of the original sample, not necessarily that of the original population.</p>

<pre><code class="r">head(BD)
</code></pre>

<pre><code>  xstar1 xstar2 xstar3 xbarstar
1   3969   3969   3969     3969
2   3969   3969   3204     3714
3   3969   3969   2892     3610
4   3969   3204   3969     3714
5   3969   3204   3204     3459
6   3969   3204   2892     3355
</code></pre>

<pre><code class="r">mean(rs)
</code></pre>

<pre><code>[1] 3355
</code></pre>

<pre><code class="r">mean(BD[, &quot;xbarstar&quot;])
</code></pre>

<pre><code>[1] 3355
</code></pre>

<blockquote>
<p>The bootstrap idea: the original sample approximates the population from which it was drawn. So resamples from this sample approximates what we would get if we took many samples from the population. The bootstrap distribution of the statistic, based on many resamples, approximates the sampling distribution of the statistic, based on many samples.</p>
</blockquote>

<p>Thus, the standard deviation of all the resample means listed in Table 1 is 266.2054 and we use this value as an estimate of actual standard error (standard deviation of the true sampling distribution).</p>

<p>Of course, it is hard for three observations to accurately approximate the population. Let us work with the full data set; we draw resmaples of size \( n = 1009 \) from the 1009 birth weights and calculate the mean for each.</p>

<p>There are now \( 1009^{1009} \) samples, too many for exhaustive calculation. Instead, we draw samples randomly, of size 1009 with replacement from the data, and calculate the mean for each. We repeat this many times, say 10,000, to create the bootstrap distribution. You can imagine that there is a table like Table 1 with \( 1009^{1009} \) rows, and we are randomly picking 10,000 rows from that table.</p>

<blockquote>
<h4>BOOTSTRAP FOR A SINGLE POPULATION</h4>

<p>Given a sample of size \( n \) from a population,</p>

<ol>
<li> Draw a resample of size \( n \) with replacement from the sample.  Compute a statistic that describes the sample, such as the sample mean.</li>
<li> Repeat this resampling process many times, say 10,000.</li>
<li> Construct the bootstrap distribution of the statistic.  Inspect its spread, bias, and shape.</li>
</ol>
</blockquote>

<pre><code class="r">set.seed(13)
head(Babies)
</code></pre>

<pre><code>  ID MothersAge Tobacco Alcohol Gender Weight Gestation
1  1      30-34      No      No   Male   3827        40
2  2      30-34      No      No   Male   3629        38
3  3      35-39      No      No Female   3062        37
4  4      20-24      No      No Female   3430        39
5  5      25-29      No      No   Male   3827        38
6  6      35-39      No      No Female   3119        39
</code></pre>

<pre><code class="r">B &lt;- 10000
my.boot.statB &lt;- numeric(B)
for (i in 1:B) {
    x &lt;- sample(Babies$Weight, size = sum(!is.na(Babies$Weight)), replace = TRUE)
    my.boot.statB[i] &lt;- mean(x)
}
hist(my.boot.statB, breaks = &quot;Scott&quot;, col = &quot;lightblue&quot;, xlab = substitute(paste(bar(X), &quot;* (g)&quot;)), main = &quot;Bootstrap Distribution of means \n for NC birth weights &quot;, 
    freq = FALSE)
abline(v = mean(Babies$Weight), col = &quot;blue&quot;)
abline(v = mean(my.boot.statB), col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAmVBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZmU5j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVltbVltf2POQCPOTmPOWWPZgCPtY+P27WP29qP2/2t2Oa1ZgC1tWW124+1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v3/AADA1e4vAAAAM3RSTlP/////////////////////////////////////////////////////////////////AP/PuK9xAAAACXBIWXMAAAsSAAALEgHS3X78AAANDElEQVR4nO2dC5ubNhaGy0yT2OlmPellk9qz29Z2mqEZX8j//3GLbliYqwB9CPjep41vQojXByGOMPNDQiD8MHYDlgJFg6BoEBQNgqJBUDQIigZB0SAoGgRFg6BoEBQNgqJBUDQIigZB0SAGF315igRvX0s/PW6rXlRVtBXPHl9KlhJvX3f2R1mB/BLlnNfRw76p0HD4El1u+hhtK15UV7SpqSIpEd1QrXO5gfAgWmy6+jc2ntST6y59WIlQikQsihfX3cOnNLBO6fM0vFJtX8RnVkWn9KV8VlzqTxXRX+SXKo1fnt5+kwVyq8/VmmuLDIZT9G6XfhrLnUd+upXv3rVIrb+7F2+i0404yohcJebJVUuQAf9tl7319h/11qt8ZXYGvfungSeelS6lxatFC6LN6nWZlWqf3RYt2pAts9G7U9aiVfZGZy++uo40Gs7r9J/L08M+eyJ31/NaN1e8SDdkZZaT2uQ2bs0biQgxKbpkKWuJh70R/SoLqCX0WmWZk5aUb4tA7DNpuG5VS83OYbdILJutvyve+ujHl5N0mIrKnmgJKni0MnVAEm+aQ1usupu86JKlbgfD9L2i6GytsrT8KBFa7baYd1RVqgtTUZK1SC+brb8rnroOsRkVomVvF+mQUsrkOxWidddRslR70eajpFq06CUs0bkWyWXN+rviUXRF1yE56i1VyoTa87q068gOhsWl7rqO9P04Ku86LNFlXcdNdNZB3FpkLdtroOKx6ygcDOWTlQkW+UIpO0UmfnIHQzO8U9oKS13sg6Feh3pyfzDMy8raUhSd1XJrkV42W39XPB4MC8M72UeoNusOIx0kyILp9m3UTv4lO7TfnbAUl7rYwztZ/He9j8sBiT28s0RnbSkVLU2LkrcWWV1HnxOcoE7By87z5gJFg6BoEEGJnjMUDYKiQVA0iHFFVyTf1cmhOjTK4bTOSWcHSzuxf9w2H0RzEwFW6fqph0EZV3TFOW0q12TRdPZBpfhK51OiFqJz3Eojc/9jijY54ewMTk4CJCqKN1KIzGWkBVTcZ+eBOtv2KTLJ5ce/1/r8WGqM5Ym7rtqcW6Z1PX6Vp4CqdG4ewvvGBiA6l6CXJ8qpl/+oPIPK8lx329sCokyW5njzS5bFN2GvMnOrdF/YWHl8Xf7H9S2Zn5uH6JdsbsH4XYedoL9NAvy93gjRp9yUYZar0+JWSTYRsMkmFM7rzeXp8+NLbOXxVVpKhroUrUvn5iE8M77ofIJeIrwcH/4qEa2zzyZRn1gTASZtdHland//8X5/FEvrBFeWn86yR1bqumdGvyXBir48vSvpOqpE5xKhj1/Svvj3p1VSJdqeI+id0W/J+KKtrsMWLY5jcgYrdzDMdR0Vok8Pn9KO/99rq1u46zpyok07PDO+aCtBnxMtBgmF4V3uYGhS2au8aPnlxHqC8e7gqQ6GN9HWPIRnAhBtDe9s0XIWq3DCkhveieJqIsAWLWe19Ky3zuPLCtOazPDulsy/zUN4ZmGn4CfAQK6c5YjWU2Ob5pJeWI5o1d2vxlr7gkSPC0WDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA1i0qK/j90ABygaBEWDoGgQFA2CokFQNAiKBjFt0WK6dexGtGTaog+HA0UDoGi/RAaK9ksk/Kb/HyjaLxQNgqJBUDQIigZB0SAoGsRiRGcnDIO3puX6lyLaEIboiSSWpi96IlFN0SAoGgRFg6BoEBQNgqJBUDQIigZB0SDmIXoCp+HzED2BqKZoEFMTLXsJivZPZLmlaE/Y0VwUHfgRcVKiba8F0Yeww3pmosON6pmJDjeqKRoERYOgaBAUDaJZtLodbdn9aCnagUbR5ibZp+LdUynagUbRl59fco8WFO3ARCI6uj/9np9oczvgcfvom8b5iq6Goh2gaBCthnfyT+mOejBcgGhxMLzuNhTdk5bDu+OKovvRdngX//gTRfehzfBO/Q314vguUNFhJv9nOOoIM6opGkSX7N0IP39bgOhAch3zFx1G9m4BohnRwzDD7N1URVdD0Q4ELtoMbhYkepyDobG2INElULQDFA0i8Os6sizR/EWPO44u1zhL0eOeGXYVHV6qdKYRHV5UB35muCTR1VC0AxQNgqJBUDQIigYxY9FhDaZnLPoQVFhTNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDUKIvT6sOy1K0AyaiT5H8IbITFO2A1XVcd1G0dVmWoh0wotVP60suR6qBoh0wfXTxOqRmKNoBLVpGctt4Bv7OcF6i9UVfUeQY1hTtgB3RrnjeisLtomcguhu+RTdqbCE6mEsOZNfx89fKK0brmILoYKJ67hFN0fU1l95PcA6i47evseN5oVfR1damLfrycZ/+dy7eNqkWinYgG96lMU3RHjFdR/SwP7Hr8EigB0OKtqFoB7ToU1gnLLMVfXly7J4lFO1AmEml2YpOjpsOy1K0A6brYB/tGY46QFA0CC36uove/vPR8cIOinZAib7uNucPryW35KiFoh3IhnepaNdB3lREBzGdZUd0PNOIDiKqb32089UGFO3CEkYdExE9xn3vZitayiw/LxzlLmFzFX2Sl0af12UpPPh976pv3Dh50ddndaaSDjyKBeAR3cLaVEXXBG2Cv+/dYkVXQ9EOhCXavkBpjqLN9dGj56NbWpuq6K5QtAPNtzWuDneKdqA5osWf5yyHoh1o0XVcqiYEKNoB9tEgKBpEWH/PcMmiobmOJYuGZu+WLJoRPQxh/dUKf6JHnwlfyqhj9KimaBBh/T1Dii6Foh2gaBBhXdexZNEzGUeHLxp2Zth8w5l5i4ZFdLPXeYuGnRkuXnQ1FO0ARYOgaBBLEj1qCm9Jog9jhjVFg1ic6LG6jyBEt7zN3SCix4rqMEQ7SKLoPhVRdC0U7QBFg6BoEBQNgqJBUDQIigaxSNFjnIYvUvQYUU3RICgaBEWDoGgQo4t2uOEMRfehi6SliB70d4YU3QxFO0DRIEYV7XhnH4ruXEFHSRTtWgFFt4KiHaBoEBQNYrGi0cn/0UR3+BHWoKKNbJTt8UT3lDSE6AOwD6HoPhvhAEX32QgHKLrPRjhA0X02wgGK7rMRDlA0aIg3huiuP1nxIxoU1aOI7uOEoh2Wo2g3KNoBtOg+l3FQtMsyfZ1QdMtlKNqd+YgGjKXR970LUzRANvouYeGKPvjtQtD3vaPoKgaM6L4XJs1b9ID3vRvUiRfRHvtp5KgjfNEeo5qiy6Lag23k8G4aog9+whpwMMx+IDAh0cNHtefh3aA5JKDo4WV7juhBvYJFHwbtQoYf3kU5KFoz3KjDduvH6wiih/sB2jCivRzqQhCdvZHc76qu38Awf8+wvA3e+T7Sem0GE11zMByd72M3wIE+w7vRmZVoRvQw9Bnejc68RAcMRYOYpWgeDPvhKaIxY1jwOLqXEV+iPZScUKUl9En81zAdJ8GI7jaOno6TYER3OzOcjpNgRDOiO1Ragqczw+k4CUd0J6bjZOKiyT0UDYKiQVA0CIoGQdEgKBoERYOgaBAUDWI40SeTD5FpqMtTJLJQ+qGupMh3bytK3hXN111X8rqLHvbtKk3XL17VVRqrXE/dNjUymOjzTy9JvBLP4tSb2IT0lX6oK3n5uE/O7/elJe+K5uuuLXncinRjm0rF+uOKoqbkMfuSq7apmUG7DtGw5PyvX7Yye52+0g91JU+izcdtZUmraL7uptUnSXVJq+j5w6soV1fp9Xlv1VZdaS2DihZf9PX5r51u/se9fqgrKagraRfN1V2/+v+JrqNNpTqi6yqVieLmbapnQNHntegW443Yt8Q0Qdoa/VBXMhH75CapKJkvmqu7ruR5Lb20qlR1uXWVpj1b+q3s67epiUEjWn3f1xYRfSsptnST1ARfrtJrXUS3X71dNLV4enypq1Q+HrfBRLRsTSynYzaN/VlWUkZfXXd6K5qvu3b1v0kZbSrVAVpXqX4IpI++7VEiTkRvII/Qm+IROl9SeS4veVc0X3dtyaOO/+ZKdUTXVSoerv99qdumZoaL6DRCHuQO1TiOzpVUgbWtGJ3mK60bRxdWXzk4vit6iqqH3LpknCsy8jia1EPRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA1iiqIH+YElmimKniQUDYKiQUxRdCxmko4bMY+n39joT8QMdaBMUbSeeo3ffJaXL9l6M+XBMUnR5w/fxFVaYgJbcFSzsW9+3Qd5VxHFJEUn8eeNuBTkq9Qq5aY9yUnMVOurMMJjmqL1xSD6hbpMMZHXIgbbd0xS9PX5D+uoJ65vEbIpenBOK9FVGBjRvri7+o19tCfExW96MK3Qo453zxx1+EWPo+UPIULtOWYhWl5SHplL/ANlFqKnAEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWD+D/lYd5M5ec1yQAAAABJRU5ErkJggg==" title="plot of chunk boot1" alt="plot of chunk boot1" style="display: block; margin: auto;" /></p>

<pre><code class="r">boot.bias &lt;- mean(my.boot.statB) - mean(Babies$Weight)
boot.bias
</code></pre>

<pre><code>[1] -0.1367
</code></pre>

<pre><code class="r">ggplot(data = data.frame(x = my.boot.statB), aes(x = x)) + geom_density(fill = &quot;lightblue&quot;) + labs(x = substitute(paste(bar(X), 
    &quot;* (g)&quot;)), title = &quot;Bootstrap Distribution of means \n for NC birth weights&quot;) + theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk boot1" alt="plot of chunk boot1" style="display: block; margin: auto;" /></p>

<p>Note that the bootstrap distribution is approximately normal.  Second, with mean 3448.1229, it is centered at approximately the same location as the original mean, 3448.2597.  The difference between where the bootstrap distribution is centered and the mean of the of original sample is the bootstrap bias in this example -0.1367.  In general, the <em>bias</em> of an estimate \( \hat{\theta} \) is \[ Bias[\hat{\theta}] = E[\hat{\theta}] - \theta . \]  The bootstrap estimate of bias is \[ Bias_{boot}[\hat{\theta}^*] = E[\hat{\theta}^*] - \hat{\theta}, \] the mean of the bootstrap distribution, minus the estimate from the original data. Third, we get a rough idea of the amount of variability.  We can quantify the variability by computing the standard deviation of the bootstrap distribution, in this case 15.5882.  This is the bootstrap standard error.</p>

<blockquote>
<h4>BOOTSTRAP STANDARD ERROR</h4>

<p>The <em>bootstrap standard error</em> of a statistic is the standard deviation of the bootstrap distribution of the statistic.</p>

<h4>BIAS</h4>

<p>A statistic used to estimate a parameter is <em>biased</em> when the mean of its sampling distribution is not equal to the true value of the parameter.  The bias of a statistic \( \hat{\theta} \) is \( Bias[\hat{\theta}] = E[\hat{\theta}] - \theta \).  A statistic is <strong>unbiased</strong> if its bias is zero.</p>

<p>The bootstrap method allows us to check for bias by seeing whether the bootstrap distribution of a statistic is centered at the statistic of the original random sample.  The bootstrap estimate of bias is the mean of the bootstrap distribution minus the statistic for the original data, \( Bias_{boot}[\hat{\theta}^*] = E[\hat{\theta}^*] - \hat{\theta} \).</p>
</blockquote>

<h3>Solution With The <code>boot</code> Package</h3>

<pre><code class="r">set.seed(13)
library(boot)
bs.mean &lt;- function(data, i) {
    d &lt;- data[i]
    M &lt;- mean(d)
    M
}
boot.obj &lt;- boot(data = Babies$Weight, statistic = bs.mean, R = 10000)
plot(boot.obj)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk packageBOOT" alt="plot of chunk packageBOOT" style="display: block; margin: auto;" /></p>

<pre><code class="r">BIAS &lt;- mean(boot.obj$t) - boot.obj$t0
BIAS
</code></pre>

<pre><code>[1] -0.1367
</code></pre>

<h3>Key Features Of The Bootstrap</h3>

<p>To highlight some key features of the bootstrap distribution, we begin with two examples in which the theoretical sampling distributions of the mean are known.</p>

<ul>
<li>Example 1:  Consider a random sample of size 49 drawn from a \( N(25, 7) \).  Theory tells us that that the sampling distribution of the sample means is normal with mean 25 and standard error \( \sigma/\sqrt{n} = 7/\sqrt{49} = 1 \). </li>
</ul>

<pre><code class="r">opar &lt;- par(no.readonly = TRUE)
set.seed(11)
par(mfrow = c(3, 2))
curve(dnorm(x, 25, 7), from = 25 - 2.5 * 7, 25 + 2.5 * 7, col = &quot;blue&quot;, main = &quot;N(25, 7)&quot;, ylab = &quot;&quot;, 
    xlab = &quot;&quot;)
abline(v = 25, col = &quot;red&quot;)
curve(dnorm(x, 25, 1), from = 25 - 2.5 * 7, 25 + 2.5 * 7, col = &quot;blue&quot;, main = &quot;N(25, 1)&quot;, ylab = &quot;&quot;, 
    xlab = &quot;&quot;)
abline(v = 25, col = &quot;red&quot;)
rs1 &lt;- rnorm(49, 25, 7)
rs2 &lt;- rnorm(49, 25, 7)
hist(rs1, xlab = &quot;&quot;, main = &quot;n = 49&quot;)
abline(v = mean(rs1), col = &quot;red&quot;)
B &lt;- 10000
my.boot.stat1 &lt;- numeric(B)
my.boot.stat2 &lt;- numeric(B)
for (i in 1:B) {
    x1 &lt;- sample(rs1, size = 49, replace = TRUE)
    x2 &lt;- sample(rs2, size = 49, replace = TRUE)
    my.boot.stat1[i] &lt;- mean(x1)
    my.boot.stat2[i] &lt;- mean(x2)
}
hist(my.boot.stat1, breaks = &quot;Scott&quot;, main = &quot;Bootstrap Distribution&quot;, freq = FALSE, xlab = &quot;&quot;, xlim = c(25 - 
    2.5 * 7, 25 + 2.5 * 7))
abline(v = mean(rs1), col = &quot;red&quot;)
hist(rs2, xlab = &quot;&quot;, main = &quot;n = 49&quot;)
abline(v = mean(rs2), col = &quot;red&quot;)
hist(my.boot.stat2, breaks = &quot;Scott&quot;, main = &quot;Bootstrap Distribution&quot;, freq = FALSE, xlab = &quot;&quot;, xlim = c(25 - 
    2.5 * 7, 25 + 2.5 * 7))
abline(v = mean(rs2), col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAq1BMVEX9/v0AAAAAADkAAGUAAP8AOTkAOY8AZrU5AAA5ADk5AGU5OQA5OWU5ZmU5ZrU5j9plAABlADllAGVlOTllOY9lZgBlZrVltdpltf2POQCPOTmPOWWPZmWPZo+PjzmPj2WPj9qPtY+P29qP2/21ZgC1Zjm1ZmW124+12/21/rW1/v3ajznaj2XatWXatbXa29ra/rXa/v39tWX924/927X9/rX9/tr9/v3/AADUGf95AAAAOXRSTlP/////////////////////////////////////////////////////////////////////////AP+Eine/AAAACXBIWXMAAAsSAAALEgHS3X78AAAXBElEQVR4nO2dDXujNhZGl3h27Gm7k7SbZp12ZqcdO9mt2W4bezH+/79sJfAHAgkk9An3Pc/TaRJxQVcHCQwY/aUEJPlL7AqAOEA8USCeKBBPFIgnCsQTBeKJAvFEgXiiQDxRIJ4oEE8UiCcKxBMF4okC8USJIn6frcv9Yldu74/PWbYsy22W3W3qsjxj3OfLGPUKQV/uZXn4sCnD5B5J/Ps3lnzx/SZn/z6sj8/3zeLtYnf4ZhejYgHozf2wYvtAmNzjiF/8c82S5zt+WbLki4dq37+UsuTZH2NULAB9uR8+/PohVO6RxP/2+Ptil79/K8vj85KrvmXL/1C2xoAZ0Zt7NdSHyT2S+N1/vix2W5Z88VBnecv2sFqf7c+S3tzP4kPkHkt88VDt9XXu1e+XvT7ng+Cce3xP7gR6PD+DY//b8nP4NT+zva+SZlSD4JyP8T25V/+f8TH+DDuzFX5/uf0637P6M9Fzj3oBZyuMaYePt5/n+zn+QuzcceWOKBBPFIgnCsQTBeKJAvFEgXiiQDxRIJ4oEE8UiJfRvII6UyC+DX8kJssWM79JpCs+883J+xb024Spb94n8V6zKLnritdvtnGcfG9gfAbzzB3ipRx/vg3188w9EfHvEhN/jVIMlE4hKv4dpzzV//OHfgbVI1GNgzzE++Ai+yT85gHtDIrHt7BD/buTzx2eoy+eJZ/zBwF7Qx1wE33q/MUxEC+iEv/nU1m+ek6+Kfkk/atDkh3q2WGu9Gw+MfFCts3jnBf1yX6cS0p89e295nOgHpIX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" title="plot of chunk COOLpic" alt="plot of chunk COOLpic" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
</code></pre>

<p>The previous code shows the distributions of two such random samples with sample means \( \bar{x}_1 = \) 22.9403, \( \bar{x}_2 = \) 25.1794 and standard deviations \( s_1 = \) 5.9322, \( s_2 = \) 6.6413, respectively.  Based on the graphs above, we can see that the bootstrap distribution has roughly the same spread and shape as the theoretical sampling distribution, but the centers are different.  This example illustrates some important features of the bootstrap that hold for other statistics besides the mean:  the bootstrap distribution of a particular statistic \( \hat{\theta} \) has approximately the same spread and shape as the sampling distirubiton of the statistic \( \hat{\theta} \), but the center of the bootstrap distirbution is at the center of the original sample.  Hence we do not use the center of the bootstrap distribution in its own right, but we do compare the center of the bootstrap distribution with the observed statistic; if they differ, it indicates bias.</p>

<blockquote>
<h4>BOOTSTRAP DISTRIBUTIONS AND SAMPLING DISTRIBUTIONS</h4>

<p>For most statistics, bootstrap distributions aproximate the spread, bias, and shape of the actual sampling distribution.</p>
</blockquote>

<ul>
<li>Example 2: We now consider an example where neither the population nor the sampling distribution is normal.  A random variable \( X \) that has a Gamma distribution is written \( X \sim \Gamma(\alpha, \lambda) \).  If \( X \) is a Gamma random variable, then \( E[X] = \alpha/\lambda \), and \( Var[X] = \alpha/\lambda^2 \).  Let \( X_1,\ldots , X_n \sim \Gamma(\alpha, \lambda) \). It is a fact that the sampling distribution of the mean \( \bar{X} \) is \( \Gamma(n\alpha, n\lambda) \).  We draw a random sample of size \( n = 16 \) from a \( \Gamma(\alpha = 1, \lambda = 1/2) \) (population mean 2, standard deviation 2). </li>
</ul>

<pre><code class="r">opar &lt;- par(no.readonly = TRUE)
set.seed(18)
par(mfrow = c(3, 2))
curve(dgamma(x, 1, 1/2), from = 0, to = 8, col = &quot;blue&quot;, main = &quot;Gamma(1, 1/2)&quot;, ylab = &quot;&quot;, xlab = &quot;&quot;)
abline(v = 2, col = &quot;red&quot;)
curve(dgamma(x, 16, 8), from = 0, 8, col = &quot;blue&quot;, main = &quot;Gamma(16, 8)&quot;, ylab = &quot;&quot;, xlab = &quot;&quot;)
abline(v = 2, col = &quot;red&quot;)
rsg1 &lt;- rgamma(16, 1, 1/2)
rsg2 &lt;- rgamma(16, 1, 1/2)
hist(rsg1, xlab = &quot;&quot;, main = &quot;n = 16&quot;, xlim = c(0, 8))
abline(v = mean(rsg1), col = &quot;red&quot;)
B &lt;- 10000
my.boot.statg1 &lt;- numeric(B)
my.boot.statg2 &lt;- numeric(B)
for (i in 1:B) {
    xg1 &lt;- sample(rsg1, size = 16, replace = TRUE)
    xg2 &lt;- sample(rsg2, size = 16, replace = TRUE)
    my.boot.statg1[i] &lt;- mean(xg1)
    my.boot.statg2[i] &lt;- mean(xg2)
}
hist(my.boot.statg1, breaks = &quot;Scott&quot;, main = &quot;Bootstrap Distribution&quot;, freq = FALSE, xlab = &quot;&quot;, xlim = c(0, 
    8))
abline(v = mean(rsg1), col = &quot;red&quot;)
hist(rsg2, xlab = &quot;&quot;, main = &quot;n = 16&quot;, xlim = c(0, 8))
abline(v = mean(rsg2), col = &quot;red&quot;)
hist(my.boot.statg2, breaks = &quot;Scott&quot;, main = &quot;Bootstrap Distribution&quot;, freq = FALSE, xlab = &quot;&quot;, xlim = c(0, 
    8))
abline(v = mean(rsg2), col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAArlBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j9plAABlADllAGVlOTllOY9lZgBlZrVltbVltdpltf2POQCPOTmPOWWPZmWPZo+Pj2WPj9qPtY+P29qP2/21ZgC1Zjm1ZmW1j4+124+12/21/rW1/v3ajznatbXa/rXa/tra/v39tWX924/927X9/rX9/tr9/v3/AACYrUGYAAAAOnRSTlP//////////////////////////////////////////////////////////////////////////wD/iebt9QAAAAlwSFlzAAALEgAACxIB0t1+/AAAFg5JREFUeJztnQ1727a5hkfZzbGSdKdWO8+d7MZdIzndZrZH0ij6//+xA5ASxW8CFEF8PM99pakigR8vb+IlBELgX1ICyV9s7wCxA8WDQvGgUDwoFA8KxYNC8aBQPCgUDwrFg0LxoFA8KBQPCsWDQvGgUDwos4hPVlG02AyV2t6n6eHjpVj2+vDX/3uKors0vjO6hybRjH4vwz2/aS70OcQnKxFUfPM2UOrHTXpYXo5Q/np/JxZMVuvDp4HFnUUzeiG/OPv3C/naTOhziD9HLU/9D7t48Tn6n6fyi/z9/c3b4eNvRY0/vd6uswXX4s8Me2oCzej3pVMkPwnMhD6L+A+7o8jXcvfFORwvNvtofViuixen9z/smqk++UkchuPTnfjvfoY9NYFm9HFUSvV7uZyZ0OcQn53E8rzdyoudqAEyhYnQzy/y97dt4g9/3eW5Usr3E83o99mVrVhUvDYT+jzXeLHncbQWwe3bQj+93yY+vs+9e1zjNaMXV/RCvCgjCvhb41OZ6kT+Eonru1LExYv8/axmZKGf5Iv/H583skKIhOfvNV4zepnr787HIGvV+3uNV0O2a3NeW777+NuqV+MSfU7pGPjbqldke8pohx9aPvT4e7wa20o+Lx8Df7/HEweheFAoHhSKB4XiQaF4UCgeFIoHheJBoXhQKB4UigdFUXw0gvcxC5lD+ZDE0c+rqHTLZMzG3I9dVbzyYbvwPmIZcyhHkDym397kH+0lS7gfO8XXycQff6H4tJwsbjU2537w7TRSve6mbn2I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" title="plot of chunk cool2" alt="plot of chunk cool2" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
</code></pre>

<p>The first graph in the second and third rows shows the distribution of a random sample with sample means and standard deviations \( \bar{x}_1 = \) 1.5387, \( \bar{x}_2 = \) 2.3165, \( s_1 = \) 1.6062, and  \( s_2 = \) 1.9916,  respectively.  Based on the graphs above, we can see that the bootstrap distribution has roughly the same spread and shape as the theoretical sampling distribution, but the centers are different. </p>

<h4>For most common estimators and under fairly general distribution assumptions, the following need to be noted:</h4>

<ul>
<li><p><em>Center</em> The center of the bootstrap distribution is <em>not</em> an accurate approximation for the center of the sampling distribution.  For example, the center of the bootstrap distribution for \( \bar{X} \) is centered at approximately \( \bar{x} = \mu_{\hat{F}} \), the mean of the sample, wheras the sampling distribution is centered at \( \mu \).</p></li>
<li><p><em>Spread</em> The spread of the bootstrap distribution does reflect the spread of the sampling distribution.</p></li>
<li><p><em>Bias</em> The bootstrap bias estimate does reflect the bias of the sampling distribution.  Bias occurs if a sampling distribution is not centered at the parameter</p></li>
<li><p><em>Skewness</em> The skewness of the bootstrap ditribution does relfect the skewness of the sampling distribution.</p></li>
</ul>

<p>The first point bears emphasis.  It means that <em>the bootstrap is not used to get better paramter estimates</em> because the bootstrap distributions are centered around statistics \( \hat{\theta} \) calculated from the data rather than unknown population values.  Drawing thousands of bootstrap observations from the original data is not like drawing observations from the underlying population, it does not create new data. </p>

<p>Instead, the bootstrap distribution is useful for <em>quantifying the behavior of a parameter estimate</em>, such as its standard error, skewness, bias, or for calculating confidence intervals.</p>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/Bangladesh.csv&quot;
Bang &lt;- read.csv(file = url(site))  # read data into Bang
</code></pre>

<ul>
<li>Example 3: Arsenic is a naturally occurring element in the groundwater of Bangladesh. However, much of this groundwater is used for drinking water by rural populations, so arsenic poisoning is a serious health issue. Figure 6a displays the distribution of arsenic concentrations from 271 wells in Bangladesh. The sample mean and standard deviation are \( \bar{x}= \) 125.3199 and s = 297.9755, respectively (measured in micrograms per liter). We draw resamples of size 271 with replacement from the data and compute the mean for each resample. Figures 7a and 7b show a histogram and a normal quantile plot of the bootstrap distribution, respectively. The bootstrap distribution looks quite normal, with some skewness. This is the central limit theorem at work&mdash;when the sample size is large enough, the sampling distribution for the mean is approximately normal, even if the population is not normal.</li>
</ul>

<pre><code class="r">opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(2, 2))
Arsenic &lt;- Bang$Arsenic
hist(Arsenic, breaks = &quot;Scott&quot;, main = &quot;Figure 6a&quot;, col = &quot;lightblue&quot;)
qqnorm(Arsenic, main = &quot;Figure 6b&quot;)
qqline(Arsenic, col = &quot;red&quot;)
B &lt;- 10000
n &lt;- sum(!is.na(Arsenic))
arsenic.mean &lt;- numeric(B)
set.seed(7)
for (i in 1:B) {
    x &lt;- sample(Arsenic, size = n, replace = TRUE)
    arsenic.mean[i] &lt;- mean(x)
}
hist(arsenic.mean, main = &quot;Figure 7a&quot;, col = &quot;lightblue&quot;, breaks = &quot;Scott&quot;, xlab = substitute(paste(bar(X), 
    &quot;*&quot;)))
qqnorm(arsenic.mean, main = &quot;Figure 7b&quot;)
qqline(arsenic.mean, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAtFBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZrU5AAA5ADk5AGU5OQA5OTk5OWU5OY85ZmU5ZrU5j9plAABlADllAGVlOTllOY9lZgBlZjllZmVlZrVltdpltf2POQCPOTmPOWWPZo+Pj7WPtY+P29qP2/2t2Oa1ZgC1Zjm1ZmW1jzm1j4+1tWW124+1/rW1/tq1/v3ajznaj2XatWXa29ra/rXa/tra/v39tWX924/9/rX9/tr9/v3/AABUdaTwAAAAPHRSTlP/////////////////////////////////////////////////////////////////////////////AP8FrvlYAAAACXBIWXMAAAsSAAALEgHS3X78AAAaKUlEQVR4nO2dD3vbNpLGF9ZaTpsmkTb1trtyunt16N5eU/N2faYo+vt/ryMASqJEDAiAAAhw5m2epDb+EMOfBhhCAPinhoRSf5q7AaR5ROCRisAjFYFHKgKPVAQeqQg8UhF4pCLwSEXgkYrAIxWBRyoCj1QEHqkIPFIReKQi8EhF4JGKwCMVgUeq2OAr1mpXsZ0+W71lbBOnRfFkZXsV2P744EfMFjo8rJvi5jF4a+LKyvZlgud/l+zm+9Uzt69YPdfbP9/dPO7vmKS9v5O3qGRLcnwr2yv28S6k7bOB399t6m3P+NVza7L4f55+833bKTb7d4/dLxYhK9srdvtaGnURbppjjL99bY0vbwTUk/Hr1r/bX8mbU/Lfcgdosy+nx7eynSfyT0Mozebx3NLyynge/IjurRIf+dYzVs8LGuqtbOf/iJRAmhW84lMvxce5c57ITQwmK9sX6/HdONf9I4zndsobICLb1XM7xtXbBXq8ie1ijA9o+5xR/eqvrTcX4h/ZqfFBUIYz7bNsa/ThgbGfAwY4kWVl+9Ki+gsVt69zXn5WzW37bODb59YFBex2SsF2mqtHKgKPVAQeqQg8UhF4pCLwSEXgkYrAIxWBRyoCj1QEHqkIPFIReKQi8EhF4JGKwCMVgUcqAm8jlp1AUwi8jeD7mKgIvB8ReKTKB3zXyRN4P8oGPOva6h+8aQyxLGVjZ0DwX/vK5oZMVOp2nj0wWFdP4BMUG7SQwPtR4nYS+FBK3c5BsEXg/Sg7Owm8H2Vn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" title="plot of chunk Bang2" alt="plot of chunk Bang2" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
</code></pre>

<p>The mean of the bootstrap means is 125.4621, quite close to the sample mean \( \bar{X} \) (the difference is 0.1422, to four decimal places). The bootstrap standard error is the standard deviation of the bootstrap distribution; in this case, the bootstrap standard error is 17.9848.</p>

<pre><code class="r">BELOW &lt;- sum(arsenic.mean &lt;= (mean(arsenic.mean) + qnorm(0.025) * sd(arsenic.mean)))/B
ABOVE &lt;- sum(arsenic.mean &gt;= (mean(arsenic.mean) + qnorm(0.975) * sd(arsenic.mean)))/B
c(BELOW, ABOVE)
</code></pre>

<pre><code>[1] 0.0147 0.0311
</code></pre>

<p>For the normal distribution, we know that the 2.5 and 97.5 percentiles are at the mean plus or minus 1.96 standard deviations. But for this particular bootstrap distribution, we find that 1.47% of the resample means are below the bootstrap mean -1.96 standard errors, and 3.11% of the resample means are above the bootstrap mean +1.96 standard errors. In this case, relying on the CLT would be inaccurate.</p>

<p>BOOTSTRAP PERCENTILE INTERVALS</p>

<p>The sample mean \( \bar{x} \) gives an estimate of the true mean \( \mu \), but it probably does not hit it exactly. It would be nice to have a range of values for the true \( \mu \) that we are 95% sure includes the true \( \mu \).</p>

<p>In the North Carolina birth weights case study, the bootstrap distribution shows roughly how sample means vary for samples of size 1009. If most of the sample means are concentrated within a certain interval of the bootstrap distribution, it seems reasonable to assume that the true meaning is most likely somewhere in that same interval. Thus, we can construct what is called a 95% confidence interval by using the 2.5 and 97.5 percentiles of the bootstrap distribution as endpoints. We would then say that we are 95% confident that the true mean lies within this interval. These are bootstrap percentile confidence intervals.</p>

<blockquote>
<p>BOOTSTRAP PERCENTILE CONFIDENCE INTERVALS  </p>

<p>The interval between 2.5 and 97.5 percentiles of the bootstrap distribution of a statistic is a 95% <em>bootstrap percentile confidence interval</em> for the corresponding parameter.</p>
</blockquote>

<pre><code class="r">quantile(my.boot.statB, probs = c(0.025, 0.975))
</code></pre>

<pre><code> 2.5% 97.5% 
 3417  3479 
</code></pre>

<p>For the North Carolina birth weights, the interval marked by the 2.5 and 97.5 percentiles is (3417.4202, 3478.9063). Thus, we would state that we are 95% confident that the true mean weight of North Carolina babies born in 2004 is between 3417.4202 and 3478.9063 g. In the arsenic example, the 2.5% and 97.5% points of the bootstrap distribution give us the interval (92.8419, 162.8321), so we are 95% confident that the true mean arsenic level is between 92.8419 and 162.8321 \( \mu g/L \). Note that with \( \bar{X}^* = \) 125.4621, this interval can be written (125.4621 -32.6203, 125.4621 + 37.37); in particular, this interval is not symmetric about the mean, reflecting the asymmetry of the bootstrap distribution.</p>

<p>The arsenic data illustrate an interesting point. A good confidence interval for the mean need not necessarily be symmetric: an endpoint will be further from the sample mean in the direction of any outliers. A confidence interval is an insurance policy: rather than relying on a single statistic, the sample mean, as an estimate of \( \mu \), we give a range of possible values for \( \mu \). We can see that there are some extremely large arsenic measurements: of the 271 observations, 8 are above 1000 \( \mu g/L \) and 2 are above 2200 \( \mu g/L \) (remember, the sample mean is only 125.3199!). What we do not know is just how huge arsenic levels in the population can be, or how many huge ones there are. It could be that huge observations are underrepresented in our data set. In order to protect against this  that is, to have only a 2.5% chance of missing a true big mean, the interval of plausible values for \( \mu \) must stretch far to the right. Conversely, there is less risk of missing the true mean on the low side, so the left endpoint need not be as far away from the mean.</p>

<h4>TWO SAMPLE BOOTSTRAP</h4>

<p>We now turn to the problem of comparing two samples. In general, bootstrapping should mimic how the data were obtained. So the data correspond to independent samples from two populations, we should draw to samples that way. Then we proceed to compute the same statistic comparing the samples as per the original data, for example, difference in means or ratio of proportions.</p>

<blockquote>
<p>BOOTSTRAP FOR COMPARING TWO POPULATIONS</p>

<p>Given independent samples of sizes m and n from two populations,</p>

<ol>
<li>Draw a resample of size \( m \) with replacement from the first sample in a separate resample of size \( n \) for the second sample. Compute a statistic that compares the two groups, such as the difference between the two sample means.</li>
<li>Repeat this resampling process many times say 10,000.</li>
<li>Construct the bootstrap distribution of the statistic. Inspect its spread, bias, and shape.</li>
</ol>
</blockquote>

<ul>
<li>Example 4: A high school student was curious about the total number of minutes devoted to commercials during any given half-hour time period on basic and extended cable TV channels.</li>
</ul>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/TV.csv&quot;
TV &lt;- read.csv(file = url(site))  # read data into TV
head(TV)
</code></pre>

<pre><code>  ID Times Cable
1  1   7.0 Basic
2  2  10.0 Basic
3  3  10.6 Basic
4  4  10.2 Basic
5  5   8.6 Basic
6  6   7.6 Basic
</code></pre>

<pre><code class="r">ct &lt;- tapply(TV$Times, TV$Cable, mean)
ct
</code></pre>

<pre><code>   Basic Extended 
    9.21     6.87 
</code></pre>

<p>The means of the basic and extended channel commercial times or 9.21 and 6.87 min., respectively, so on average, commercials on basic channels are 2.34 min. longer than on extended channels. Is this difference of 2.34 min. statistically significant? The poor student could only stand to watch 10 hours of random TV, so his observations may not accurately represent the TV universe.</p>

<p>The original data are simple random samples of size 10 from two populations. We draw a bootstrap sample from the basic channel data and independently draw a bootstrap sample from the extended channel data, compute the means for each sample, and take the difference.</p>

<pre><code class="r">times.Basic &lt;- subset(TV, select = Times, subset = Cable == &quot;Basic&quot;, drop = TRUE)
times.Ext &lt;- subset(TV, select = Times, subset = Cable == &quot;Extended&quot;, drop = TRUE)
B &lt;- 10^4
times.diff.mean &lt;- numeric(B)
set.seed(5)
for (i in 1:B) {
    Basic.sample &lt;- sample(times.Basic, size = length(times.Basic), replace = TRUE)
    Ext.sample &lt;- sample(times.Ext, size = length(times.Ext), replace = TRUE)
    times.diff.mean[i] &lt;- mean(Basic.sample) - mean(Ext.sample)
}
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
hist(times.diff.mean, breaks = &quot;Scott&quot;, freq = FALSE, main = &quot;Bootstrap Distribution \n (Figure 8a)&quot;, 
    xlab = substitute(paste(bar(x)[1], &quot;*&quot;, -bar(x)[2], &quot;*&quot;)), col = &quot;lightblue&quot;)
qqnorm(times.diff.mean, main = &quot;Normal Q-Q Plot \n (Figure 8b)&quot;)
qqline(times.diff.mean, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAAq1BMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlZgBlZjllZmVlZrVltbVltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/2t2Oa1ZgC1Zjm1tWW124+1/rW1/v3ajznatWXa24/a/rXa/tra/v39tWX9tY/924/929r9/rX9/tr9/v3/AAClZl6tAAAAOXRSTlP/////////////////////////////////////////////////////////////////////////AP+Eine/AAAACXBIWXMAAAsSAAALEgHS3X78AAAR+klEQVR4nO2dCXvjthGGQ2/iWNm4lXI0rbXpEZvdZNVspKoS/f9/WYHBwUPAECRx0ZjvSdYSQYIzeIXBQZD8oiEVqS9SG0BKIwJfqAh8oSLwhYrAFyoCX6gIfKEi8IWKwBcqAl+oCHyhIvCFisAXKgJfqAh8oSLwhWoR+Muu4ro/GlPrJ9sXW0ZP/NO7T4aj+Obrvpukd+gfkVjMEWayyVLjzmq3675fjL3vunAGnuJFOiYf4M3k6+rJ8sWe0RbJwlScI9nGF3OEFcZU8OcNeH/3LBP632Xh3D0PKsUy3xeC55aIfw+Km/gAv9kHcIHXVf7lur/7CzP/JFxihfORp3UyOrGv8On2qH+JGv+x0uV62d3/ATv0Tt/LNYE4pK0Er03iDvyj+nrP7DpAWJNFoEAyRx8aTlJWoMF35umRf9t2PZXlO19ewDPDavhVPjTqw1VCgYDwx15vuv8sNh3hW6V9gyJgP2L+yXiU/CGIQ2/Aq9PLfZaUyCIxY36UjVLPpPv/VErav6MCf95AKbBfiKjig+998L3yXWCpj1DP7Dtv4Bd896w/QCiSLoi4JH/IjWqx2e9WNIka/EGANxzVOeLuWYE/wg7iCHlW2Odk63WEFzPm182WG9g16UFEMxbInqBopMcK/EmWiwreg++9UN8v3wXy0sa/+yRsZeD0BwmlEoFXIFQ+i0Au4tZWbOqCNxzVdu7Ytlvw+qywt6giScSNqe9+2Q9NApjCCeFOVRnB80aORQcDeNk09Mt3gTyEem6CBbzopsifp/BZdFzM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" title="plot of chunk TIMES1" alt="plot of chunk TIMES1" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
CI &lt;- quantile(times.diff.mean, prob = c(0.025, 0.975))
CI
</code></pre>

<pre><code> 2.5% 97.5% 
 0.85  3.81 
</code></pre>

<p>Figure 8a shows the bootstrap distribution of the difference of sample means. As in the single sample case, we see that the bootstrap distribution is approximately normal and centered at the original statistics (the difference in sample means). We also get a quick idea of how much the difference in sample means varies due to random sampling. We may quantify this variation by computing the bootstrap standard error, which is 0.7553. Again, the bootstrap standard error is the standard error of the sampling distribution.</p>

<p>The right panel of Figure 8b shows a normal-quantile plot for the bootstrap distribution: the distribution is very close to normal.</p>

<p>The 95% bootstrap percentile confidence interval for the difference in means (basic  extended) is (0.85, 3.81). Thus, we are 95% confident that commercial times on basic channels are, on average, between 0.85 and 3.81 min. longer than on extended channels (perhalf-hour time periods).</p>

<p>We can also conduct a permutation test of the hypothesis that the mean commercial times for the two cable options are the same versus the hypothesis that mean times are not. Figure 9a shows the permutation distribution for the difference in mean advertisement time between basic and extended TV channels.</p>

<pre><code class="r">obsDIFF &lt;- mean(times.Basic) - mean(times.Ext)
P &lt;- 10^4
times.diff.meanP &lt;- numeric(P)
set.seed(4)
for (i in 1:P) {
    index &lt;- sample(length(TV$Times), size = length(TV$Times[TV$Cable == &quot;Basic&quot;]), replace = FALSE)
    times.diff.meanP[i] &lt;- mean(TV$Times[index]) - mean(TV$Times[-index])
}
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
hist(times.diff.meanP, breaks = &quot;Scott&quot;, freq = FALSE, main = &quot;Randomization Distribution \n (Figure 9a)&quot;, 
    xlab = substitute(paste(bar(x)[1], &quot;*&quot;, -bar(x)[2], &quot;*&quot;)), col = &quot;lightblue&quot;)
abline(v = obsDIFF, col = &quot;red&quot;)
qqnorm(times.diff.meanP, main = &quot;Normal Q-Q Plot \n (Figure 9b)&quot;)
qqline(times.diff.meanP, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAAqFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlZgBlZjllZmVlZrVltbVltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/2t2Oa1ZgC1Zjm1tWW124+1/rW1/v3ajznatWXa24/a/rXa/tra/v39tWX9tY/924/929r9/rX9/tr9/v3/AACH6YuNAAAAOHRSTlP///////////////////////////////////////////////////////////////////////8A/4V6AzUAAAAJcEhZcwAACxIAAAsSAdLdfvwAABGGSURBVHic7Z0Jn+OmGYej2WRiZ7P1ZJOmndle8apJ1s3uqK6t+f7frOIUyIC4QcP7/81hC4GARy+XEHw1gprUV6UjACojAN+oAHyjAvCNCsA3KgDfqAB8owLwjQrANyoA36gAfKMC8I0KwDcqAN+oAHyjAvCNygX85aFDevNJ637/rHFQ+Okf1cfFSz0u/U6e5iCvT7fejaGm1xTvKYaqiClPZqddn6bECpknfed5sUgYzwsveYDvNHj14FXqO1O82aUOJk+K/DWHml5TvKc8cAV/3uPE3h2pg/yd5sXdcWEDYUl1A48ujP8OJF5TCn8lRQC6R/+KwZ8Ir6H79mlyObFbdaAgiU98S+9IgNTDHBa/1DB9xZ9QTiALR56uT3d/7u7+RSz+145n9HTbfVkJNb0QpAMFz2OA4vsPITtY7jGQU7p2IyJJ7WbxndhT3x3EhJG8CIipH3hyE94/48ujCNAPUwx7eoSAJlUDB899Coh6OYidcCl0VwuX+0LBo8+fH+iNQKJxA14ZanpN1/6J1kFSDO7/I2UHiTYDf95jwtMdQkx88V0GT4PNDL5bsJkuj2z4/vm8n+J0wh/wrXx3RNY6Geoj+kxTeKKFE00AKQm4Bx4WPwX7IOdQW0CeiD3wqxOvBPzzSqjpNV37t/0BxUeMwY4UXiw7WAIZ+IHmKCu8F9+lop4Hm7eoZy0u8hllPY7G/fNAYNAPCBj6QOgw8Of9bvbJEXEPPCyWLyMHjy+MDhDwKOvmxl2PvC7Bq0NNL3Tt/u6Xp2UMRjE7WB4owKM6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" title="plot of chunk TIMES2a" alt="plot of chunk TIMES2a" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
pvalue &lt;- (sum(times.diff.meanP &gt;= obsDIFF) + 1)/(P + 1)
</code></pre>

<p>Recall that in permutation testing, we sample <em>without</em> replacement from the pooled data. The permutation distribution corresponds to sampling in a way that is consistent with the null hypothesis that the population means are the same. Thus, the permutation distribution is centered at zero. But in bootstrapping, we sample <em>with</em> replacement from the individual sample. However, the bootstrap has no restriction in regard to any null hypothesis, so it&#39;s distribution is centered at the original difference in means.</p>

<p>The permutation distribution is used for a single purpose: calculate a <em>p</em>-value to see how extreme an observed statistic is if the null hypothesis is true. The bootstrap is used for estimating standard errors and for answering some other questions we will raise below.</p>

<p>The permutation test for this example results in a <em>p</em>-value of 0.0042; thus, we conclude that the main commercial times are not the same between the two types of cable TV channels.</p>

<ul>
<li>Example 5: Verizon is the primary local telephone company (incumbent local exchange carrier, ILEC) for a large area of the eastern United States.  As such it is responsible for providing repair service for the customers of other telephone companies known as competing local exchange carriers (CLECs) in this region.  Verison is subject to fines if the repair times (the time it takes to fix a problem) for CLEC customers are substantially worse than those for Verizon customers.  The data set <code>Verizon</code> contains a random sample of repair times for 1664 ILEC and 23 CLEC customers. </li>
</ul>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/Verizon.csv&quot;
Phone &lt;- read.csv(file = url(site))
rt &lt;- tapply(Phone$Time, Phone$Group, mean)
rt
</code></pre>

<pre><code>  CLEC   ILEC 
16.509  8.412 
</code></pre>

<pre><code class="r">times.ILEC &lt;- subset(Phone, select = Time, subset = Group == &quot;ILEC&quot;, drop = TRUE)
B &lt;- 10^4
ILECmean &lt;- numeric(B)
set.seed(3)
for (i in 1:B) {
    ILECmean[i] &lt;- mean(sample(times.ILEC, size = length(times.ILEC), replace = TRUE))
}
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
hist(ILECmean, breaks = &quot;Scott&quot;, col = &quot;lightblue&quot;, main = &quot;Bootstrap Distribution \n Figure 10a&quot;, freq = FALSE, 
    xlab = substitute(paste(bar(x), &quot;*&quot;)))
qqnorm(ILECmean, main = &quot;Normal Q-Q Plot \n Figure 10b&quot;)
qqline(ILECmean, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAAqFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OTk5OWU5OY85j485j7U5j9plAABlADllAGVlOQBlZgBlZjllZmVltbVltf2POQCPOTmPOWWPZgCPjzmPj2WP27WP29qP2/2t2Oa1ZgC1tWW124+1/rW1/v3ajznatWXa24/a/rXa/tra/v39tWX9tY/924/929r9/rX9/tr9/v3/AADYwUu7AAAAOHRSTlP///////////////////////////////////////////////////////////////////////8A/4V6AzUAAAAJcEhZcwAACxIAAAsSAdLdfvwAABEwSURBVHic7Z0Je+O2EYZDb6LI2WZbKZs0td0rXm5iNRupqgT//39WnLwMgkPiGgrzPYlXEghygJczOAiSXzFSkfoqtwGkPCLwhYrAFyoCX6gIfKEi8IWKwBcqAl+oCHyhIvCFisAXKgJfqAh8oSLwhYrAFyoCX6i8wF/2ldDmaE2tH8a+jO3oQXx692LJJX6+PnaTmg36OTKLF4SbbLPUurHZ7PrYr8be96ZyBiV1V+mUQoC3k6+rh5Ev4zvaOXZhq86J3aYXLwivjLngz/ey9HfPOqH/XVfO3fPAKfzK7gleWKL+Hgw39UGes1tZBOGr4sv18e6v3PyTKhKvnM8irbOjE/8qP73N9W/l8Z+rpl4v+80fcoPe4Xt7zSABaafBNyaJAvyr+vaR23WQYU1XgQHJC7plgqR2oMF3XtKj+LbrllTX73IFAc8Nq+VZuWXmw1VDkQHhj8fmp80X9dNRfquasskq4Cex+GTNpU8ElfUNeHN4vY1PjXiJG/OTbpR6Jm3+Uxk15Tsa8Od7WQv8DFEuPvjeB9+rXw9LQ4R6bt/5Xp7Bd8/NBxmKdBFUXNInMjMtNj9vVZPYgD8o8JZcnRx3zwb8UW6gcuijym1OY72O+OLG/Hq/EwZ2TdqqaMYD2YOsGl1iA/6k68UE78H3Xqjv16+HgrTx716UrRxc80FDqVTgVQhNmVUgV3Frp37qgrfkajt3/Le34Jujyq2Vi2SRMKa+++VxaJKEqQqhilNVVvCikePRwQJeNw39+vVQgFAvTBgBr7op+vRUZVYdFzt4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" title="plot of chunk Phone1" alt="plot of chunk Phone1" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
CI &lt;- quantile(ILECmean, prob = c(0.025, 0.975))
CI
</code></pre>

<pre><code> 2.5% 97.5% 
7.723 9.123 
</code></pre>

<p>The bootstrap distribution for the larger ILEC data set (\( n = \) 1664) is shown in Figure 10a. The distribution is centered around the sample mean of 8.4077, has a relatively narrow spread primarily due to the large sample size, with the bootstrap standard error of 0.3566 and a 95% bootstrap percentile interval of (7.7225, 9.1232). The distribution is roughly symmetric, with little skewness.</p>

<pre><code class="r">times.CLEC &lt;- subset(Phone, select = Time, subset = Group == &quot;CLEC&quot;, drop = TRUE)
B &lt;- 10^4
CLECmean &lt;- numeric(B)
set.seed(2)
for (i in 1:B) {
    CLECmean[i] &lt;- mean(sample(times.CLEC, size = length(times.CLEC), replace = TRUE))
}
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
hist(CLECmean, breaks = &quot;Scott&quot;, col = &quot;lightblue&quot;, main = &quot;Bootstrap Distribution \n Figure 11a&quot;, freq = FALSE, 
    xlab = substitute(paste(bar(x), &quot;*&quot;)))
qqnorm(CLECmean, main = &quot;Normal Q-Q Plot \n Figure 11b&quot;)
qqline(CLECmean, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAAqFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OTk5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlZgBlZjllZmVltbVltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/2t2Oa1ZgC1tWW124+1/rW1/v3ajznatWXa24/a/rXa/tra/v39tWX9tY/924/929r9/rX9/tr9/v3/AADNcYLnAAAAOHRSTlP///////////////////////////////////////////////////////////////////////8A/4V6AzUAAAAJcEhZcwAACxIAAAsSAdLdfvwAABF1SURBVHic7Z2Jgtu2EYbDdaJIceNWGydNtU7TRivHVuOsqkrc93+z4qQIEgQHIE5hfh86CEIDfpwBQALgVy2qSn2V2gBUGiH4SoXgKxWCr1QIvlIh+EqF4CsVgq9UCL5SIfhKheArFYKvVAi+UiH4SoXgKxWCr1SLwF8eG6rVi3brYTf1YSqjHX335rNmL/r19am/qUug7pFYpCDEZJ2l2sQy2fVJPYzK5+7gDEpqPqRz8gFeT/7Q7CY+TGe0NWShO5wz2cYXKQg5GLbgzxtW+oe92KB+FgfnYT9wimVlXwieWsL/P0pu/A07Z9esCNRX6Yfr08PfifknXiRycD7Sbb2MTuQjezfe69/c4z823XG9PK7+ZAmUn1dyTSAKaSvAdybRAvzafPtE7DqysCYOgQRJCrpuKUnhQIPPpKQv9NO2X1JxfN3lBTwx7MDOynUr31wFFBYQ/nzqvlp94V+9sE9NVzZ2CMhJTN9p9xInAt91BF7+vEiz5IgsEjHmJ1EpKSat/tNIdeV7keDPG3YUyBnCXXzwWQWvHN8FlvoI9cS+84adwQ/77g0LRaIIPC6JE7mVNTY5b3mV2IE/cvCavXp7POwl+BeWgO8hfpWlOU21OsKLGPP7ZksN7Ju05tGMBLIdOzSixBL8SRwXGbwHn5VQrx7fBfJSx7/5zG0l4Lo3AkrDAy9HKMvMAzmPW1v+VR+8Zq9b4458Nwbf/SpLzV0kiagxh4ffnoYmMZi8ELw4TaMFTys5Eh004EXVoB7fBfIQ6qkJE+B5M0WcnrzMvOGi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" title="plot of chunk Timesb2" alt="plot of chunk Timesb2" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
CIC &lt;- quantile(CLECmean, prob = c(0.025, 0.975))
CIC
</code></pre>

<pre><code> 2.5% 97.5% 
10.10 25.39 
</code></pre>

<p>The bootstrap distribution for the smaller CLEC data set (\( n = \) 23) is shown in Figure 11a. The distribution is centered around the sample mean of 16.532, has a much larger spread due to the small sample size, with the bootstrap standard error of 4.0093 and a 95% bootstrap percentile interval of (10.1039, 25.3941). The distribution is very skewed.</p>

<pre><code class="r">B &lt;- 10^4
diffmeans &lt;- numeric(B)
set.seed(1)
for (i in 1:B) {
    ILEC.sample &lt;- sample(times.ILEC, size = length(times.ILEC), replace = TRUE)
    CLEC.sample &lt;- sample(times.CLEC, size = length(times.CLEC), replace = TRUE)
    diffmeans[i] &lt;- mean(ILEC.sample) - mean(CLEC.sample)
}
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
hist(diffmeans, breaks = &quot;Scott&quot;, col = &quot;lightblue&quot;, main = &quot;Bootstrap Distribution \n Figure 12a&quot;, freq = FALSE, 
    xlab = substitute(paste(bar(x)[1], &quot;*&quot;, -bar(x)[2], &quot;*&quot;)))
qqnorm(diffmeans, main = &quot;Normal Q-Q Plot \n Figure 12b&quot;)
qqline(diffmeans, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAAq1BMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OTk5OWU5OY85j485j9plAABlADllAGVlOQBlZgBlZjllZmVlZrVltbVltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/2t2Oa1ZgC1Zjm1tWW124+1/rW1/v3ajznatWXa24/a/rXa/tra/v39tWX9tY/924/929r9/rX9/tr9/v3/AAAjpsogAAAAOXRSTlP/////////////////////////////////////////////////////////////////////////AP+Eine/AAAACXBIWXMAAAsSAAALEgHS3X78AAARcklEQVR4nO2dC5ujthWGw2wyGWebrWc3adrxtGnjcTcZms1Q18b//5dVVyywEAfdQed79mJASEe86EgCSXzVoorUV6kNQKURgi9UCL5QIfhCheALFYIvVAi+UCH4QoXgCxWCL1QIvlAh+EKF4AsVgi9UCL5QIfhC5QT+9FhR3b9pjx6exjbGInqiv969as6iu8879VAXoH9GYpGMEJN1lmoDy2DnXf8y9ra7izPIqfmSTskHeD35Q/U0sjEe0dYQhe5yTkQbXyQj5GLMBX/csNzf7cWB/ra4OHf7QaFwy7sjeGoJ/7eW3PgPds8+sCzQsko3zru7vxDzG54lcnE+02NKRA3ZZL9uz/oXL/Gfq+66nh7v/2ABesn3Yk0gCmkrwHcm0Qz8XH27I3bVzK2JSyBBkow+tJSkKECDbZLTN7q1VXMqrq+9vIAnhh3YXfnQyh9nAYU5hD923a77L3zXG9uquryxS0BuYvpLe5a4EfipN+Bl8iKMyxVxEjHmR1Ep9Uy6/08l1eXvTYI/bthVIHcIL+KD7T743vV1sNSHqyf2HTfsDr7bdz+YKxJZ4H5J3MitrLHJfcurxA58zcFrzlLOuNtL8G8sAD9DpMrCNGOtjvAixvy62VIDVZMeuDcjjuyJXRqRYwm+EddFOu/Bds/V96+vg7zU8e9eua0EXPdDQKm44+UIZZ65I+d+a8t3qeA1Z10bd2TfLfguVRaaF5EkosYc7n7ZDU1iMHkmeHaqSgueVnLEO2jAi6qhf30d5MHVUxNGwPNmirg9eZ55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" title="plot of chunk Times12ab" alt="plot of chunk Times12ab" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
CIdiff &lt;- quantile(diffmeans, prob = c(0.025, 0.975))
CIdiff
</code></pre>

<pre><code>   2.5%   97.5% 
-16.644  -1.596 
</code></pre>

<p>The bootstrap distribution for the difference in means is shown in Figure 12a. Note the strong skewness in the distribution. The mean of the bootstrap distribution is -8.111 with a standard error of 3.9468. A 95% bootstrap percentile confidence interval for the difference in means (ILEC-CLEC) is given by (-16.6445, -1.5959) and so we would say that with 95% confidence, the repair times for ILEC customers are, on average, 1.5959 \( - \) 16.6445 hours shorter than the repair times for CLEC customers.</p>

<h4>THE TWO INDEPENDENT POPULATIONS ASSUMPTION</h4>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/Cameras.csv&quot;
Cameras &lt;- read.csv(file = url(site))
head(Cameras)
</code></pre>

<pre><code>  ID                  Item     JR     BH
1  1 Canon PowerShot A3000 129.99 149.99
2  2  Canon PowerShot A495  99.88  96.95
3  3        Casio EX-FC150 241.88 241.19
4  4  Kodak EasyShare C142  74.94  79.59
5  5    Nikon Coolpix L110 279.95 239.95
6  6     Nikon Coolpix L22 129.95 129.95
</code></pre>

<p>Savvy customers will often compare prices at different stores before making a purchase. Are some stores really better bargains consistently than others? We compiled the prices of a sample of point-and-shoot digital cameras from two electronic stores with an online presence, J &amp; R and B &amp; H the mean price of the cameras was $155.42 at J &amp; R and $152.62 at B &amp; H. Does this imply cameras are more expensive at J &amp; R, or could the difference in mean price ($2.81) be chance variation? </p>

<p>Now, it may be tempting to proceed as in the TV commercials or Verizon repair times examples, looking at the prices as coming from two populations, B &amp; H and J &amp; R. But note that the data are <em>not independent</em>! For each camera priced at B &amp; H, we matched it with the price for the same camera at J &amp; R. Thus, the data are called <em>matched pairs or paired data</em>.</p>

<p>In this case, for each camera, we compute the difference in price between the two stores (J &amp; R price - B &amp; H price). We then have one variable &ndash; the price differences &ndash; and we are back to the onesample setting. The price differences are shown in Figure 13a.</p>

<pre><code class="r">CameraDiffs &lt;- Cameras$JR - Cameras$BH
B &lt;- 10^5
boot.diffs &lt;- numeric(B)
set.seed(2)
for (i in 1:B) {
    boot.diffs[i] &lt;- mean(sample(CameraDiffs, size = length(CameraDiffs), replace = TRUE))
}
CIdiff &lt;- quantile(boot.diffs, prob = c(0.025, 0.975))
CIdiff
</code></pre>

<pre><code>  2.5%  97.5% 
-4.896 10.585 
</code></pre>

<pre><code class="r">opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
hist(CameraDiffs, freq = FALSE, col = &quot;lightblue&quot;, main = &quot;Distribution of Price Differences \n Figure 13a&quot;, 
    xlab = &quot;Dollars&quot;)
abline(v = mean(CameraDiffs), col = &quot;red&quot;)
hist(boot.diffs, freq = FALSE, col = &quot;lightblue&quot;, main = &quot;Bootstrap Distribution of \n Price Differences \n Figure 13b&quot;, 
    xlab = substitute(paste(bar(D), &quot;*&quot;)))
abline(v = mean(boot.diffs), col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAAk1BMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OTk5OWU5OY85j9plAABlADllAGVlOQBlOY9lZjllZmVltbVltf2POQCPOTmPOWWPZgCPtY+P27WP29qP2/2t2Oa1ZgC1tWW1/rW1/tq1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/AADNAEbEAAAAMXRSTlP//////////////////////////////////////////////////////////////wD/obxc3gAAAAlwSFlzAAALEgAACxIB0t1+/AAADVtJREFUeJztnY12mzgWgIdkGrvdqdNmd8fJ/rluJ95OsE3e/+kG/QDCSEICSYh773d6GtsgIfEhIV3A/qUiUPLL0gUgloHEI4XEI4XEI4XEI4XEI4XEI4XE+3F5LBgPb9qlx73pjSmjPXt1/6pJxT6+PquL2hX6KfSct8XdwbKcxPshfenNH4u94Y05o50li0ojfiRb5/VIvB+isYn/T4038eL6XP/ZsKZWsLbK3lyf7/5RN7yyfl03v1rjd7ZMyais3/JXw1T/FS3+Oz/I+BFweXz4k6/Q23wv115ZDN2SgMT70Yivd+qRt9hN1by4Sim8Q/jzuf3o4af46I2/a3zI7rpumOyVNpU8EETSgfhm83KdjSifWhYSHxDZQ9ft97yt/7s83h3aF7x7PW/l/mZv6v2/adJxjTuWwb75oGINlIvXpFJS3B0a8W98BZFCbpWvU0rL/bLYIPF+NKfm+9eSO63FtS+klEJ0vEKhGGCxD5uh2kmcHvriNam6wV392VB8u1W+Nl9UsVOHWhYbJN6Proc2iOdn60I2OaGQf2IQL7t6TSp38c2iisTHo/Nl6Oo5R7nnhUKm+rzVdvXt4G6Y6qarrz8/FfquXhFPXX0suq5+MLjjLzZN8+ZvhMKyaFp8b3DXTOeExkGqizq4k9sQL24Hd4p4tSxTxaeKMHTbaXN1KQ9PPhalCE83uBtM53iVHt6YQ9nB14NwvmJtYyc65e/tWHtYnZtUF3U6x1f/ndllK/y8mc4p4tuyzBYfPcKg7kobN+XhyV23lQe6VrIYNvFpIgziYD0Wuy5XvlQOetu+oFeeP1jyD08iD7mS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" title="plot of chunk Camera1a" alt="plot of chunk Camera1a" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
</code></pre>

<p>Performing a one sample bootstrap with \( 10^5 \) resamples, we find a 95% bootstrap percentile interval for the mean price difference to be (-4.8964, 10.5846). Since zero is contained in the interval, we cannot conclude that the mean prices for digital point-and-shoot cameras differ between the two stores.</p>

<h4>OTHER STATISTICS</h4>

<p>As with permutation testing, when bootstrapping, we are not limited to simple statistics like the simple mean. Once we have drawn a bootstrap sample, we can calculate any statistic for that sample.</p>

<p>For example, instead of the sample mean, we can use more robust statistics that are less sensitive to extreme observations. Figure 14a shows the bootstrap distribution for the difference in trimmed means, in this case 25% trimmed means, also known as the mid-mean, the mean of the middle 50% of observations. Compared to the bootstrap difference in ordinary means (Figure 12a), this distribution has a much smaller spread. The bootstrap procedure may be used with a wide variety of statistics &ndash; means, medians, trimmed means, correlation coefficients, and so on &ndash; using the same procedure. This is a major advantage of the bootstrap. It allows statistical inferences such as confidence intervals to be calculated even for statistics for which there are no easy formulas. It offers hope of reforming statistical practice &ndash; away from simple but non-robust estimators like a sample mean or least-squares regression, in favor of robust alternatives.</p>

<pre><code class="r">B &lt;- 10^4
diffmeans.25 &lt;- numeric(B)
set.seed(3)
for (i in 1:B) {
    ILEC.sample &lt;- sample(times.ILEC, size = length(times.ILEC), replace = TRUE)
    CLEC.sample &lt;- sample(times.CLEC, size = length(times.CLEC), replace = TRUE)
    diffmeans.25[i] &lt;- mean(ILEC.sample, trim = 0.25) - mean(CLEC.sample, trim = 0.25)
}
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
hist(diffmeans.25, breaks = &quot;Scott&quot;, col = &quot;lightblue&quot;, main = &quot;Bootstrap Distribution \n Figure 14a \n 0.25 Trimmed Means&quot;, 
    freq = FALSE, xlab = substitute(paste(bar(x)[1], &quot;*&quot;, -bar(x)[2], &quot;*&quot;)))
qqnorm(diffmeans.25, main = &quot;Normal Q-Q Plot \n Figure 14b&quot;)
qqline(diffmeans.25, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAAulBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OTk5OWU5OY85ZmU5ZrU5j485j9plAABlADllAGVlOQBlZgBlZjllZmVlZrVlj49ltbVltf2POQCPOTmPOWWPZgCPjzmPj2WPtY+P27WP29qP2/2t2Oa1ZgC1Zjm1tWW124+1/rW1/v3ajznatWXa24/a/rXa/tra/v39tWX9tY/924/929r9/rX9/tr9/v3/AAAt1nBJAAAAPnRSTlP///////////////////////////////////////////////////////////////////////////////8A/wTdY8kAAAAJcEhZcwAACxIAAAsSAdLdfvwAABKmSURBVHic7Z0Lm6O2FYaDJ5nYSZtpYufaxp6kTdZLdzNudk1dW/P//1bRFYGFEOgKOt+zF4xACL8+R9JBEp8gUJb6JHYBQHEE4DMVgM9UAD5TAfhMBeAzFYDPVFbgr7sC6/GsTC33fR/6MtrjrYcXxVl49+0gJ4kD2meADOUCvJp8Wex7PvRntNVkgRTgB7IF9csSPEZB/z1xbnTjdqj/W6PLpiiwreIPt8Pqx2J1rOrt1RFjfIfTpIyq+iPZuj/rd2rx78iPjPwCrrvHj+SA1uVbuYI0cgK+hlESi10jvnFjUIhD+HgQux4/0F1n8ok7C+auawPGW8qz2A+BnnoHnl+eHbN28t0sWi5cfW2/l039z3W3OooN4oYvG1YL4A81lDU/j2Dc4gz2fAfCZkvAK86SzlgdOfgzOYCewa5Kjqn6Wh2gRk7q+IeXijCtwYkNBqWgjpcirOmws3hT7USrhzZ4xVlN467edw9eXJUcTZJAejlw9fjr7wFPauuCmT9FSPb0gGeuXnGWOXieBNLLEfgeV09Usl8BRYhRXzZKVy8ad/dndVx9vf9UqF09gDeTI1d/17gjG2tu3uQDRVgV3OJbjTvenaMY7866yo07dg260W3cAXgzOWrc3XXniE9/PGOGzMHXjXByYM1oS53yOxEB6ARw7s+6yt05cvjPmC4+4EOnOxcVPHVhqlCT8mB+GO26NIVufRZfTidUpY+JDSlayNbwy5mZakg80GByMDuMujhqQPefhXl1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" title="plot of chunk Robust" alt="plot of chunk Robust" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
CIdiff.25 &lt;- quantile(diffmeans.25, prob = c(0.025, 0.975))
CIdiff.25
</code></pre>

<pre><code>   2.5%   97.5% 
-15.540  -4.895 
</code></pre>

<p>Example 6: In the Verizon data, rather than looking at the difference in means, suppose we look at the ratio of means. The sample ratio is 0.5095, so for ILEC customers, repair times are about half of that for CLEC customers.</p>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/Verizon.csv&quot;
Phone &lt;- read.csv(file = url(site))
times.ILEC &lt;- subset(Phone, select = Time, subset = Group == &quot;ILEC&quot;, drop = TRUE)
times.CLEC &lt;- subset(Phone, select = Time, subset = Group == &quot;CLEC&quot;, drop = TRUE)
set.seed(4)
B &lt;- 10^4
boot.ratio &lt;- numeric(B)
for (i in 1:B) {
    ILEC.sample &lt;- sample(times.ILEC, size = length(times.ILEC), replace = TRUE)
    CLEC.sample &lt;- sample(times.CLEC, size = length(times.CLEC), replace = TRUE)
    boot.ratio[i] &lt;- mean(ILEC.sample)/mean(CLEC.sample)
}
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
hist(boot.ratio, breaks = &quot;Scott&quot;, col = &quot;lightblue&quot;, main = &quot;Bootstrap Distribution \n Figure 15a&quot;, 
    freq = FALSE, xlab = substitute(paste(bar(x)[1], &quot;* / &quot;, bar(x)[2], &quot;*&quot;)))
qqnorm(boot.ratio, main = &quot;Normal Q-Q Plot \n Figure 15b&quot;)
qqline(boot.ratio, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAArlBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OTk5OWU5OY85j485j9plAABlADllAGVlOQBlOY9lZgBlZjllZmVlZrVltbVltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/2t2Oa1ZgC1Zjm1tWW124+1/rW1/v3ajznatWXa24/a/rXa/tra/v39tWX9tY/924/929r9/rX9/tr9/v3/AAAlPrNhAAAAOnRSTlP//////////////////////////////////////////////////////////////////////////wD/iebt9QAAAAlwSFlzAAALEgAACxIB0t1+/AAAEghJREFUeJztnQubo7YVhsNsMhlnm60nm6ZpPdukjZduMm42pq7N/P8/Vl1BgCR0RdLofM9eDAJxxIuOLkjoix5Upb5IbQAojQB8pQLwlQrAVyoAX6kAfKUC8JUKwFcqAF+pAHylAvCVCsBXKgBfqQB8pQLwlQrAVyov8NfHBuv+LA1tD6oNVUQH/OvNs+QsvPv2JAYNB0zPSCyUEGSyzFLpwfyw29P0Nk62h5szS6n+lq4pBHg5+bY5KDbUEe01Uchu50q02wslBN0MW/CXHUn93ZEFTLfZzbk7zjKFX9o9wWNL6L8nzo3+IM/sA0kCzqt44/Z091dkfkeThG7OJxwmRNShTfJreda/aI7/1Az39fp4/wc5YHL5SawJhCHtGfjBJJyAn5uvn5BdJ+LW2C3gIFFCH3pMkmWg2TZK6Rlv7cWUsvvrriDgkWEteSofev7jxqAQh/DH07Dr/jPddSZbzZA2cgvQQ4x/Sc9iDwI9dQGeX54d43NHvISM+YEVShOT7v/TcA3pO3Pwlx25C+gJoVl8tj0FP7m/HpaGcPXIvsuOPMF3x+EHcUUsCdQvsQe55yU2em5pkTiAP1HwkrOEM+6OHPyZHEDPYFclx3SqWkd8IWN+3e2xgaJJD9SbIUd2ILeGpZiD79h94c57tj1x9dP766EgZfybZ2orAjf8YFAa6ngpQp5m6sip39rTXSJ4yVlj5Q7tW4IfrkqOplkkibAx7d0vT3OTCEyaCJqcppGCx4Uc8g4S8KxomN5fDwVw9dgEBXhaTWGP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" title="plot of chunk Verizon6" alt="plot of chunk Verizon6" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
CIratio &lt;- quantile(boot.ratio, prob = c(0.025, 0.975))
CIratio
</code></pre>

<pre><code>  2.5%  97.5% 
0.3307 0.8412 
</code></pre>

<p>As in the difference of means example, the bootstrap distribution of the ratio of means exhibits skewness (Figure 15a). The 95% bootstrap percentile confidence interval for the ratio of means (ILEC/CLEC) is (0.3307, 0.8412), so with 95% confidence, the true mean repair times for ILEC customers is between 0.3307 and 0.8412 times less than that for CLEC customers.</p>

<h3>Using <code>boot</code> Again</h3>

<pre><code class="r">library(boot)
set.seed(6)
phoneF &lt;- function(data, i) {
    d &lt;- data[i, ]
    m &lt;- tapply(d$Time, d$Group, mean)
    rat &lt;- m[2]/m[1]
    rat
}
boot.obj &lt;- boot(data = Phone, statistic = phoneF, R = 10000)
plot(boot.obj)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAAllBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlOY9lZgBlZjllZmVltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna/rXa/tra/v39tWX9tY/924/9/rX9/tr9/v3EEFkJAAAAMnRSTlP/////////////////////////////////////////////////////////////////AA1QmO8AAAAJcEhZcwAACxIAAAsSAdLdfvwAAA19SURBVHic7Z0Je+O2EYYDO7u10rjSHm2lTZvUSrdWalUS//+fKwCCEmkC4OAGNPM9PikAnOHLwUWC/KEjodQPpQ0glRGBRyoCj1QEHqkIPFIReKQi8EhF4JGKwCMVgUcqAo9UBB6pCDxSEXikIvBIReCRisAjFYFHKgKPVAQeqQg8UhF4pCLwSEXgkYrAI1VK8OfN42vXXXaPr/1fg/bbgEJPK/bwEl4MeuUBP9m8ZyHErrnDikGvjBHPY5U9vl52jLGnrjvwX+tOfMwev28+vl12D3/jsXzkm3lEH9mf+PZXnmig26eXuT++dd1QDMlT+cCfN0xA+29PbC/+4b8lwB9XArz49I8+0duRDVLVhUpP4GMpLfiBnQB/WglgXV9Hn1Y8rM+bh5fTipM9MAn+acj2+HpkIgPbiiRi2zU9VfWRlA+8/E/EryB2lJQPbCv/OPdV/cuQSYB/kifAsPWansBHUuY2nqmYNYGXaa7gb6cDgY+tzMO5vUKnq+oF4gPvwIlN78FTVR9b+cAPwSz6adrOnUB8ZPqIv6Yfg6fOXYAyV/WqOufdvGE4x9v0YTgnEHOca9UCTMBf01/B98WQPFXFlO2REGZXafCq578ubAY+lQbft+rUWGdXcfCkMiLwSEXgkYrAIxWBRyoCj1QEHqkIPFIReKQi8EhF4JGKwCMVgUcqAo9UBB6pCDxSEXikIvBIReCRisAjFYH3E6tfdgcIvJ8WDmsFIvBJVDF4FewVga/4YDmrXl/Y6NuiXODFWVjvwXJXvb5EA9+vcmXvnmDkbA6Bz6RY4C+7fnXqMWRdY9/JXOxpNqSK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" title="plot of chunk BootAgain" alt="plot of chunk BootAgain" style="display: block; margin: auto;" /></p>

<pre><code class="r">ans &lt;- boot.ci(boot.obj, type = &quot;perc&quot;)
ans
</code></pre>

<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 10000 bootstrap replicates

CALL : 
boot.ci(boot.out = boot.obj, type = &quot;perc&quot;)

Intervals : 
Level     Percentile     
95%   ( 0.3252,  0.8446 )  
Calculations and Intervals on Original Scale
</code></pre>

<p>Another 95% bootstrap percentile confidence interval for the ratio of means (ILEC/CLEC) is 
(0.3252, 0.8446),
so with 95% confidence, the true mean repair times for ILEC customers is between 
0.3252 and 0.8446
times less than that for CLEC customers.</p>

<h1>In Class Exercise</h1>

<p>The birth weight of a baby is of interest to health officials since many studies have shown possible links between weight and conditions later in life, such as obesity or diabetes.  The data set <code>Girls2004</code> consists of a random sample of 40 baby girls born in Alaska and 40 baby girls born in Wyoming.  These babies also had a gestation period of at least 37 weeks and were single births. </p>

<p>Import the data <code>Girls2004.csv</code> available from <a href="http:%5Cwww1.appstate.edu/arnholta/Data/">http:\www1.appstate.edu/arnholta/Data/</a>.</p>

<ul>
<li><p>Perform some exploratory data analysis and obtain summary statistics on the weights of baby girls born in Wyoming and Alaska (do separate analyses for each state).</p></li>
<li><p>Bootstrap the difference in means, plot the distribution, and give summary statistics.  Obtain a 95% bootstrap percentile confidence interval and interpret this interval.</p></li>
<li><p>What is the bootstrap estimate of the bias?  What fraction of the bootstrap standard error does it represent?</p></li>
<li><p>Conduct a permutation test to calculate the difference in mean weights and state your conclusion.</p></li>
<li><p>For what population(s) if any, does this conclusion hold?  Explain.</p></li>
</ul>

<h1>In Class Exercise (Partial Solution)</h1>

<p>The birth weight of a baby is of interest to health officials since many studies have shown possible links between weight and conditions later in life, such as obesity or diabetes.  The data set <code>Girls2004</code> consists of a random sample of 40 baby girls born in Alaska and 40 baby girls born in Wyoming.  These babies also had a gestation period of at least 37 weeks and were single births. </p>

<p>Import the data <code>Girls2004</code> available from <a href="http:%5Cwww1.appstate.edu/arnholta/Data/">http:\www1.appstate.edu/arnholta/Data/</a>.</p>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/Girls2004.csv&quot;
Girls &lt;- read.csv(file = url(site))
head(Girls)
</code></pre>

<pre><code>  ID State MothersAge Smoker Weight Gestation
1  1    WY      15-19     No   3085        40
2  2    WY      35-39     No   3515        39
3  3    WY      25-29     No   3775        40
4  4    WY      20-24     No   3265        39
5  5    WY      25-29     No   2970        40
6  6    WY      20-24     No   2850        38
</code></pre>

<ul>
<li>Perform some exploratory data analysis and obtain summary statistics on the weights of baby girls born in Wyoming and Alaska (do separate analyses for each state).</li>
</ul>

<pre><code class="r">opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(2, 2))
hist(Girls$Weight[Girls$State == &quot;AK&quot;], col = &quot;pink1&quot;, breaks = &quot;Scott&quot;, xlab = &quot;Weight in g.&quot;, main = &quot;Alaska&quot;, 
    freq = FALSE)
lines(density(Girls$Weight[Girls$State == &quot;AK&quot;]), col = &quot;red&quot;)
qqnorm(Girls$Weight[Girls$State == &quot;AK&quot;], col = &quot;pink1&quot;)
qqline(Girls$Weight[Girls$State == &quot;AK&quot;], col = &quot;pink1&quot;)
hist(Girls$Weight[Girls$State == &quot;WY&quot;], col = &quot;pink&quot;, breaks = &quot;Scott&quot;, xlab = &quot;Weight in g.&quot;, main = &quot;Wyoming&quot;, 
    freq = FALSE)
lines(density(Girls$Weight[Girls$State == &quot;WY&quot;]), col = &quot;red&quot;)
qqnorm(Girls$Weight[Girls$State == &quot;WY&quot;], col = &quot;pink&quot;)
qqline(Girls$Weight[Girls$State == &quot;WY&quot;], col = &quot;pink&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAA0lBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OQA5OTk5OWU5OY85ZmU5ZrU5j485j7U5j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVlZrVltbVltdpltf2POQCPOTmPOWWPZgCPZo+PjzmPj2WPj7WP27WP29qP2/21ZgC1Zjm1ZmW1jzm1j4+1tWW124+1/rW1/tq1/v3ajznaj2XatWXa24/a29ra/rXa/tra/v39tWX924/9/rX9/tr9/v3/AAD/tcX/wMu/5SkdAAAARnRSTlP///////////////////////////////////////////////////////////////////////////////////////8A////mpGtrAAAAAlwSFlzAAALEgAACxIB0t1+/AAAIABJREFUeJztnYuC27axhktvjiS7ru1Uio/3JGm0cXraZrlJmniZpBtdlpLe/5WKC0lRJEBcOLhQmD/O2pIoLAYfAQzJweBPJSpJ/Sl0BVBhhOATFYJPVAg+USH4RIXgExWCT1QIPlEh+ESF4BMVgk9UCD5RIfhEheATFYJPVAg+USH4RIXgExWCT1QIPlGFAr9bzDZluc3W3beXYeoDLWZf8eJ++Kja/jzLssbw84v9KmP/bjXT7h1QBUOBLz57eX/d4Al0XfA5OW63mPP3Wi/2qzl7fW4m9g6IAoF/vvvr3ZwbXvATnP61ZuCp5UW7C0xRu8XrOQO/W2Tk53712eLFP7K3i2z2Y2Nu3ZX52V6dJe0XDDN5Y8tahpTzfJdldKQEUCDwu8W6uHmkhu9Iz89vHivi5C/yUVm9GaZuINotPn//SPBRduwvZu1sU2RzZi43kIPnlKvBrv2iBb4pZ+I9vqCo1/yM32YZJc447xZ/vWP2szfD1A1EBFexJKR4p18yYNuqjzO2zEAd8Hyob5cDojDgn+9mG2oD7fGEOB3cSUNk9GygP8v6zemKDl1vfuTgiaVd8JWBSvAZmwAr8HU5IAoDnvKlhCuLqlG9oKfB7DfSPK03Jyo2db2W9vjKwPMcny+J9eTkn/1evyjPrtz19HhmF7N0XdD5i577S97/l7RBqjeD1A1G1JAtm8LOc3MbfG117dWTrlCd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" title="plot of chunk GirlsHist" alt="plot of chunk GirlsHist" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
</code></pre>

<p>Another approach is to use <code>lattice</code>.</p>

<pre><code class="r">require(lattice)
histogram(~Weight | State, data = Girls, layout = c(1, 2), as.table = TRUE, type = &quot;density&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk GirlsHistLattice" alt="plot of chunk GirlsHistLattice" style="display: block; margin: auto;" /></p>

<pre><code class="r">qqmath(~Weight | State, data = Girls, layout = c(1, 2), as.table = TRUE)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk GirlsHistLattice" alt="plot of chunk GirlsHistLattice" style="display: block; margin: auto;" /></p>

<pre><code class="r">qqmath(~Weight, group = State, data = Girls)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk GirlsHistLattice" alt="plot of chunk GirlsHistLattice" style="display: block; margin: auto;" /></p>

<p>A third approach is to use <code>ggplot2</code>. (This is my preference.)</p>

<pre><code class="r">require(ggplot2)
p &lt;- ggplot(data = Girls, aes(x = Weight)) + geom_histogram(binwidth = 300, fill = &quot;peru&quot;, color = &quot;black&quot;) + 
    facet_grid(State ~ .)
p + theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk GirlsHistggplot2" alt="plot of chunk GirlsHistggplot2" style="display: block; margin: auto;" /></p>

<pre><code class="r">p1 &lt;- ggplot(data = Girls, aes(x = Weight)) + geom_histogram(aes(y = ..density..), binwidth = 300, fill = &quot;blue&quot;, 
    color = &quot;black&quot;) + facet_grid(State ~ .) + geom_density(color = &quot;red&quot;, size = 1)
p1 + theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk GirlsHistggplot2" alt="plot of chunk GirlsHistggplot2" style="display: block; margin: auto;" /></p>

<pre><code class="r">p2 &lt;- ggplot(data = Girls, aes(sample = Weight, color = State)) + stat_qq()
p2 + theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk GirlsHistggplot2" alt="plot of chunk GirlsHistggplot2" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = Girls, aes(sample = Weight, shape = State, color = State)) + stat_qq() + facet_grid(State ~ 
    .) + theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk GirlsHistggplot2" alt="plot of chunk GirlsHistggplot2" style="display: block; margin: auto;" /></p>

<h2>Graphs are fun!</h2>

<pre><code class="r">with(data = Girls, tapply(Weight, State, mean))
</code></pre>

<pre><code>  AK   WY 
3516 3208 
</code></pre>

<pre><code class="r">tapply(Girls$Weight, Girls$State, sd)
</code></pre>

<pre><code>   AK    WY 
578.8 418.3 
</code></pre>

<pre><code class="r">AK.weight &lt;- subset(Girls, select = Weight, subset = State == &quot;AK&quot;, drop = TRUE)
WY.weight &lt;- subset(Girls, select = Weight, subset = State == &quot;WY&quot;, drop = TRUE)
c(mean(AK.weight), sd(AK.weight), mean(WY.weight), sd(WY.weight))
</code></pre>

<pre><code>[1] 3516.3  578.8 3207.9  418.3
</code></pre>

<blockquote>
<p>ANSWER: The mean and standard deviation of weight for baby girls born in Alaska is 3516.35 and 578.8336, respectively.  The mean and standard deviation of weight for baby girls born in Wyoming is 3207.9 and 418.3184, respectively. </p>
</blockquote>

<ul>
<li>Bootstrap the difference in means, plot the distribution, and give summary statistics.  Obtain a 95% bootstrap percentile confidence interval and interpret this interval.</li>
</ul>

<pre><code class="r">B &lt;- 15000
mean.diff &lt;- numeric(B)
for (i in 1:B) {
    AK &lt;- sample(AK.weight, size = sum(!is.na(AK.weight)), replace = TRUE)
    WY &lt;- sample(WY.weight, size = sum(!is.na(WY.weight)), replace = TRUE)
    mean.diff[i] &lt;- mean(AK) - mean(WY)
}
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
hist(mean.diff, breaks = &quot;Scott&quot;, col = &quot;lightblue&quot;, main = &quot;Bootstrap Distribution&quot;, xlab = substitute(paste(bar(x)[1], 
    &quot;*&quot;, -bar(x)[2], &quot;*&quot;)), freq = FALSE)
abline(v = mean(AK.weight) - mean(WY.weight), col = &quot;red&quot;)
curve(dnorm(x, mean(mean.diff), sd(mean.diff)), col = &quot;blue&quot;, add = TRUE, lwd = 2)
qqnorm(mean.diff, col = &quot;blue&quot;)
qqline(mean.diff, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAAq1BMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlOY9lZgBlZjllZmVlZrVltbVltf2POQCPOTmPOWWPZgCPj2WP27WP29qP2/2t2Oa1ZgC1Zjm1tWW124+1/rW1/v3ajznatWXa24/a/rXa/tra/v39tWX9tY/924/929r9/rX9/tr9/v3/AAD/L7wLAAAAOXRSTlP/////////////////////////////////////////////////////////////////////////AP+Eine/AAAACXBIWXMAAAsSAAALEgHS3X78AAAQvElEQVR4nO2dC2PbthHHS5urazf15CTruklZt0paGmtNrGkS9f0/2XAASPMBgACJx9G4f1NbpED4gB9xeBAAv6tIWeq71AaQ0ojAZyoCn6kIfKYi8JmKwGcqAp+pCHymIvCZisBnKgKfqQh8piLwmYrAZyoCn6kIfKYi8JmKwGcqAp+pCHymIvCZisBnKgKfqQh8piLwmWom+PNTAbp7UX67X+sOdBGt4dPts+IqOH3ZtL9qAnSvSCyWEGayylJl4DrYZdPNxs5xkzm9lJqz1Cw/4NXk98Vac6CPaGWIQpWdI9HGF0sIywxX8KcHnvqbrfyieywz52bbKxRz0j4bPFgifh5qbuIDv2fveRKgrMLBZXPzV2b+USSJZc5n+K4V0ZEd8k/Dq/4lSvznosnX89PdNx6g8+c7sSYQQFpJ8I1JkIB/Fj9smF0H7tZkFtQgWULvKyApC1DvmKX0BY5W7ZTK/J0qT+CZYXt+V95X9YeLhMIdwrdNc+ruqzj1wo+KJm08C9hNDJ+UV8kbQVw6AF//eRlmeo7MFDPmZ1kpdUy6+09Rq0nfSw3+9MBzgd0hooj3jrvgO/k72U4/rp7Zd3rgd/DNtvnAXZFMgvBL8kau6hqb3beiSmzAHwR4xVWtK262NfgXHkBcIf8qD3PUtTrCixnz+8MKDGybdC+8GXNka541MsU1+KPMl9p59447rr6bv5PlqY6/fRa2MnDNBwmlEI5XIKzTLBy58FsrcaoNXnHVa+OOnRuCb/4qDy2KSBKBMfub3zZ9kzhMkQiRnKJQgodKjnkHBXhZNXTzd7K8uHowQQNeNFPk7SnSLBouavDS1Suusgdff5VG4r79QQceqinwirXLb7n6PdSLAvwfr8ciTpkcjOA1rp5rL60UOQCoTw9KV39sZUbvqp6rZ+cPhdrVpwcPza+OSX3wdRZ0GneiQVspjjvgsbn6QeOOf7iv721+UOdAXeI7jbu6OycSN7jq3G7cyb8hPvQbdwjAXzZFx6Q++DoL+t25pjfbPe6A7+bvZDu9Ne4G3Tlu/d0LJEE6eNYI5wGZwSvhlD83IwC9AZzhVed2d44H/ztkBwT42uvOpQfPXVe7O9cDX2dBbwCnBbJz3AXfzd+pdiYcsrUc5MhJ56e18dijCHymIvCZip7OZSoCn6kIfKYi8JmKwGcqAp+pCHymIvCZisBnKgKfqQh8piLwmYrAZyoCn6kIfKYi8JmKwGcqAp+pCHymIvCZCg34a2oD3FRg17UwJ4DAT9NItqbW9TpmIYGfJsTgy7KEzFwIeGZtahOchBc8y8cr5OUywJcgqJpSG2IrvIaWzM0vBTxQv8KPHd787Amjobz08DpzIeClvQR+nkr+37WuNRcBHrofVbFbkLfHZ6UoPtemqYQfPCvou50Ezz7iy1KV0FnJy/u1rJYHvih2OwI/VWXdTmrOoAfP/DsHv4Nfi6nmkVkJxMtrp0eMHXxJ4OerV71z4QdftcAX7DaIbcHh7kXsM+oiTOCHbh5E4Ed0fr9l/07v3HbnQARezR07eN6D64CPPXR7/vDMyrwavNx1TLFlCx7wHPt1mG3owe92bfC7+GP2B76htsrVXzZya9nhrmJowKuLe4UdPG/ZdcAnIK8Vcwad3y0hAa9x8yDU4Evc4NGXeAN31OChKTcAX8Qmf9kUd1/fb1Vfyf02sdbxdfWuzDDk4HfJwV82q9Pji6JQG4UBfPNQU/ntEsFHfVDDKnAGXlGNG5UevMnNg5YIPuronSjxB2WJR9yda9z8EsHLvlwP/C7yIE7/zV/tb9A27ho3r60XA4BvpvBOuLYjHOD1UnTnvKV9nszVO1fAEj838eJ57BA8mh4d2hI/5uZBBN6o+s0Y6jfV4ezOWRT3CjN4+TwWcYk3KCF4O+6LBL8A8unAW3In8GadP3zRunPozq2hza9o8icDb1O9cxH46YLGHbyxmfXz+18lAm9b3CsCPyrRV1OO3LGTl09bRE/nHLjjBS8e0KjBxxuvb1r16hehr6vjinXnhq93SwLe2s2DEIPfIQCvKeu1mpf79ZUC/OhgXUfLBB/92ayr4oMfH6TtCiv4Zs6VEnzMWv6ob9XrFR28k5sHEfgRTXubY2zwjsW9Qgv+dc6VGnw88q5P4oXignd18yACP6b9ajzMQFHBT+FO4MekfxBjUkzwztU712zwpwf+Qm/PgxgW4JM/9DYpnmmTintlCf78pH0DPQxbXjarBOB3mNdPRjNtKnfbEs/6NDfqGcYc+P7eK/j2vGoN+HhT7w6YXf00Nw+yd/XwHGrYs5GzUA5/Gi4umwV+hwX8+f32eF8dtC5PrTjgJxf3yhq8qMlVXZvzE2/1HoZFIiz4WFPvWJrFP6eropg2h7ttHe+4nsAmaoPasyxTg7982rJ/CJdJNxPnp/Vv7MDrH01Oj9ogTOArxpy1cBw78+FNG504PyIL8OZHkwEWFXRmWWrBY5mOoVRw8LPcPMihxCsVYooxgR/VPDcPmjuAE2KNOCrwGEfu5rp5kI2rN004TFri4w3eHTDV8fOLe+VhyDbAogJr8PEG72wbtjGWUHnhjvEhTXeWJQ7wRzSu3oebB9mBj7rXmy34XZTBO+nRsOxzN7s1X8uuVW/Y623YnZvp7gpc4KcplF1+3DzItjun2+vNf+OuN8vSAD7FPpeWCmPXzMG6jixdvXavN//dOWTguau/fT64+fogdvmq3rnmNu68l/j+LMvE4I/8afTpAcHmRx6Le4WwO+cCPvwYDl8ihQK8TzcPsgMfcW45LvCyBvvf19SPZb26eZDlY9l4c8txgZclXrUg1ijf4D0X92r+Q5pa3hp3uMA3dXzafrx/7pauPt7c8sEsy8Tg61a941VewXt38yBLVx+tjncDj/bRrE/wAYp75Wdevc9WPYHvKwx3ZP14xbxqM3is66W9gffdi2tkB16/dbffkTvF9NpR8CgX1PiyKUj1zmUF3rB1t98Sr5hlOQoe5YMaTzaFKu6VfXdOu3W315E7d/DhJ9saXlQQevfqgNxdSrx66+7JUauEEHw0bzdQODcPsq7jNbOrp0etEkLwBm8X9mVEIYt7hW3qFULwBm8XtMQH5o4LvGqWZWrwJm8XcPfq0NztwPNGTPBhS9jEzB08zjGcmeDDVu9cNuAjPahQT7bLEXzw4l5ZgY/1aHIi+KDkzS8qCNSdi8HdbiWNtvE6J+qB1JPt0oI3KkzjLoKbB70B8MnG64O8jMjbxPkREfgx8Va9cieUMOsGI7h5kMv6+MDP4yeDD0oetvSqNHvgeO/ORXLzIET9+MngwzbvIu4GEsvNg/CA10y2swEflDwv7FF2vYrm5kEEfkSmis7rrp7BplyohQa8bs5VavAGed3VM2L1zkXgx6RfTOJzV8+4xb0KAn5KX1Y/2c4KfMB2/Vk9BwPkb1fPyG4ehKTE6yfbJQdvaM/72tUztpsHvRHwARfOuu57xOVkTPziXqEBr5+BYQc+4GP54LtXJ+H+ZsAHa98Z6niDHNKehjsS8IYZGMnBh30ZUVO9T/gjs0TgxxS0jk9U3Csk4E0zMGzBhyIfcsFogl5cIwIfRFZpT9GLa4QBvHHOlTV4VOsnbdIe81ncUBjAG5/HuoAP0qML1Z1L6OZBbwh8GGcf6GVESd08CAF48/NYJ/ABcjHMy4gSF/cKA/jSG/ggRT7Iy4jSc0cBfgSnPfgg7Tv/LyNK2YtrlBw8Sz1u8JNkSnuywbqOUoMvxx7EO4Gv4ubmpJU0GIp7lXzXq3L06YwT+MJ7fsL7lFkSlb25SfPqkXBPvevV+CC9E/id95b9fsWTqOzOTVlJk7oX12gu+Fm7QtgM2TmC99yyh2RBi17ZnXO/6dMO1nWUtMSXAcD7beABcNgNQ92dc1xJUyLiPr+On7GMqLQZspsA3me27td8DdXew8hd8sG6jlK26q1GbpzB+63m2X199wItPDcN046quFcJwRel3ciNO/gwQ7du6qe9RDFo01ay7lwZDnyRPn97aX/lnsYchRI17krrDvwU8Lvk5LtpL3EM1nWUpjsnuIcDv0uNfgC+woU9SYnn978jR2fwRZm0HfWadmEGuPlUtqgVtztX1rIHOBW8KPSp4DdpL/l/zM2nsMKk8K36ciBHgFPBt9iXsW+CQqZcgL/CT2QKDr6b8e7EZ4FXwo9xB0DaS576Cl/1zhWgO9d9UAGPXT3o6iWW+OCrEl/1zhWwcedV16Cxe9cr+CtSywN257wKafbp1NTxaO2mEh9EdbbiNTtgd073F6PV8bYWBZA02k/LJIzMCZjTqtflCaIgYWVnQPRQVoEI/AxlAd6+cUfgE4eiEh9aBN717xL4kKE8gddPxJj+dwl8yFB+wLv34wl84lB+wMcauSPFFZqRO1JcBRi5Iy1BAVr1pCWIwGcqAp+pCHymIvCZisBnKgKfqXyD56uONd/BqP+6CaIJyQeMTEEuG/EuOGMskVSPbpkkU22UXSpsYrI0yjt47XYylXgVxOnHrQyiC3ko1pUxyH4No4gjsUTSYRyETLUxjF0qbGKyNKryDr7eUkalIyRtv5ZBNCFPP31cV6Yg8pmBOZZI4saOSKbaGMYuFTYxWRpVeQd/enwxvuSFfSeDqENePv3G7n5TkNPjr+DqjbFEkjDWQmMW2qdiPJStUZ7Bw6Mc4xv8VnUQdcjDCtyeKcjpgd8YxlgiSRg7LvGicoOsUzEak71RUUs8f3+fuTjzynskyKjfCK99UdxLY0dCNW8tNMg2FeMxVeNGSUWs43lhNdfO4p0BK2Md/xeeSQjqeGnsWDCRaqMsU2ERk61RAVr1K237VNotg+hC1m9w1gbZr8VtbYwlkiwKlw0tu1TYxGRpVBW1Hy9uxvXcfjw7CXMDltKPr1NtlFUqrGKyM6qikbtsReAzFYHPVAQ+UxH4TEXgMxWBz1QEPlMR+ExF4DMVgc9UBD5TEfhMReAzFYHPVAnBq/dftNmVkTRfVOIzFQrwl38o3+WsPEvyIwzgD9//olgDoD5L8qSE4PfNDMP2wiD1WZJvJQR//vClXg715XUvNfXZZeiy4S3Tuz9Gpkqf3j33Z1PXxwfDfEpxmafZ5Cld/UE5/1t9diniWMbYqNYMilN7WFPzpCEvwrwB8G1fLgvL/dI9vAT/c70gXM4EZ79OP328feYf4cfvLBz7DasA+eLnNtTj3Qt84P+LLx9/Zb/kZSdxJUR8nLELXUrw+19ggdHfFGdPDzcLpS/AP4glgrK9sudHfD2EOCMctlgl+BUWP9cOnC+I5UvDBPiz/FLE9+rqRTSwAGfyapKE4E+P3z5tTw/3irP/3h7TLY+ZpcbVS2wMDvCRLOWZfmUtTrEPAuPlUw2+9WVzTSviOYsG04GXy2J7Jb5eLHtcaE+uAx72BL3hECXL1zPw71EsntmDw1aX+NaXHfAiGqgIJnvG5P34gas3nF2AOuBf93CoS7w40y7x0JRrDuDnf2EJcHPrNF92wL92dyZvMYwT/HK3ym6Dl5V7XcfzAtyqrPmC8HfQymPtWenXD8wFPsH6QubFD7Ko/7jtg5fRcM/4tsCLheVLVAe8aLbXrfp3ooHPzlw2rVY967l//3Hd6sfffmYdWvb7z9B2a77kd0qrVQ8R7xfaqiclFIHPVAQ+UxH4TEXgMxWBz1QEPlMR+ExF4DMVgc9UBD5TEfhMReAzFYHPVAQ+UxH4TEXgMxWBz1T/B8TOToyaXyHdAAAAAElFTkSuQmCC" title="plot of chunk GirlsBoot" alt="plot of chunk GirlsBoot" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
BIAS &lt;- mean(mean.diff) - (mean(AK.weight) - mean(WY.weight))
BIAS
</code></pre>

<pre><code>[1] 0.4039
</code></pre>

<pre><code class="r">CI &lt;- quantile(mean.diff, prob = c(0.025, 0.975))
CI
</code></pre>

<pre><code>  2.5%  97.5% 
 89.92 524.93 
</code></pre>

<pre><code class="r">ggplot(data = data.frame(x = mean.diff), aes(x = x)) + geom_density(fill = &quot;skyblue&quot;) + labs(x = substitute(paste(bar(x)[1], 
    &quot;*&quot;, -bar(x)[2], &quot;*&quot;))) + theme_bw()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk GirlsGGplot" alt="plot of chunk GirlsGGplot" style="display: block; margin: auto;" /></p>

<blockquote>
<p>ANSWER: The mean of the bootstrap distribution of the difference of means (\( \hat{\mu}_{\bar{x}^*_1 - \bar{x}^*_2} \)) is 308.8539 while the standard error of the bootstrap distribution of means (\( \hat{\sigma}_{\bar{x}^*_1 - \bar{x}^*_2} \)) is 110.7742.  We are 95% confident that the mean weight of baby girls born in Alaska are 89.9219 to 524.9344 grams greater than baby girls born in Wyoming.</p>
</blockquote>

<ul>
<li>What is the bootstrap estimate of the bias?  What fraction of the bootstrap standard error does it represent?</li>
</ul>

<blockquote>
<p>ANSWER: The bootstrap estimate of the bias \( (Bias_{boot}[\bar{x}^*_1 - \bar{x}^*_2] = E[\bar{x}^*_1 - \bar{x}^*_2] - [\bar{x}_1 - \bar{x}_2]) \) is 0.4039.  The \( Bias_{boot}[\bar{x}^*_1 - \bar{x}^*_2] \) represents 0.3646% of the standard error of the bootstrap.</p>
</blockquote>

<ul>
<li> Conduct a permutation test to calculate the difference in mean weights and state your conclusion.</li>
</ul>

<pre><code class="r">ANS &lt;- tapply(Girls$Weight, Girls$State, mean)
ANS
</code></pre>

<pre><code>  AK   WY 
3516 3208 
</code></pre>

<pre><code class="r">obs.mean.diff &lt;- ANS[1] - ANS[2]
names(obs.mean.diff) &lt;- NULL
obs.mean.diff
</code></pre>

<pre><code>[1] 308.4
</code></pre>

<pre><code class="r">R &lt;- 50000
Weight &lt;- subset(Girls, select = Weight, drop = TRUE)
result &lt;- numeric(R)  # space to save the random differences
for (i in 1:R) {
    # sample of size 40, from 1 to 80, without replacement
    index &lt;- sample(80, size = 40, replace = FALSE)
    result[i] &lt;- mean(Weight[index]) - mean(Weight[-index])
}
hist(result, col = &quot;blue&quot;, main = &quot;&quot;, xlab = expression(bar(x)[1] - bar(x)[2]))
abline(v = obs.mean.diff, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAeFBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOY8AZrU5AAA5ADk5AGU5OWU5OY85j9plAABlADllAGVlOQBlZmVlZrVltf2POQCPOTmP29qP2/21ZgC1Zjm1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/AAC6TDvjAAAAKHRSTlP//////////////////////////////////////////////////wD/AIw85wAAAAlwSFlzAAALEgAACxIB0t1+/AAAB+ZJREFUeJzt3WF7mlYYh/HSZTXtYtttJotbWVdR8/2/4QTlqkdBeOCcP4fjfb9YNiM1/kbhiQK+25Okd1P/APcS0KKAFgW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWhTQooAWBbQooEUBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWhTQooAWBbQooEUBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFFAiwJaFNCigHZ7C/UHd0MXj1nZL99C/QhRNR307nlVfd18+BHqZ4ip6aC3X785XxOPNVrUhNvo7We20R5i6nADWhTjXXvZeWP/MHaG7WUPP5sxdJTjnbMSJwId5Rp9bvuQCHSU412S0DF2J9DedvGDSxK6fbwD2tCYnSHQhsaMd0AbYo12i3K8A9rQmPEOaENAu0073i1yNh1j694Zvrzu88XB+4md4Zh6jXf5kvFubKzRbtNuo5dso0fH1OEGtPvIQGsCWhTQooAWBbQooEUBLQpoUUCLAloU0KKAFgW0KKAD1nZINNCey1psgfZcP+ixJ7QA3RPa+caARwEaaFVAiwJaFNCigBaVPHQsJwulDh3NqRWpQ0dzslDq0KzRfprPyULJQ7cHtCGg3RjvkodmZ+gnxjs31ujkoRnv/MTU4RYV9DSX+kkemvHOS+wM3RjvkodmjfYT451bVFNHHdCGgHabdLxb7Z6zrOFiu0Ab6rUzXK8iuDBK6tCHsa68CA3j3ci6Nx2H1XmzPIx3i6vvAG2ox85wXY13185AW2LqcAMaaFVAiwJaFNCigBaVBPT2c8OY3BnQhuo1epNl71+NywJt6GzTUb5Gt7IsC7ShGrp4LNdo20e8AW2o3kYP+Ww3oA0xdbiFht4cts65dW8ItKHTpuNLaVx8sn1mIdCGjtDHgzesH8IZHLr9E0/nCn08eMP6IZzhoft5tn5jwNVo7nNnOBZ6wNoNdCLQmyEf4Au0ofoXFtPv3qeANnSCHvTp6kAbOm061ssBywJtqN50sI0+xtSRPvSEJwslCL17zj58/9L0otKUp1akB717XhZPPxpf65jyZKH0oA+KB+jGIY812k/na3Te+OrdhCcLpQddvTHbdPbEzYA2xHjnxniXBvSN3wzZGfrpfI3Om17wYLzz0zk0450IetP4ohLjnZecbbTx1X+gDUV9qZ/7gma885Kz6WjiZGfop9ManS/qf1zGeOen8zdnGe8Ur97tW9Zoxjs/nb96Zz1hCGhDvHrnNjV046HTQBvqfHP2xuQHtKHON2cP0gdi1uixdb45u6/O2foX6JF1vzlbVjw2vbAHtCHenHWbeupoDGhDHB/tFnob/WK9skEZ0IY4PtqNbTTQAUsNetiuEGhTNXTDVYs7A9oQ0G5AJwHd/krozYA2xNThBjTQAQP6GNCGooNuu4wS0J4b6Ql07z80EHTPK1kBPRba+Ub7wwMNtOeAvg5oQ0C7AZ0+tPhkobuFVp9acbfQ6pOF7haaNdpP0X0u+P1Ctwe0IaDdGO+Sh2Zn6CfGOzfW6OShGe/8xNThFhV00Ev93C80452X2Bm6Md4lD80a7SfGO7eopo46oA0B7TbteFd+GC07w3H12hmWV2sDelw9x7v1Auhx9R3v8l+vL/YDtKE+4111RfpcdJWw+4VuD2hDQLslDe2e9qCAbj/PIm3oUJ59vvEANNB1QBsCGmig64A2BDTQQNcBbQhooIGuA9oQ0EADXQe0IaCBBroOaENAAw10HdCGpoIOdWVMoC+XFXvegHYOPQA6HPT5vwMN9NBlge4f0IaABhroOqANAZ0etP4waDt09tbrAvUDUkJP6dkT+uHt7D9G0FwHdDTQ3i6MMjvofp9z0TP/l5HIWpvScwj0+TdGqw+5MMr1A7bjzq237ru4eYO+sUanWJQXRkmxKOfoFANaFNCigBYFtKi5Qnufc0PXNkePlggNfbdLXAZ0oCUuAzrQEpcBHWiJy4AOtMRlQAda4jKgAy1xGb+wiAJaFNCigBYFtCigRQEtCmhRQIsCWlQw6OrAm+3nrDzu5vTlZuUhfrYlqnrfcdgjWJ9Fe8Gg82xV/Zj5ov5ys+2X133x8dWwRFXvOw58BOOzuFEo6OK331fV8XrFp2+nLzfvvymfwnplWKKq9x2HPYL1WdwoEPTu5a/DClA8/ShXpNOXzoV+3rXvEvvedxz0CIOeRUuBoPNl+TetPDDy8LOdvnQtU36sjm2J/b73HQc9wpBn0ZZ/6HWWLQ7/93f914VyidPHkARdo62PYHsWHYVZo/PqWIilZetWPJaHBwfcRtsfYcCzaC/oeFf+Va3218vO/fVRwbLE/uz+fRr0CMZncaNY5ujj2rMKOEcPeoQZzNHkBrQooEUBLQpoUUCLAloU0KKAFgW0KKBFAS0KaFFAiwJa1Byhm85l9XR+a7jmCD3LgBYFtKg5Qq8b3iVtui2q5gi9/frP18u3/Ztui6o5Qu/zbNnrtpiaJXTx8XTA0O65muoW57dF2iyh13+Uh5D9eXVb8fg+Wu05QhdP/728Fo+Lq9v+ft1Eu0OcIfTpCE9nja6P+tysJvuxOpoh9KmLTUfrbZGUFPQ24gkvKejjgdZxNl/omQW0KKBFAS0KaFFAiwJaFNCigBYFtCigRQEtCmhRQIsCWhTQooAWBbSo/wHN/sNUGJ92NwAAAABJRU5ErkJggg==" title="plot of chunk GirlsPer" alt="plot of chunk GirlsPer" style="display: block; margin: auto;" /></p>

<pre><code class="r">pvalue &lt;- (sum(abs(result) &gt;= abs(obs.mean.diff) + 1))/(R + 1)  # p-value
pvalue  # results will vary
</code></pre>

<pre><code>[1] 0.00738
</code></pre>

<p>The <em>p</em>-value for testing \( H_0: \mu_{AK} = \mu_{WY} \) versus \( H_A: \mu_{AK} \neq \mu_{WY} \) is 0.0074.  The small <em>p</em>-value suggests that the mean weight of babies born in Alaska is not the same as the mean weight of babies born in Wyoming.</p>

<ul>
<li> For what population(s) if any, does this conclusion hold?  Explain.</li>
</ul>

<blockquote>
<p>ANSWER:  The results should hold for single birth babies born in both Alaska and Wyoming with a gestation period of at least 37 weeks.  </p>
</blockquote>

<h1>CLASSICAL INFERENCE: CONFIDENCE INTERVALS</h1>

<h3>7.1.1 Confidence Intervals for a Mean, \( \sigma \) Known</h3>

<p><strong>Example 7.1</strong> The Centers for Disease Control maintains growth charts for infants and children <a href="http://cdc.gov/growthcharts/zscore.html">(http://cdc.gov/growthcharts/zscore.html)</a>. For 13-year-old girls, the mean weight is 101 pounds with a standard deviation of 24.6 pounds. We assume the weights are normally distributed. The public health officials in Sodor are interested in the weights of the teens in their town: they suspect that the mean weight of their girls might be different from the mean weight in the growth chart but are willing to assume that the variation is the same. If they survey a random sample of 150 thirteen-year-old girls and find their mean weight  an estimate of the population mean weight  is 95 pounds, how accurate this estimate be? </p>

<p>We assume the 150 sample values are from a normal distribution, \( N(\mu, 24.6) \). Then the sampling distribution of mean weights is \( N(\mu, 24.6/\sqrt{150}) \). Let \( \bar{X} \) denote the mean of the 150 weights, so standardizing gives \( Z = (\bar{X}  \mu)/(24.6/\sqrt{150}) \sim N(0, 1) \).  For a standard normal random variable \( Z \), we have \[ P(z_{\alpha/2} < Z < z_{1-\alpha/2}) \] </p>

<p>The random interval \( (\bar{X} - 3.937, \bar{X} + 3.937) \) has a probability of 0.95 of containing the mean \( \mu \). Now, once you drive your sample, the random variable \( \bar{X} \) is replaced by the (observed) sample mean weight of \( \bar{x} = 95 \), and the interval (91.1, 98.9) is no longer a random interval. We interpret this interval by stating that we are 95% confident that the population mean weight of 13-year-old girls Sodor is between 91.9 in 98.9 pounds.</p>

<h3>Remark</h3>

<ul>
<li>The trick of doing algebra on equations that are inside of probability is often handy.</li>
<li>Be careful when reading an equation such as \( 0.95 = P(\bar{X}  -3.937 < \mu < \bar{X} + 3.937) \). this does not mean that \( \mu \) is random, with a 95% probability of falling between two values. The parameter \( \mu \) is an unknown constant. Instead, it is the interval that is random, with a 95% probability of including \( \mu \).
In the previous example, we computed a confidence interval of (91.1, 98.9). We should not attribute a probability to this interval: either the true meaning is in this interval or it is not!  The statement &quot;we are 95% confident&rdquo; means that if we repeated the same process of drawing samples and computing intervals many times, then in the long run, 95% of the intervals would include \( \mu \).</li>
</ul>

<p>More generally, for a sample of size \( n \) drawn from a normal distribution with unknown \( \mu \) and known \( \sigma \), a \( (1 - \alpha)\times 100\% \) confidence interval for the mean  \( \mu \) is \[  CI_{1 - \alpha}(\mu) = \left( \bar{X} + z_{\alpha/2} \sigma/\sqrt{n} ,  \bar{X} + z_{1-\alpha/2} \sigma/\sqrt{n}\right)  \]</p>

<p>If we draw thousands of random samples from a normal distribution with parameters \( \mu, \sigma \) and compute the 95% confidence interval for each sample, then about 95% of the intervals would contain \( \mu \).</p>

<p>We illustrate this with the simulation by drawing random samples of size 30 from a \( N(25, 4) \).  For each sample,  we construct a 95% confidence interval and check to see whether it contains \( \mu = 25 \).  We do this 10,000 times and keep track of the number of times that the interval contains \( \mu \). For good measure, we will graph some of the random intervals. </p>

<pre><code class="r">set.seed(13)
counter &lt;- 0  # set counter to 0
mu &lt;- 25
sigma &lt;- 4
n &lt;- 30
sims &lt;- 10^4
plot(x = c(mu - 4 * sigma/sqrt(n), mu + 4 * sigma/sqrt(n)), y = c(1, 100), type = &quot;n&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;)
for (i in 1:sims) {
    x &lt;- rnorm(n, mu, sigma)
    L &lt;- mean(x) + qnorm(0.025) * sigma/sqrt(n)
    U &lt;- mean(x) + qnorm(0.975) * sigma/sqrt(n)
    if (L &lt; mu &amp;&amp; mu &lt; U) {
        counter &lt;- counter + 1
    }
    if (i &lt;= 100) {
        segments(L, i, U, i, col = &quot;blue&quot;)
    }
}
abline(v = mu, col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAb1BMVEX9/v0AAAAAADkAAGUAAP8AOTkAOY8AZrU5AAA5ADk5AGU5OWU5OY85j9plAABlADllAGVlOQBlOY9ltf2POQCPOTmPOWWPZgCP29qP2/21ZgC1/v3ajzna24/a/v39tWX924/9/rX9/tr9/v3/AADgEgyEAAAAJXRSTlP//////////////////////////////////////////////wD/gelQsAAAAAlwSFlzAAALEgAACxIB0t1+/AAACUJJREFUeJztnWt3EzcURUlLSUpJoHVom+ASx9b//431Y/wYz0NXuldHD5/9xayFmGp2tjUqRM6HDYHwIfcEbgWKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAi/6NXD3Y5ffwBm0zBe0evnxf717dPP69+6KwOXewIdStHv3370Xi9F+/4sBpd7Age0oueKjpySMY2I3rw/7d8YI2s0RV+iFh19aRQUDaIV0dPbO4q+hA9DEAm2d8KdYzgfo3Bxf+wK9eRZNIgatne6FnVFW90Ddx0oyhet61lXtM0d7ClftBYWbUXCog2TV2/vnrq93PBpyKIvURe9fn6Mu3SPhNE5syhV6JeO968vUZdG0UrR0ZdGQdEgfEtHSi6mcQOic0/gQK2i5VW5lJ3KqVW0HBatJVvRUVFXLFoIiz6QorcezrLLeLKLTg6LVmFSdCRRE65VtBwWHUpkfy5bxD0qEh0Ji57GosETDt3uOEWKNoVFg6DopEQvHQaMTqhV0WdY9DxmfTmbIrUUK9oMFj2DWc4RRSvueI4yRVvComfJVzTX6EhYdCL0RUczN632RF/DojUEZOaQ3U7D428gajgspAvQZch3BH66AYgaij6RoWiztGs4/qajkaLjL42iXdEpjigr3vPapcPoDiy2d/dLLh1e1A/D7y+b5f3W9xfzh6GyxCMuY8YXWGzvlo/c3nkpsmijlqOKjp60B4s1+pFrtJ+ytnemKQcWrbhTCWWJTgGLviZFztKiFbcppCDRiWDRRpgUHUnANOsX7YNFbwBHsj5OF624sxhYNIjSRacr2o/F/E+ULloPiwZB0RPoF4s+Ltdi0ac80daw6GmyFZ0w6iJFm8KiI0lcdKra6xMdCou2AFu0pu/KRQtg0VMYh+fSVRpCgaKNYdGWWBUdg2yGjYiegUXb4A0uYdEh86xetBcWHUFMdg5f7xh1iY6BRYO4edE272g/zn4ZiIFFg2jo5Ky8aHv8s6vqnGEUjRQdd3IWEdkRFxxfElg0iCJOzkKLzhQ4dx0gKjk5O4uqaCXiSRps7xbr57u74RLNontYPAxfF3bnDO2bc/Z1xmCwvdud6eTJWR/qpWOb89vjdnt3H3rpUNIXnbR1/cPwdf/gG3pm0T3A2zuDukJxhlkq4D4aBEWDqFB07NJhQfysKxQdCIsWoY/QZch3hNJF62HRo+gLvsblKfia0kTbw6JTE1y0IcPZNCy6g0UrkcblIMF6qVe0lJsuOkFkkzh9jRawaBAVilYWrSJ+1hWKDoRFi9FF6PIUfE0NonWwaBAUHQ5+6bBbQ6oSHQWL9mAS4seoonUTH6dc0VawaBVJi04RfK2i5bDoK8zD63CpGg2jHNGpYNGgvyx1uRruw6JBlC46VdESLOZ/oqEjyhM0UrTxgU59wANcloAH5DmijIRFg2hEdAE/3Ndq6YhBPsvSdx16Wil65JKQI8ri6FzOjs/YiF59Hq4cLLqHetfx1OU7XKTr/Yv/FDs9g4fhVjGL9mKwdLw/ffovlehMRSfI2mSNXj2M7O5YdI+Gt3faojUMZ9Ow6A4WbYUnLoctd4oGRHtg0QPSROdsy4ylJNFpYNF67IoOJ3SuVYsWwaJB3JzoNO9gPy73pykdYNEgKhQdXrQd8bOuUHQgLPoSy+qucOkqDaEQ0Qlh0TGkKFqKbuaViY6ARUtRhujyVXxJBaKVsGhLUhVtV30jomdg0SEognOQYL1UIloBi44FXLRR3hWKDoRFg6BoCQbvdodfJsYoXLQBLFpMpqJts65BtI5WilaenNXVKsGlr1UCzxmCKO7kLLBoaOEsGkQDJ2f7KIpWMzcv7jpAlHJyNl1mThWiGRbbu1/4o1D9WDwM18+PxYiOKdqK2YnZbO9e70sRPaShorcsfxueneVZ8EsMtnePu5el+aF7KxopOv7SKG5dtNXK4MVBVgYvLBpEjaLVRSuInnSNosNg0WFEN+jyVXxJNaKjYdFWJC/apPUGRHtg0QlAFx1Qd1uix2DRIPaiQVXPpH4jovNTg2hdUM4gRwNqEK2DRQ/QlTuFg4Y7SUmi08CiQVD0BWkWDdHSobjBIMoQnZIbLDplt9M4aLiTsGgQdYjWFx2P0S3UIVoDizYnTdFG3bckehwW3SdZa84gRwOKEZ0MFj0NumhE3UWKNoVFz5Cx6FRJlynaEhYNgqJDAC4didaSSkQraKVozA9gZ9E8dC8kwcdIYH64r5hGRLNoIc19jMSAVkRHXxoFRYOgaBA3ILoMXO4JdKQT3enmUMkgigYNpWjQUIoGDaVo0FCKBg2laNBQvWgigqJBUDQIigZB0SAoGgRFg6BoEBQNgqJBaETvvodpcXqRDH0b/df00aHnb3TwDl3e+S/bDV0/7z/eXTB0uf9XE88Mzga8t6UQ/f71ZbP6/aV7kQxdff6xWd6LrrrZ+fPc5nHoq+8L0hs68g0qExOQDt29LD1DNaLfdspeF92LZOjul6vhB36PD1398adHYDd0/d3X6GnoyMe6z8x1J1AydPXl59gn8/dRrtHdXLxTOo/xFX0cuv7+r3fpOAzdf4ePbOjqyz/+pWNznKtkqvsJJC56s9n/lIXzi2Do6kFwn/uhy0f/Gn0YunufC6reD31YbHb9ieYqqecwdPul9nnWie4+lb57kQyVTH8/dKtDIPr8X/au08erSifgX6HPV91+pd98T0PdrmNx8SIZusOn5DD08ND3fAGDr/r+l0D08aqv/nwOQ3dfEe9VFaLDPUtmdL6ct+iLq67/ng/qJM+/dByHClajo4HERXc7TcmG8zhm++pbo8+X84qOuOp2NfUZOQ31L9HHoW/+CfD/DFFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQFA2CokFQNAiKBkHRICgaBEWDoGgQ/wOgwpum7BX4xQAAAABJRU5ErkJggg==" title="plot of chunk ACL" alt="plot of chunk ACL" style="display: block; margin: auto;" /></p>

<pre><code class="r">ACL &lt;- counter/sims * 100
ACL
</code></pre>

<pre><code>[1] 95.08
</code></pre>

<p>The function <code>CIsim()</code> from the <code>PASWR</code> package is used to run a similar simulation below.</p>

<pre><code class="r">require(PASWR)
set.seed(11)
CIsim(samples = 100, n = 30, parameter = 25, sigma = 4, type = &quot;Mean&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAtFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrUAgP85AAA5ADk5AGU5OQA5OTk5OWU5OY85ZmU5ZrU5j485j9plAABlADllAGVlOQBlOY9lZgBlZmVlj49ltdpltf2POQCPOTmPOWWPZgCPZjmPZo+PjzmPj2WPtY+P29qP2/21ZgC1Zjm1tWW124+1/rW1/v3ajznaj4/a24/a29ra/rXa/tra/v39tWX924/9/rX9/tr9/v3/TAwfP41UAAAAPHRSTlP/////////////////////////////////////////////////////////////////////////////AP8FrvlYAAAACXBIWXMAAAsSAAALEgHS3X78AAAQZElEQVR4nO2dDX/bthHGB2e1rKSr19FxumWKu5ekUtZI3VKLMvP9v9fwSgIESAIieKKk5/klkkncHQ5/giCcANIfKohEfzh1AtcigCYSQBMJoIkE0EQCaCIBNJEAmkgATSSAJhJAEwmgiQTQRAJoIgE0kQCaSABNJIAmEkATCaCJBNBEAmgiATSRrgT0/06dQBTolw8r+cpYYb33av9q21V0eGBswd/LJWPs9rnaMcbDl/fPAxEZ+8vb9VBwux5tLVPuT9gydTNdRdQT9mRMJGnaWEWB5mRX4nXB/Yv6vV/dLIS/+FvtF/K4fL0WxpuhNm0WEcE766QFLfnseJb7Julh0Dv23buVBMKbePts3kXRy9NHdrOWl23Fs/205Efyct585LWIrs/tytcfeRfeq26sKYkgGm35Ziv+NB2ahxPRtbeJuuFd5Avn0QpeV+p6aXq6VJxcmCKZ8/ciF37p6tTX4sa6kbjF/VsuV9Xu9uvDexXcdl1bVXRJtlEEtbrPMOjftnLokGw5EvOuchJtFdd982p7eBAd8/ZZdB/xs+y2/LhcLvh9v1BXil834c99Xp6+19dB9OjPdZcSRR/UjSO8TVSBhafeBC9kKFNcexW6BgXaSskUyZwFCe5Sp/5W3lX6TtnxfP9UVJvCdq9d7SokGA2T9yRmrpXqMK/Xpo1xoHU8GZs7m3dVYG7JvQC9ku8yXf4iLwY/KXqHKNM3ourRy5W8vURHFmN0+aPbG/SlNCzk2CJBm+DyneflVKqd1SNF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" title="plot of chunk CIsim" alt="plot of chunk CIsim" style="display: block; margin: auto;" /></p>

<pre><code>6 % of the random confidence intervals do not contain Mu = 25 . 
</code></pre>

<p><strong>Example 7.2</strong> An engineer test the gas mileage of a random sample of \( n = 30 \) of his company cars ready to be sold.  The 95% confidence interval for the mean mileage of all the cars is (29.5, 33.4) miles per gallon.  Evaluate the following statements:</p>

<ol>
<li><p>We are 95% confident that the gas mileage for cars in this company is between 25.5 and 33.4 mpg.</p></li>
<li><p>95% of all samples will give an average mileage between 29.5 and 33.4 mpg.</p></li>
<li><p>There is a 95% chance that the true mean is between 29.5 and 33.4 mpg.</p></li>
</ol>

<p><strong>Solution</strong></p>

<ol>
<li><p>This is not correct:  a confidence interval is for a population parameter, and in this case the mean, not for individuals.</p></li>
<li><p>This is not correct:  each sample will give rise to a different confidence interval  and 95% of these intervals will contain the true mean.</p></li>
<li><p>This is not correct: \( \mu \) is not random. The probability that it is between 29.5 and 33.4 is 0 or 1.</p></li>
</ol>

<p>In our first example, we constructed a 95% confidence interval, but we can use other levels of confidence more generally let \( q \) denote the \( (1 - \alpha/2) \) quantile that satisfies \( P(Z < q) = 1 - \alpha/2 \). Then, by symmetry, \( P(-q < Z < q) = 1 - \alpha \).  We will represent the quantile \( q \) in a standard normal distribution with the notation \( z_{1 - \alpha/2} \).  For example, \( z_{.975}= \) 1.96.  Let \( \bar{X} \) denote the mean of a random sample of size \( n \) from a normal distribution \( N(\mu, \sigma) \).  Then, since \( \bar{X} \sim N(\mu, \sigma/\sqrt{n}) \), by mimicking the previous algebra, we have</p>

<p>\[ \begin{align}
1 - \alpha &= P(z_{\alpha/2} < Z < z_{1 -\alpha/2}) \\
&= P\left( \bar{X} - z_{1 - \alpha/2}\sigma/\sqrt{n}, \bar{X} + z_{1 - \alpha/2}\sigma/\sqrt{n}  \right)
\end{align} \]</p>

<p><strong>Example 7.3</strong>  Suppose the sample 3.4, 2.9, 2.8, 5.1, 6.3, 3.9 is drawn from the normal distribution with unknown \( \mu \) and known \( \sigma = 2.5 \).  Find a 90% confidence interval for \( \mu \).</p>

<p><strong>Solution</strong>  The mean of the six numbers is 4.0667.  Here, \( 1 - \alpha = 0.90 \), so \( \alpha/2 = 0.05 \).  Thus, \( z_{1 - \alpha/2} = z_{0.95} = \)
1.6449.  The 90% confidence interval is </p>

<p>\[ \left(4.0667 - 1.6449 \times \frac{2.5}{\sqrt{6}}, 4.0667 + 1.6449 \times \frac{2.5}{\sqrt{6}} \right) \].</p>

<p>We are 90% confident that the population mean lies in the interval (2.3879, 5.7454).</p>

<pre><code class="r">xs &lt;- c(3.4, 2.9, 2.8, 5.1, 6.3, 3.9)
n &lt;- length(xs)
SIGMA &lt;- 2.5
alpha &lt;- 0.1
LL &lt;- mean(xs) - qnorm(1 - alpha/2) * SIGMA/sqrt(n)
UL &lt;- mean(xs) + qnorm(1 - alpha/2) * SIGMA/sqrt(n)
CI &lt;- c(LL, UL)
CI
</code></pre>

<pre><code>[1] 2.388 5.745
</code></pre>

<pre><code class="r">require(PASWR)  # or use z.test() from PASWR
z.test(x = xs, sigma.x = SIGMA, conf.level = 0.9)$conf
</code></pre>

<pre><code>[1] 2.388 5.745
attr(,&quot;conf.level&quot;)
[1] 0.9
</code></pre>

<p>The term \( z_{1 - \alpha/2}\times \sigma/\sqrt{n} \) is called the <em>margin of error</em> (we abbreviate this as ME).</p>

<p>MARGIN OF ERROR: The margin of error for a symmetric confidence interval is the distance from the estimate to either end.  The confidence interval is of the following form: estimate \( \pm \) ME.</p>

<p><strong>Example 7.4</strong>  Suppose researchers want to estimate the mean weight of girls in Sodor.  They assume that the distribution of weights is normal with unknown mean \( \mu \), but with known \( \sigma =24.6 \).  How many girls should they sample if they want,  with 95% confidence, their margin of error to be at most 5 pounds?</p>

<p><strong>Solution</strong> Since \( z_{1 - \alpha/2} = z_{0.975}= \) 1.96, we set \( 1.96(24.6/\sqrt{n}) \leq 5 \).  This leads to \( n \geq \) 92.9879, so there should be at least 93 girls in the sample.</p>

<pre><code class="r">n &lt;- ceiling((qnorm(0.975) * 24.6/5)^2)
n
</code></pre>

<pre><code>[1] 93
</code></pre>

<p><strong>Remark</strong> Note that with the with of the interval, given by \( z_{1 - \alpha/2}\times(\sigma/\sqrt{n}) \), depends on the level of confidence (which determines \( z_{1-\alpha/2} \)), the standard deviation,  and the sample size.  Analysts cannot control \( \sigma \),  but can adjust \( z_{1 - \alpha/2} \) or \( n \). To make the confidence interval narrower, they can either increase the sample size \( n \) or decrease  the size of the quantile \( z_{1-\alpha/2} \), which amounts to decreasing  the confidence level.</p>

<p><strong>7.1.2 Confidence Intervals for a Mean, \( \sigma \) Unknown</strong></p>

<p>In most real-life settings,  a data analyst  will not know the mean or the standard deviation of the population of interest.  How then would we get an interval estimate of the mean \( \mu \)?  we have used  the sample mean \( \bar{X} \) as an estimate  of \( \mu \), so it seems natural to consider the sample standard deviation \( S \) as an estimate of \( \sigma \). </p>

<p>However, in deriving the confidence interval for \( \mu \), we used the fact that \( (\bar{X} - \mu)/(\sigma/\sqrt{n}) \) follows a standard normal distribution. Does changing \( \sigma \) to \( S \), the sample standard deviation, change  the distribution? Who uses simulation to investigate the distribution of \( (\bar{X} - \mu)/(\sigma/\sqrt{n}) \) for random samples drawn from a \( N(\mu, \sigma) \).</p>

<pre><code class="r">set.seed(1)
N &lt;- 10^4
TS &lt;- numeric(N)
n &lt;- 16
for (i in 1:N) {
    x &lt;- rnorm(n, 25, 7)
    xbar &lt;- mean(x)
    s &lt;- sd(x)
    TS[i] &lt;- (xbar - 25)/(s/sqrt(n))
}
par(mfrow = c(1, 2))
hist(TS, breaks = &quot;Scott&quot;, freq = FALSE, col = &quot;pink&quot;, main = &quot;&quot;, xlab = expression(t))
qqnorm(TS, col = rgb(1, 0, 0, 0.1))
abline(a = 0, b = 1)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAEgCAMAAABvm5EPAAAA+VBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlZgBlZjlltf2POQCPOTmPZgCPj2WP29qP2/21ZgC1tWW124+1/rW1/v3ajznatWXa24/a/rXa/v39BAT9BQX9Bgb9Bwf9CAj9CQn9Cgr9Cwv9DAz9DQ39Dw/9ERH9ExP9FRX9Fxf9Ghr9HR39ICD9JCT9KCj9LS39MjL9ODj9Pj79RUX9TU39Vlb9YGD9a2v9d3f9hYT9lJP9paT9tWX9tY/9uLf9zcz924/929r95OP9/rX9/tr9/v3/wMtikDKRAAAAU3RSTlP///////////////////////////////////////////////////////////////////////////////////////////////////////////8A/9ivbKYAAAAJcEhZcwAACxIAAAsSAdLdfvwAABDHSURBVHic7Z2JX+M2FoBr2KUw7WyYaRdmt2S7ZKdkypwtzMExQAg51s46eP7/P2b1JDs4wZYlW7JfrPf9uBLb8jNfdNiW5O8iwkm+azoAohlIvKOQeEch8Y5C4h2FxDsKiXcUEu8oJN5RSLyjkHhHIfGOQuIdhcQ7Col3FBLvKCTeUUi8o5B4RyHxjkLiHYXEOwqJdxQS7ygk3lFIvGHmu95eFN3vbx4qrZysdr/ved7W0WLJ0muWJrCXWp/T3SsfJ4k3DJPEfOmKn+1wtRsH8YLl17H4jYNl8V2PxOMBJHVi8T0P/mYvNv7ubfzT+37f2zzsQc6NpsJqIpLl7+0ITMZ5fOX1fBd+d72OWF8ky8uE7dJxknjDMDc/bx5y8V2eT7fjYvs/XsLmocjCW0eJ+NkON8w+ISKLr7xeFh8nS+Jxwdz8utMB8bMdnqc3DkT+nXrwlrcH78QrHibip7HBpPBeeb1U1C+SpaIeFeCmu/ELEy/s9bw9kXHhJSwUr8Blpnio3VnpkCE+rhoWyZJ4VIiM/H2e+K0jeCXabg/iedHe3YYzAi7+5cNrkWZc95N4vHCXPc9bKupXxfdY42y28yCeVwagPG60r7xeEk9FPU64y3tov6cad6vip95yjk9O3+AcIOP1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" title="plot of chunk TS" alt="plot of chunk TS" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(mfrow = c(1, 1))
</code></pre>

<p>This distribution does have slightly longer tails than the normal distribution; you could never tell this from a histogram, but it is apparent in the normal quantile plot.  Sometimes \( S \) is smaller than \( \sigma \), and when the denominator is small, the ratio is large.  In effect, having to estimate \( \sigma \) using \( S \) adds variability.</p>

<p>It turns out that \( T = (\bar{X} - \mu)/(S/\sqrt{n}) \) has a Students \( t \) distribution with \( n-1 \) degrees of freedom.  </p>

<p>The density of a \( t \) distribution with \( k \) degrees of freedom is bell shaped and symmetric about 0, with heavier (longer) tails than that of the standard normal.  As \( k \) tends toward infinity, the density of the \( t \) distribution tends toward the density of the standard normal.  </p>

<pre><code class="r">curve(dnorm(x, 0, 1), -4, 4, col = &quot;black&quot;, ylab = &quot;&quot;, xlab = &quot;&quot;)
curve(dt(x, 1), add = TRUE, lty = 2, col = &quot;green&quot;)
curve(dt(x, 4), add = TRUE, lty = 3, col = &quot;pink&quot;)
curve(dt(x, 9), add = TRUE, lty = 4, col = &quot;red&quot;)
curve(dt(x, 36), add = TRUE, lty = 5, col = &quot;blue&quot;)
abline(h = 0, lwd = 2)
legend(&quot;topright&quot;, legend = c(&quot;N(0, 1)&quot;, &quot;t_1&quot;, &quot;t_4&quot;, &quot;t_9&quot;, &quot;t_36&quot;), lty = c(1, 2, 3, 4, 5), col = c(&quot;black&quot;, 
    &quot;green&quot;, &quot;pink&quot;, &quot;red&quot;, &quot;blue&quot;), lwd = 1.5)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAgVBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOY8AZrUA/wA5AAA5ADk5AGU5OWU5OY85j7U5j9plAABlADllAGVlOQBlOY9ltf2POQCPOTmPZgCPj7WPtY+P29qP2/21ZgC1ZmW1tWW1/v3ajzna24/a/v39tWX924/9/rX9/tr9/v3/AAD/wMuZphT4AAAAK3RSTlP/////////////////////////////////////////////////////AP//sFN8sAAAAAlwSFlzAAALEgAACxIB0t1+/AAAFeZJREFUeJztnQubmziWhoeONzk1Pb2V7pmkZ2eSndSmXIX9/3/gWlwFCJBAlyOd732eutiYI+C1dCQB9l9qIJK/pN4AkAaIFwrECwXihQLxQoF4oUC8UCBeKBAvFIgXCsQLBeKFAvFCgXihQLxQIF4oEC8UiBcKxAsF4oUC8UKBeKFAvFAgXigQLxSIFwrECwXihQLxQoF4oUC8UCBeKBAvFIgXCsQLBeKFAvFCgXihQLxQIF4oEC8UiBcKxAsF4oUC8UKBeKFAvFAgXigQLxSIFwrECwXihQLxQoF4oUC8UCBeKBAvFIgXyhnxFeBMQPEn1gUaQQ4kxPMH4oUC8UJhLP766w/n0MAWluLfPnedxA8L9RDvCZbiH+YfylHjQ8JTvFL/8f8gPiBcxT9S/NOyoYd4b/AVfyg0sAXiheJwIK9PX+pukPXyrHreH39qCx9PX3/7aRXUWvzbH0NjbzkbDGxxEq+Sbmf4/euX+uXTsOy1GXk93g82QVHjO1K+kV3E//qfT63471+ayjiOt77/8i/1f19DId6GVnoq91qpeyfaHp4fxh+/G+mPZv3t92/6wsfv71/mQU3si78+rczfFCS+MvyXpPhdlPJ//Hz8VtJfP5rEd239WfEqjyhe9V6E8/byRu3IRVGn2Sk38Q+zj9/Kh7nGexLfpwytc3dge1lTKe3tv5cke+Uo/v3Pf7U1fprjUeMdqRrfHUnMO4pvuvZK+vvXZ71X7znHd2dpis3xs7141P3o++Uqvn750PTqu3H8UOmv6NXbU2nVveXCWfzIMFNT1/+rV0qM4+2o5t7r+FX+WHm94fr9f7Rnvc/cGShB/LLCJ6jymKuPju79dtOejrwV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" title="plot of chunk tdfs" alt="plot of chunk tdfs" style="display: block; margin: auto;" /></p>

<p>We derive the confidence interval for \( \mu \) when \( \sigma \) is unknown in the same way as when \( \sigma \) is known.  Let \( t_{1 - \alpha/2; n-1} \) denote the \( (1 - \alpha/2) \) quantile of the \( t \) distribution with \( n - 1 \) degrees of freedom, \( P(T_{n-1} < t_{1-\alpha/2; n-1}) =1 - \alpha/2, 0 < \alpha <1 \). Then using symmetry of the \( t \) distribution, we have</p>

<p>\[ 
\begin{align}
1 - \alpha &= P\left(-t_{1 - \alpha/2; n-1} < \frac{\bar{X} - \mu}{S/\sqrt{n}} < t_{1 - \alpha/2; n-1}  \right) \\
&=  P\left(\bar{X}-t_{1 - \alpha/2; n-1}\times \frac{S}{\sqrt{n}} < \mu < \bar{X} + t_{1 - \alpha/2; n-1} \times \frac{S}{\sqrt{n}}  \right)
\end{align}
 \]</p>

<p><strong>\( T \) CONFIDENCE INTERVAL FOR NORMAL MEAN WITH UNKNOWN STANDARD DEVIATION</strong>
If \( X_i \sim N(\mu, \sigma), i = 1, \ldots, n, \) with \( \sigma \) unknown, then a \( (1 - \alpha)\times 100\% \) confidence interval for \( \mu \) is given by</p>

<p>\[ 
CI_{1 - \alpha}(\mu) = \left(\bar{X}-t_{1 - \alpha/2; n-1}\times \frac{S}{\sqrt{n}},  \bar{X} +t_{1 - \alpha/2; n-1}\times \frac{S}{\sqrt{n}}  \right)
 \]</p>

<p><strong>Example 7.5</strong> The distribution of weights of boys in Sodor is normal with unknown mean \( \mu \).  From a random sample of 28 boys, we find a sample mean of 110 pounds and a sample standard deviation of 7.5 pounds.  To compute a 90% confidence interval, find the 0.95 quantile of the \( t \) distribution with 27 degrees of freedom, which is 1.7033 using the command <code>qt(0.95, 27)</code>. The interval is \( (110 - 1.7033*7.5/\sqrt{28}, 110 + 1.7033*7.5/\sqrt{28}) \); thus we are 90% confident that the true mean weight is between 107.6 and 112.4 pounds.</p>

<p><strong>R Note:</strong></p>

<p>The command <code>pt</code> or <code>qt</code> give probabilities or quantiles, respectively, for the \( t \) distribution.  For instance, to find \( P(T_{27} < 2.8) \) for the random variable \( T_{27} \) from a \( t \) distribution with 27 degrees of freedom,</p>

<pre><code class="r">pt(2.8, 27)
</code></pre>

<pre><code>[1] 0.9953
</code></pre>

<p>To find the quantile \( t_{.95; 27} \) satisfying \( P(T_{27} < t_{.95; 27}) = 0.95 \), </p>

<pre><code class="r">qt(0.95, 27)
</code></pre>

<pre><code>[1] 1.703
</code></pre>

<pre><code class="r"># 
require(PASWR)
tsum.test(mean.x = 110, s.x = 7.5, n.x = 28, conf.level = 0.9)$conf
</code></pre>

<pre><code>[1] 107.6 112.4
attr(,&quot;conf.level&quot;)
[1] 0.9
</code></pre>

<p>Compare the 0.95 quantile for a \( t \) distribution with 27 degrees of freedom with that of the standard normal: 1.7033 versus 1.6449.  Thus, the \( t \) interval is slightly wider than the \( z \) interval, reflecting, as we noted previously, the extra uncertainty in not knowing the true \( \sigma \).</p>

<p><strong>Example 7.6</strong> Find a 99% confidence interval for the mean weight of baby girls born in North Carolina in 2004.</p>

<p><strong>Solution</strong> The mean and standard deviation of the weights of \( n = \) 521 girls is 3398.3167 and 485.6911g, respectively. A normal quantile plot shows that the weights are approximately normally distributed, so a \( t \) interval is reasonable.</p>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/NCBirths2004.csv&quot;
NCBirths2004 &lt;- read.csv(file = url(site))
MEANS &lt;- tapply(NCBirths2004$Weight, NCBirths2004$Gender, mean)
SD &lt;- tapply(NCBirths2004$Weight, NCBirths2004$Gender, sd)
MEANS
</code></pre>

<pre><code>Female   Male 
  3398   3502 
</code></pre>

<pre><code class="r">SD
</code></pre>

<pre><code>Female   Male 
 485.7  484.8 
</code></pre>

<pre><code class="r">qqnorm(NCBirths2004$Weight[NCBirths2004$Gender == &quot;Female&quot;], main = &quot;&quot;, col = rgb(1, 0, 0, 0.2))
qqline(NCBirths2004$Weight[NCBirths2004$Gender == &quot;Female&quot;], col = &quot;blue&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAAAw1BMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlZgBltf2POQCPOTmPOWWPZgCPtY+P29qP2/21ZgC1tWW124+1/rW1/v3ajzna24/a/rXa/v39BAT9BQX9Bgb9Bwf9CQn9Cwv9Dg79EhL9Fhb9Gxv9IiL9Kir9NTX9QkL9U1P9aGj9goL9oqL9tWX9tY/9y8r924/929r9/rX9/tr9/v1TXgi6AAAAQXRSTlP/////////////////////////////////////////////////////////////////////////////////////ADBV7McAAAAJcEhZcwAACxIAAAsSAdLdfvwAAA/hSURBVHic7Z2LYtu4EUVHDlonm6a1N9tk+7DaRrvZta03H6AL1eb/f1UBkJQlmZJAkcSAGJxEdmzR0Oh6MrgAQRDygBUAOwAqAHYAVADsAKgA2AFQAbADoAJgB0AFwA6ACoAdABUAOwAqAHYAVADsAKgA2AFQAbADoAJgB0AFwA6ACoAdABUAOwAqAHYAVADsAKgA2AFQAbADoAJgB0AFwA6ACoAdABUAOwAqAHYAVADsAKgA2AFQAbADoAJgB0AFwA6ACoAdABUAOwAqAHYAVADsAKgA2AFQAbADoAJgB0AFwA6ACoAdABUAOwAqAHYAVADsAKgA2AFQAbADoAJgB0AFwA6ACoAdABUAOwAqAHYAVADsAKgA2AFQAbADoAJgB0AFwA6ACoAdABUAOwAqAHYAVIAWPzsK7NKj0C1+1j+C0JYIQluitdCbD7oCvfvWtGlitBX65esX/fnp+nvDponRVujnz9/2Pps3TQEhRPXPkNE9IsqHonWNfr4NNfoYnQp9nCB0ENoWHdboYO8MCZ2hJYK9s0TIaEsEe2eJ4DoswU4/DRc0aTjVTQsW7J0NGAudoQ1U2Qj2rn90eQ4Z3S07g+6KohsM9q5TdqeRClhpN4K96wqdy2+E3rq6IHRHFBIfCv3qnrvoDFX1eFuiSQq9X6PZziilA6G14dj8+c1TJIXeZW8w2IHQm0/fg72r8Rv7g+7WQt9e/fNvKqM/EbZ3NZ7uzeRG+87w5evo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" title="plot of chunk QQs" alt="plot of chunk QQs" style="display: block; margin: auto;" /></p>

<pre><code class="r">require(lattice)
qqmath(~Weight | Gender, data = NCBirths2004, col = rgb(1, 0, 0, 0.1))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk QQs" alt="plot of chunk QQs" style="display: block; margin: auto;" /></p>

<pre><code class="r">require(ggplot2)
ggplot(data = NCBirths2004, aes(sample = Weight)) + stat_qq(color = rgb(1, 0, 0, 0.1)) + facet_grid(. ~ 
    Gender)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk QQs" alt="plot of chunk QQs" style="display: block; margin: auto;" /></p>

<p>Since \( 1 - \alpha = 0.99 \), it follows that \( \alpha/2 = 0.005 \).  The 0.995 quantile for the \( t \) distribution with 520 degrees of freedom is \( t_{0.995; 520}= \) 2.5853.  Thus, the 99% confidence interval is 3398.3167\( \pm \) 2.5853\( \times \) 485.6911 \( /\sqrt{521} = \) (3343.305, 3453.3284) g.</p>

<p><strong>R Note:</strong></p>

<p>Use the command <code>t.test()</code> to find confidence intervals.</p>

<pre><code class="r">girls &lt;- subset(NCBirths2004, select = Weight, subset = Gender == &quot;Female&quot;, drop = TRUE)
t.test(girls, conf.level = 0.99)$conf
</code></pre>

<pre><code>[1] 3343 3453
attr(,&quot;conf.level&quot;)
[1] 0.99
</code></pre>

<pre><code class="r"># Or
t.test(NCBirths2004$Weight[NCBirths2004$Gender == &quot;Female&quot;], conf = 0.99)$conf
</code></pre>

<pre><code>[1] 3343 3453
attr(,&quot;conf.level&quot;)
[1] 0.99
</code></pre>

<p><strong>Assumptions</strong> With any statistical procedure, one of the first questions to ask is, How robust is it?  That is, what happens if the assumptions underlying the procedure are violated? The \( t \) confidence interval assumes that the underlying populations is normal, so what happens if that is not the case?</p>

<p>When the population has a normal distribution, the \( t \) interval is exact: a \( (1 - \alpha)\times 100\%) \) interval covers \( \mu \) with probability \( 1 - \alpha \) or, equivalently, misses \( \mu \) on either side with probability \( \alpha/2 \); that is, the interval is completely above \( \mu \) with probability \( \alpha/2 \) or is completely below with probability \( \alpha/2 \).</p>

<p>Let us check this for a nonnormal population by running a simulation.</p>

<p><strong>Example 7.7</strong> We draw random samples from the right-skewed gamma distribution with \( \alpha = 5 \) and \( \lambda = 2 \) and count the number of times the 95% confidence interval misses the mean \( \mu = 5/2 \) on each side.</p>

<pre><code class="r">set.seed(13)
tooLow &lt;- 0  # set counter to 0
tooHigh &lt;- 0  # set counter to 0
n &lt;- 20  # sample size
q &lt;- qt(0.975, n - 1)
N &lt;- 10^5
for (i in 1:N) {
    x &lt;- rgamma(n, shape = 5, rate = 2)
    xbar &lt;- mean(x)
    s &lt;- sd(x)
    L &lt;- xbar - q * s/sqrt(n)
    U &lt;- xbar + q * s/sqrt(n)
    if (U &lt; 5/2) {
        tooLow &lt;- tooLow + 1
    }
    if (L &gt; 5/2) {
        tooHigh &lt;- tooHigh + 1
    }
}
TL &lt;- tooLow/N * 100
TH &lt;- tooHigh/N * 100
c(TL, TH)
</code></pre>

<pre><code>[1] 4.340 1.328
</code></pre>

<p>What proportion of the times did the confidence intervals miss the true mean 5/2?  In one run of this simulation, about 4.34% of the time, the interval was too low and was below 5/2, and about 1.328% of the time, the interval was too high and was above 5/2.</p>

<p>When the population is nonnormal but symmetric and the sample size is moderate or large, the \( t \) interval is very accurate.  The main weakness of the \( t \) confidence interval occurs when the population is skewed.  The simulation illustrated this problem.  To see this from another point of view, we will look at the distributions of the \( t \) statistics, \( T = (\bar{X} - \mu)/(S/\sqrt{n}) \), since accuracy of \( t \) intervals depends on how close the \( t \) statistic is to having a \( t \) distribution.  </p>

<pre><code class="r">set.seed(13)
n &lt;- 10  # sample size
q &lt;- qt(0.975, n - 1)
N &lt;- 10^5
TSU &lt;- numeric(N)
for (i in 1:N) {
    x &lt;- runif(n, 0, 1)
    xbar &lt;- mean(x)
    s &lt;- sd(x)
    TSU[i] &lt;- (xbar - 0.5)/(s/sqrt(n))
}
TSE10 &lt;- numeric(N)
for (i in 1:N) {
    x &lt;- rexp(n, 1)
    xbar &lt;- mean(x)
    s &lt;- sd(x)
    TSE10[i] &lt;- (xbar - 1)/(s/sqrt(n))
}
n &lt;- 100
TSE100 &lt;- numeric(N)
for (i in 1:N) {
    x &lt;- rexp(n, 1)
    xbar &lt;- mean(x)
    s &lt;- sd(x)
    TSE100[i] &lt;- (xbar - 1)/(s/sqrt(n))
}
# 
n &lt;- 10
qqmath(~TSU, col = &quot;red&quot;, xlim = c(-3, 3), ylim = c(-3, 3), distribution = function(p) {
    qt(p, df = n - 1)
}, xlab = &quot;Theoretical t quantiles&quot;, ylab = &quot;Sample quantiles&quot;, main = &quot;Uniform, n = 10&quot;, panel = function(x, 
    ...) {
    panel.qqmath(x, pch = &quot;.&quot;, ...)
    panel.abline(a = 0, b = 1, ...)
})
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk taccurate" alt="plot of chunk taccurate" style="display: block; margin: auto;" /></p>

<pre><code class="r"># 
qqmath(~TSE10, col = &quot;red&quot;, xlim = c(-3, 3), ylim = c(-3, 3), distribution = function(p) {
    qt(p, df = n - 1)
}, xlab = &quot;Theoretical t quantiles&quot;, ylab = &quot;Sample quantiles&quot;, main = &quot;Exponential, n = 10&quot;, panel = function(x, 
    ...) {
    panel.qqmath(x, pch = &quot;.&quot;, ...)
    panel.abline(a = 0, b = 1, ...)
})
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk taccurate" alt="plot of chunk taccurate" style="display: block; margin: auto;" /></p>

<pre><code class="r"># 
n &lt;- 100
qqmath(~TSE100, col = &quot;red&quot;, xlim = c(-3, 3), ylim = c(-3, 3), distribution = function(p) {
    qt(p, df = n - 1)
}, xlab = &quot;Theoretical t quantiles&quot;, ylab = &quot;Sample quantiles&quot;, main = &quot;Exponential, n = 100&quot;, panel = function(x, 
    ...) {
    panel.qqmath(x, pch = &quot;.&quot;, ...)
    panel.abline(a = 0, b = 1, ...)
})
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk taccurate" alt="plot of chunk taccurate" style="display: block; margin: auto;" /></p>

<pre><code class="r"># 
</code></pre>

<pre><code class="r">DF &lt;- data.frame(TSU, TSE10, TSE100)
p &lt;- ggplot(data = DF, aes(sample = TSU)) + stat_qq(distribution = qt, dparams = list(df = 9), pch = &quot;.&quot;, 
    color = rgb(1, 0, 0, 0.01)) + xlim(-3, 3) + ylim(-3, 3) + xlab(&quot;Theoretical t quantiles&quot;) + ylab(&quot;Sample quantiles&quot;) + 
    ggtitle(&quot;Uniform, n = 10&quot;)
p + geom_abline(intercept = 0, slope = 1, color = &quot;gray&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk ggplots" alt="plot of chunk ggplots" style="display: block; margin: auto;" /></p>

<pre><code class="r"># 
p &lt;- ggplot(data = DF, aes(sample = TSE10)) + stat_qq(distribution = qt, dparams = list(df = 9), pch = &quot;.&quot;, 
    color = rgb(1, 0, 0, 0.01)) + xlim(-3, 3) + ylim(-3, 3) + xlab(&quot;Theoretical t quantiles&quot;) + ylab(&quot;Sample quantiles&quot;) + 
    ggtitle(&quot;Exponential, n = 10&quot;)
p + geom_abline(intercept = 0, slope = 1, color = &quot;gray&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk ggplots" alt="plot of chunk ggplots" style="display: block; margin: auto;" /></p>

<pre><code class="r"># 
p &lt;- ggplot(data = DF, aes(sample = TSE100)) + stat_qq(distribution = qt, dparams = list(df = 99), pch = &quot;.&quot;, 
    color = rgb(1, 0, 0, 0.01)) + xlim(-3, 3) + ylim(-3, 3) + xlab(&quot;Theoretical t quantiles&quot;) + ylab(&quot;Sample quantiles&quot;) + 
    ggtitle(&quot;Exponential, n = 100&quot;)
p + geom_abline(intercept = 0, slope = 1, color = &quot;gray&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk ggplots" alt="plot of chunk ggplots" style="display: block; margin: auto;" /></p>

<p>The previous graphs compare the distribution of \( t \) statistics for samples of size \( n = 10 \)  from a uniform distribution,  size \( n = 10 \)  from an exponential distribution,  and size \( n = 100 \)  from an exponential distribution to the \( t \) distribution. The range on all plots is truncated so that we can focus on the range of values important for confidence intervals. Notice that for  the uniform population,  the distribution of the \( t \) statistic is close to the  \( t \) distribution, except in the tails.  For exponential populations, the discrepancy  is much larger, and the discrepancy decreases only slowly as the sample size increases.  To reduce the discrepancy (the difference between actual and nominal  probabilities) by a factor of 10  requires a sample size 100 times larger. For an exponential population, we must have \( n > 5000 \)  before the actual probabilities of a 95% \( t \) interval  missing the true mean in either tail are within 10% of the desired probability of 2.5%;  that is,  the actual tail probabilities are between 2.25% and  2.75%.</p>

<p>Before using  a \( t \) confidence interval,  you should create a normal quantile plot  to see whether the data are skewed. The larger the sample size, the more skew can be tolerated. There are skewness adjusted versions of \( t \) intervals including bootstrap \( t \) intervals that we cover later. However, be particularly careful with outliers:  since \( \bar{x} \) is sensitive to extreme values, outliers can have a big impact on confidence intervals   a bigger impact than skewness. If you have outliers in your data, you should investigate: are these recording errors or observations that are not representative of the population? If the former, correct them; and if the latter,  remove them. If the outliers cannot be removed, then advanced,  more robust techniques may be required.</p>

<h3>7.1.3 Confidence Intervals for a Difference in Means</h3>

<p>Let \( X \) and \( Y \) be random variables with \( X \sim N(\mu_1, \sigma_1) \) and \( Y \sim N(\mu_2, \sigma_2) \). Then \( X - Y \sim N \left(\mu_1 - \mu_2, \sqrt{\sigma_1^2 + \sigma_2^2} \right) \)  For samples sizes \( n_1 \) and \( n_2 \),</p>

<p>\[ \bar{X} - \bar{Y} \sim N \left(\mu_1 - \mu_2, \sqrt{\sigma_1^2/n_1 + \sigma_2^2/n_2}\right) \]</p>

<p>Of course, in practice we usually do not know the population variances, so we will plug in the sample variances.  As in the single-sample case, we call this a \( t \) statistics:</p>

<p>\[ T = \frac{(\bar{X} - \bar{Y}) - (\mu_X - \mu_Y)}{\sqrt{S_X^2/n_X + S_Y^2/n_Y}} \]</p>

<p>The exact distribution of this statistic is a n unsolved problem.  It does, however, have approximately a \( t \) distribution if the populations are normal.  The difficult part is the degrees of freedom.  The degrees of freedom are given with Welch&#39;s approximation:</p>

<p>\[ \nu = \frac{(s_X^2/n_x + s_Y^2/n_Y)^2}{(s_X^2/n_X)^2/(n_X - 1) + (S_Y^2/n_Y)^2/(n_Y -1)}. \]</p>

<p><strong>\( T \) CONFIDENCE INTERVAL FOR DIFFERENCE  IN MEANS</strong>
If \( X_i \sim N(\mu_X, \sigma_X), i = 1, \ldots, n_X, \) and \( Y_j \sim N(\mu_Y, \sigma_Y), j = 1, \ldots, n_Y, \)  then an approximate \( (1 - \alpha)\times 100\% \) confidence interval for \( \mu_X - \mu_Y \) is given by</p>

<p>\[ 
CI_{1 - \alpha}(\mu_X - \mu_Y) = \left(\bar{X} - \bar{Y} - t_{1 - \alpha/2; \nu}\times \sqrt{\frac{S_X^2 + S_Y^2}{n_X + n_Y}},  \bar{X} - \bar{Y} + t_{1 - \alpha/2; \nu}\times \sqrt{\frac{S_X^2 + S_Y^2}{n_X + n_Y}}  \right)
 \]</p>

<p><strong>Example 7.8</strong></p>

<pre><code class="r">require(PASWR)
require(ggplot2)
</code></pre>

<p>Construct a 90% confidence interval for \( \mu_X - \mu_Y \) using the information in <code>Calculus</code> which provides the assessment scores for students enrolled in a biostatistics course according to whether they had completed a calculus course prior to enrolling in the biostatistics course. Before constructing a confidence interval, one should verify the assumptions needed to have a valid confidence interval.  In this case we need to check for normality of both samples.</p>

<pre><code class="r">ggplot(data = Calculus, aes(sample = Calculus$No.Calculus)) + stat_qq() + ggtitle(&quot;No Calculus&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk NORMALITY" alt="plot of chunk NORMALITY" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = Calculus, aes(sample = Calculus$Yes.Calculus)) + stat_qq() + ggtitle(&quot;Yes Calculus&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk NORMALITY" alt="plot of chunk NORMALITY" style="display: block; margin: auto;" /></p>

<p>For the \( n_X = 18 \) students who had no calculus, the mean and standard deviation of their course scores are \( \bar{x}= \) 62.6111, and \( s_X = \) 13.2227. For the \( n_Y = 18 \) students who had calculus, the mean and standard deviation of their course scores are \( \bar{y}= \) 86.9444, and \( s_Y = \) 4.3178. The mean difference is \( \bar{x} -\bar{y}= \) -24.3333 with the standard error of the difference of 3.2786 and degrees of freedom are 20.5848.  The 0.95 quantile of the \( t \) distribution with 20.5848 degrees of freedom is 1.7223.  Thus, the 90% confidence interval is \( -24.333 \pm 1.7233 \times 3.2786 = (-29.9802, -18.6865) \).</p>

<p><strong>R Note:</strong></p>

<pre><code class="r">t.test(Calculus$No.Calculus, Calculus$Yes.Calculus, conf.level = 0.9)
</code></pre>

<pre><code>
    Welch Two Sample t-test

data:  Calculus$No.Calculus and Calculus$Yes.Calculus
t = -7.422, df = 20.59, p-value = 3.04e-07
alternative hypothesis: true difference in means is not equal to 0
90 percent confidence interval:
 -29.98 -18.69
sample estimates:
mean of x mean of y 
    62.61     86.94 
</code></pre>

<pre><code class="r">t.test(Calculus$No.Calculus, Calculus$Yes.Calculus, conf.level = 0.9)$conf.int
</code></pre>

<pre><code>[1] -29.98 -18.69
attr(,&quot;conf.level&quot;)
[1] 0.9
</code></pre>

<p><strong>Remark</strong></p>

<ul>
<li>If the confidence interval for the difference in means contains 0, then we cannot rule out the possibility that the means might be the same, \( \mu_X - \mu_Y = 0 \) or, equivalently, \( \mu_X = \mu_Y \).</li>
<li>Skewness is less of an issue for the two-sample \( t \) confidence intervals than for one-sample intervals, because the skewness from the two samples tends to cancel out.  In particular, if the populations have the same skewness and variance and the sample sizes are equal, then the skewness cancels out exactly, and the distribution of \( t \) statistics can be very close to a \( t \) distribution even for quite small samples.</li>
</ul>

<p><strong>Example 7.9</strong>  Consider the weights of boy and girl babies born in Texas in 2004.  Construct a 95% \( t \) confidence interval for the mean difference in weights (boys - girls).</p>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/TXBirths2004.csv&quot;
Texas &lt;- read.csv(file = url(site))
ggplot(data = Texas, aes(x = Weight)) + geom_histogram() + facet_grid(Gender ~ .)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Texas" alt="plot of chunk Texas" style="display: block; margin: auto;" /></p>

<pre><code class="r">ggplot(data = Texas, aes(sample = Weight)) + stat_qq() + facet_grid(Gender ~ .)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk Texas" alt="plot of chunk Texas" style="display: block; margin: auto;" /></p>

<pre><code class="r">t.test(Texas$Weight ~ Texas$Gender)
</code></pre>

<pre><code>
    Welch Two Sample t-test

data:  Texas$Weight by Texas$Gender
t = -4.193, df = 1553, p-value = 2.908e-05
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -170.12  -61.68
sample estimates:
mean in group Female   mean in group Male 
                3221                 3337 
</code></pre>

<pre><code class="r">str(Texas)
</code></pre>

<pre><code>&#39;data.frame&#39;:   1587 obs. of  8 variables:
 $ ID        : int  1 2 3 4 5 6 7 8 9 10 ...
 $ MothersAge: Factor w/ 7 levels &quot;15-19&quot;,&quot;20-24&quot;,..: 2 2 3 3 1 4 4 3 6 3 ...
 $ Smoker    : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ Gender    : Factor w/ 2 levels &quot;Female&quot;,&quot;Male&quot;: 2 2 1 1 1 1 2 1 2 1 ...
 $ Weight    : int  3033 3232 3317 2560 2126 2948 3884 2665 3714 2977 ...
 $ Gestation : int  39 40 37 36 37 38 39 38 40 37 ...
 $ Number    : int  1 1 1 1 1 1 1 1 1 1 ...
 $ Multiple  : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">Texas &lt;- within(data = Texas, expr = {
    Gender &lt;- factor(Gender, levels = c(&quot;Male&quot;, &quot;Female&quot;))
})
str(Texas)
</code></pre>

<pre><code>&#39;data.frame&#39;:   1587 obs. of  8 variables:
 $ ID        : int  1 2 3 4 5 6 7 8 9 10 ...
 $ MothersAge: Factor w/ 7 levels &quot;15-19&quot;,&quot;20-24&quot;,..: 2 2 3 3 1 4 4 3 6 3 ...
 $ Smoker    : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ Gender    : Factor w/ 2 levels &quot;Male&quot;,&quot;Female&quot;: 1 1 2 2 2 2 1 2 1 2 ...
 $ Weight    : int  3033 3232 3317 2560 2126 2948 3884 2665 3714 2977 ...
 $ Gestation : int  39 40 37 36 37 38 39 38 40 37 ...
 $ Number    : int  1 1 1 1 1 1 1 1 1 1 ...
 $ Multiple  : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">t.test(Texas$Weight ~ Texas$Gender)
</code></pre>

<pre><code>
    Welch Two Sample t-test

data:  Texas$Weight by Texas$Gender
t = 4.193, df = 1553, p-value = 2.908e-05
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
  61.68 170.12
sample estimates:
  mean in group Male mean in group Female 
                3337                 3221 
</code></pre>

<p><strong>7.4 CONFIDENCE ITERVALS FOR PROPORTIONS</strong></p>

<p>In 2010, according to an AP-Gfk Poll conducted on October 13-18, 59% of 846 likely voters responded that they felt things in this country were heading in the wrong direction <a href="http:www.ap-gfkpoll.com/poll.archive.html">(http:www.ap-gfkpoll.com/poll.archive.html)</a>.  Let \( X \) denote the number of likely voters in a sample of size \( n \) who think the country is headed in the wrong direction.  We assume \( X \) is binomial, \( X \sim Bin(n, p) \).  We know that the proportion of likely voters, \( \hat{p} =X/n \) is an unbiased estimator of \( p \) and for large \( n \), \( Z = (\hat{p} - p)/\sqrt{p(1-p)} \) is approximately standard normal.  Thus,</p>

<p>\[  P\left(-z_{1- \alpha/2}< \frac{\hat{p} - p}{\sqrt{p(1-p)/n}} < z_{1 - \alpha/2}  \right) \approx 1 - \alpha \]</p>

<p>Isolating the \( p \) in this expression requires a bit more of algebra than the earlier problems.  We set</p>

<p>\[ -z_{1 - \alpha/2} =\frac{\hat{p} - p}{\sqrt{p(1-p)/n}}  \]</p>

<p>and solve for \( p \) (we get the same answer if we had set the right-hand side of the above to \( z_{1 - \alpha/2} \)).  This leads to the quadratic equation</p>

<p>\[ \left(z_{1-\alpha/2}^2 + n \right)p^2 -\left( 2n\hat{p} + z_{1-\alpha/2} \right)p +  n\hat{p}^2  \]</p>

<p>Using the quadratic formula to solve for \( p \) gives a \( (1 - \alpha) \) 100% confidence interval (\( L \), \( U \)), where</p>

<p>\[ L = \frac{\hat{p} + z_{1-\alpha/2}^2/(2n) - z_{1-\alpha/2}\sqrt{\hat{p}(1 - \hat{p})/n + z_{1- \alpha/2}^2/(4n^2)}}{1 - z_{1 - \alpha/2}^2/n}, \]</p>

<p>\[ U = \frac{\hat{p} + z_{1-\alpha/2}^2/(2n) + z_{1-\alpha/2}\sqrt{\hat{p}(1 - \hat{p})/n + z_{1- \alpha/2}^2/(4n^2)}}{1 - z_{1 - \alpha/2}^2/n}. \]</p>

<p>Thus for a 90% confidence interval using \( \hat{p}=0.59 \) and \( n=846 \) we have</p>

<p>\[ \frac{0.59 + (1.645^2/(2 \times 846)) \pm 1.645 \sqrt{0.59 \times 0.41/846 + 1.645^2/(4 \times 846^2)}}{1 - 1.645^2/846} = 0.589 \pm 0.0278 = (0.5618, 0.6173)  \]</p>

<p><strong>R Note:</strong></p>

<pre><code class="r">prop.test(x = 499, n = 846, conf.level = 0.9, correct = FALSE)
</code></pre>

<pre><code>
    1-sample proportions test without continuity correction

data:  499 out of 846, null probability 0.5
X-squared = 27.31, df = 1, p-value = 1.733e-07
alternative hypothesis: true p is not equal to 0.5
90 percent confidence interval:
 0.5618 0.6173
sample estimates:
     p 
0.5898 
</code></pre>

<pre><code class="r">prop.test(x = 499, n = 846, conf.level = 0.9, correct = FALSE)$conf
</code></pre>

<pre><code>[1] 0.5618 0.6173
attr(,&quot;conf.level&quot;)
[1] 0.9
</code></pre>

<p><strong>Remark</strong></p>

<ul>
<li>This interval is called a Wilson or Wilson score interval (Wilson (1927)).</li>
<li>The center of the score interval is \( (\hat{p} + z_{1 - \alpha/2}^2)/(2n + z_{1 - \alpha/2}^2/n) \). If we set \( \kappa = z_{1 - \alpha/2}^2 \), then the center can be written as \( \hat{p}(n/(n + \kappa)) + (1/2)(\kappa/(n + \kappa)) \), a weighted average of the observed proportions and &frac12;.  As \( n \) increases, more weight is given to \( \hat{p} \).</li>
</ul>

<p><strong>7.4.1 The Agresti-Coull Interval for a Proportion</strong></p>

<p>Now, the limits of the interval given for the score interval are pretty messy, so in general, we would want software to do the calculations.  However, in the event that we must resort to hand calculations, it would be nice to find a simpler expression for the confidence interval.  Agresti and Coull (1998) considered the 95% confidence interval for which the 0.975 quantile is \( z_{0.975} \approx 1.96 \), and hence \( z_{0.975}^2 \approx 4 \).</p>

<p><strong>The AGRESTI-COULL 95% CONFIDENCE INTERVAL FOR A PROPORTION</strong></p>

<p>If \( X \) denotes the number of successes in a sample of size \( n \), let \( \tilde{X} = X = 2, \tilde{n} = n + 4, \) and \( \tilde{p} = \tilde{X}/\tilde{n} \).  Then an approximate 95% confidence interval for \( p \) is</p>

<p>\[ \left(\tilde{p} - 1.96\sqrt{\frac{\tilde{p}(1 - \tilde{p})}{\tilde{n}}},  \tilde{p} + 1.96\sqrt{\frac{\tilde{p}(1 - \tilde{p})}{\tilde{n}}}   \right) \]</p>

<p><strong>Example 7.18</strong>  Suppose the sample size is \( n = 210 \) with \( x = 130 \).  Then \( \tilde{x}=130 + 2=132 \), \( \tilde{n} = 210 + 4 = 214 \), and \( \tilde{p} = 132/214 = \) 0.6168.  Thus an approximate 95% confidence interval is given by</p>

<pre><code class="r">xtilde &lt;- 132
ntilde &lt;- 214
ptilde &lt;- xtilde/ntilde
ptilde + c(-1, 1) * qnorm(0.975) * sqrt(ptilde * (1 - ptilde)/ntilde)
</code></pre>

<pre><code>[1] 0.5517 0.6820
</code></pre>

<pre><code class="r"># Compare to
prop.test(x = 130, n = 210, correct = FALSE)
</code></pre>

<pre><code>
    1-sample proportions test without continuity correction

data:  130 out of 210, null probability 0.5
X-squared = 11.9, df = 1, p-value = 0.0005599
alternative hypothesis: true p is not equal to 0.5
95 percent confidence interval:
 0.5518 0.6820
sample estimates:
    p 
0.619 
</code></pre>

<p><strong>Example 7.19</strong>
A political candidate prepares to conduct a survey to gauge voter support for his candidacy for senator.  He would like a confidence interval with an error of at most 4%, with 95% confidence.  How large should the sample size be for the survey?</p>

<p><strong>Solution</strong> Since the Agresti-Coull interval is symmetric, the margin of error is \( 1.96\sqrt{\tfrac{\tilde{p}(1 - \tilde{p})}{\tilde{n}}} \).  Thus, we want to solve for \( \tilde{n} \) in</p>

<p>\[ 1.96\sqrt{\tfrac{\tilde{p}(1 - \tilde{p})}{\tilde{n}}} \leq 0.04. \] </p>

<p>Unfortunately, we do not know \( \tilde{p} \) &mdash; if we did, the candidate would not need to conduct the survey!  We will use \( \tilde{p}=0.5 \) since this will maximize the expression under the radical sign.  Use calculus to prove this on your own.  </p>

<pre><code class="r">ptilde &lt;- seq(0, 1, length = 1000)
fptilde &lt;- sqrt(ptilde * (1 - ptilde))
plot(ptilde, fptilde, type = &quot;l&quot;, ylab = &quot;&quot;, xlab = expression(tilde(p)))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk maxp" alt="plot of chunk maxp" style="display: block; margin: auto;" /></p>

<p>\[ 1.96\sqrt{\frac{0.5(1 - 0.5)}{\tilde{n}}} \leq 0.04 \]</p>

<p>Solving for \( \tilde{n} \) yields</p>

<p>\[ \left(\frac{1.96(0.5)}{0.04}\right)^2 \leq \tilde{n} \rightarrow \tilde{n}  \geq 600.25 \rightarrow n \geq 596.25. \]</p>

<pre><code class="r">ntilde &lt;- (1.96 * (0.5)/0.04)^2
n &lt;- ntilde - 4
n &lt;- ceiling(n)
n
</code></pre>

<pre><code>[1] 597
</code></pre>

<p>Thus, he should survey at least 597 people.  In some instances, based on prior knowledge, the analyst may substitute another estimate for \( \tilde{p} \) (e.g., the proportion form a previous poll).</p>

<p><strong>Coverage Probabilities of Binomial Confidence Intervals</strong></p>

<p>Suppose a new process for making a prescription drug is in development.  Of \( n = 30 \) trial batches made with the current version of the process, \( X = 24 \) batches give satisfactory results.  Then \( \hat{p} = 24/30 = 0.8 \) estimates the population proportion \( p = P(Success) \) of satisfactory batches with the current version of the process. Wondering how near \( \hat{p} \) might be to \( p \), the investigators use 
\[ 
\hat{p} \pm z_{1-\alpha/2}\sqrt{\frac{\hat{p}\times(1- \hat{p})}{n}} \quad \quad (1)
 \]
to obtain the approximate 95% confidence interval 0.8 \( \pm \) 0.1431 or (0.6569, 0.9431).  The question is whether a 95% level of confidence in the resulting interval is warranted. If (1) is used repeatedly, in what proportion of instances does it yield an interval that covers the true value \( p \)?  If (1) is valid here, then the simple answer ought to be 95%.  Unfortunately, there is no simple answer to this question.  It turns out that the coverage probability depends on the value of \( p \).</p>

<p>In our situation, there are 31 possible values \( 0, 1, , \ldots , 30 \) of \( X \), and thus of \( \hat{p} \).  From (1) we can compute the confidence interval corresponding to each of these 31 possible outcomes, just as we computed the confidence interval (0.6569, 0.9431) corresponding to the outcome \( X = 24 \) above.  </p>

<p>Now choose a particular value of \( p \), say \( p=0.8 \), so that \( X \) has a binomial distribution with \( n=30 \) trials and probability of success (\( p=0.8 \)).  We write this as \( X \sim Bin(n = 30, p = 0.8) \).  The vector of <code>prob</code> of the 31 probabilities \( P(X=x) \) in this distribution is found with the <code>R</code> function <code>dbinom(0:30, 30, 0.8)</code>.  In the <code>R</code> code, we use <code>pp</code> and <code>sp</code> for population proportion and sample proportion respectively.  Next, we determine which of the 31 confidence intervals cover the value \( p = 0.8 \).  Finally, the coverage probability is computed:  It is the sum of the probabilities corresponding to values of \( x \) that yield intervals covering \( p \).</p>

<pre><code class="r">alpha &lt;- 0.05
n &lt;- 30  # number of trials
x &lt;- 0:n
sp &lt;- x/n  # sample proportion
m.err &lt;- qnorm(1 - alpha/2) * sqrt(sp * (1 - sp)/n)
lcl &lt;- sp - m.err
ucl &lt;- sp + m.err
pp &lt;- 0.8  # pp = P(Success)
prob &lt;- dbinom(x, n, pp)
cover &lt;- (pp &gt;= lcl) &amp; (pp &lt;= ucl)  # vector of 0s and 1s
RES &lt;- round(cbind(x, sp, lcl, ucl, prob, cover), 4)
RES[18:31, ]
</code></pre>

<pre><code>       x     sp    lcl    ucl   prob cover
 [1,] 17 0.5667 0.3893 0.7440 0.0022     0
 [2,] 18 0.6000 0.4247 0.7753 0.0064     0
 [3,] 19 0.6333 0.4609 0.8058 0.0161     1
 [4,] 20 0.6667 0.4980 0.8354 0.0355     1
 [5,] 21 0.7000 0.5360 0.8640 0.0676     1
 [6,] 22 0.7333 0.5751 0.8916 0.1106     1
 [7,] 23 0.7667 0.6153 0.9180 0.1538     1
 [8,] 24 0.8000 0.6569 0.9431 0.1795     1
 [9,] 25 0.8333 0.7000 0.9667 0.1723     1
[10,] 26 0.8667 0.7450 0.9883 0.1325     1
[11,] 27 0.9000 0.7926 1.0074 0.0785     1
[12,] 28 0.9333 0.8441 1.0226 0.0337     0
[13,] 29 0.9667 0.9024 1.0309 0.0093     0
[14,] 30 1.0000 1.0000 1.0000 0.0012     0
</code></pre>

<pre><code class="r">sum(dbinom(x[cover], n, pp))  # total coverage prob at pp
</code></pre>

<pre><code>[1] 0.9463
</code></pre>

<p>Thus the total coverage probability for \( p=0.8 \) is \( P(Cover) = P(X = 19) + P(X = 20) + \cdots + P(X = 27)  = \) 0.9463. This is only a little smaller than the claimed value of 95%.  In contrast, a similar computation of \( n = 30 \) and \( p =0.79 \) gives a coverage probability of 0.8876.  This is very far below the claimed coverage of 95%.  The individual binomial probabilities do not change much when \( p \) changes from 0.80 to 0.79.  The main reason for the large change in the coverage probability is that, for \( p = 0.79 \), the confidence interval corresponding to \( x = 27 \) no longer covers \( p \). </p>

<pre><code class="r">alpha &lt;- 0.05
n &lt;- 30  # number of trials
x &lt;- 0:n
sp &lt;- x/n  # sample proportion
m.err &lt;- qnorm(1 - alpha/2) * sqrt(sp * (1 - sp)/n)
lcl &lt;- sp - m.err
ucl &lt;- sp + m.err
pp &lt;- 0.79  # pp = P(Success)
prob &lt;- dbinom(x, n, pp)
cover &lt;- (pp &gt;= lcl) &amp; (pp &lt;= ucl)  # vector of 0s and 1s
RES &lt;- round(cbind(x, sp, lcl, ucl, prob, cover), 4)
RES[18:31, ]
</code></pre>

<pre><code>       x     sp    lcl    ucl   prob cover
 [1,] 17 0.5667 0.3893 0.7440 0.0034     0
 [2,] 18 0.6000 0.4247 0.7753 0.0091     0
 [3,] 19 0.6333 0.4609 0.8058 0.0217     1
 [4,] 20 0.6667 0.4980 0.8354 0.0449     1
 [5,] 21 0.7000 0.5360 0.8640 0.0805     1
 [6,] 22 0.7333 0.5751 0.8916 0.1239     1
 [7,] 23 0.7667 0.6153 0.9180 0.1621     1
 [8,] 24 0.8000 0.6569 0.9431 0.1778     1
 [9,] 25 0.8333 0.7000 0.9667 0.1605     1
[10,] 26 0.8667 0.7450 0.9883 0.1161     1
[11,] 27 0.9000 0.7926 1.0074 0.0647     0
[12,] 28 0.9333 0.8441 1.0226 0.0261     0
[13,] 29 0.9667 0.9024 1.0309 0.0068     0
[14,] 30 1.0000 1.0000 1.0000 0.0008     0
</code></pre>

<pre><code class="r">sum(dbinom(x[cover], n, pp))  # total coverage prob at pp
</code></pre>

<pre><code>[1] 0.8876
</code></pre>

<p>To get a more comprehensive view of the performance of confidence intervals based on formula (1), we step through two thousand values of \( p \) from near 0 to near 1.  For each value of \( p \) we go through a coverage probability and subsequently plot coverage probability versus \( p \).</p>

<pre><code class="r">opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(2, 2))
for (alpha in c(0.01, 0.02, 0.05, 0.1)) {
    n &lt;- 30  # number of trials
    CL &lt;- 1 - alpha
    x &lt;- 0:n
    adj &lt;- 0  #(2 for Agresti-Coull)
    k &lt;- qnorm(1 - alpha/2)
    sp &lt;- (x + adj)/(n + 2 * adj)
    m.err &lt;- k * sqrt(sp * (1 - sp)/(n + 2 * adj))
    lcl &lt;- sp - m.err
    ucl &lt;- sp + m.err
    m &lt;- 2000  # number of values of pp
    pp &lt;- seq(1/n, 1 - 1/n, length = m)
    p.cov &lt;- numeric(m)
    for (i in 1:m) {
        cover &lt;- (pp[i] &gt;= lcl) &amp; (pp[i] &lt;= ucl)  # vector of 0s and 1s
        p.rel &lt;- dbinom(x[cover], n, pp[i])
        p.cov[i] &lt;- sum(p.rel)
    }
    plot(pp, p.cov, type = &quot;l&quot;, ylim = c(0.6, 1.1), main = paste(&quot;n = &quot;, n), xlab = &quot;p&quot;, ylab = &quot;Coverage Probability&quot;)
    lines(c(1/n, 1 - 1/n), c(1 - alpha, 1 - alpha), col = &quot;red&quot;, lty = &quot;dashed&quot;)
    text(0.5, CL + 0.05, paste(&quot;Targeted Confidence Level =&quot;, CL))
}
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAnFBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OTk5OY85ZmU5ZrU5j9plAABlADllAGVlOQBlOTllOWVlOY9lZjllZmVlZrVltf2POQCPOTmPOWWPj7WP27WP2/21ZgC1Zjm1ZmW1j4+124+12/21/rW1/tq1/v3ajznatWXa/rXa/tra/v39tWX924/927X9/rX9/tr9/v3/AABYK1vMAAAANHRSTlP//////////////////////////////////////////////////////////////////wD/9XEwmgAAAAlwSFlzAAALEgAACxIB0t1+/AAAHKJJREFUeJztnQl/27YZxovGcpvUcrItzex2s7ojCZeYms19/+82HCSImyDAA8T7Pr/EEikQxMM/LkEA+UOHAqkf9k4Aah8heKBC8ECF4IEKwQMVggcqBA9UCB6oEDxQIXigQvBAheCBCsEDFYIHKgQPVAgeqBA8UCF4oELwQIXggaow8A0hPz513fWWv8DStt7LAn+9Pb0+vvn6cn/qLjfPe6dmW23sfSfw19tfbsnZ9cnr481zSx66ttoiX4b33cDffKfZu+MVHJW8Di/3NLdz8/R/nSrD+27gz92Fm7dEdzeVgy/B++7gjVzfMde1l/gSvO8O3tJgvuI2vgTvZYFvCd9dd6++DO9lgWeVH9tb9ff4MryX9T0etZkQPFAheKBC8ECF4IEKwQMVggcqBA9UCB6oEDxQIXigQvBAheCBCsEDFYIHKgQPVAgeqBA8UCF4oAqBf7nn03+N6WHkcEq5LtV7D5b46zvHbM+k67in0hJcu/dwVd84JvZXZD6oyr3Pb+MrMr9nVNsIwRcX1TbKAf/6+9DBmeovFKqMBFfsHUv8TlFtIwRfXFTbCMEXF9U2SgPvGcRYKE2backBnEUStKFwAGe2aveOAzg+Ve4d2/idotpGCL64qLYRgi8uqm2E4IuLahsh+OKi2kYIvriottEK4Fs+wOG5Ed8/le/Af/BbOF1viXn/1suPf//wdQzhlvPrdNe9fNBHVi79naJeH9lpxF8jwUsIwTOZF3/Uy0cT/Mv7J4pDyybj4fng25vnlt8brjnRTPAg/loJzheCZxIX/0LIqWvevvnySN78+sQ2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" title="plot of chunk coveragePLOT" alt="plot of chunk coveragePLOT" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
</code></pre>

<p>Next we use Wilson score intervals to do the same thing.</p>

<pre><code class="r">opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(2, 2))
for (alpha in c(0.01, 0.02, 0.05, 0.1)) {
    n &lt;- 30  # number of trials
    CL &lt;- 1 - alpha
    x &lt;- 0:n
    z &lt;- qnorm(1 - alpha/2)
    sp &lt;- x/n
    sptilda &lt;- (x + z^2/2)/(n + z^2)
    m.err &lt;- (z/(n + z^2)) * sqrt(n * sp * (1 - sp) + z^2/4)
    lcl &lt;- sptilda - m.err
    ucl &lt;- sptilda + m.err
    m &lt;- 2000  # number of values of pp
    pp &lt;- seq(1/n, 1 - 1/n, length = m)
    p.cov &lt;- numeric(m)
    for (i in 1:m) {
        cover &lt;- (pp[i] &gt;= lcl) &amp; (pp[i] &lt;= ucl)  # vector of 0s and 1s
        p.rel &lt;- dbinom(x[cover], n, pp[i])
        p.cov[i] &lt;- sum(p.rel)
    }
    plot(pp, p.cov, type = &quot;l&quot;, ylim = c(0.6, 1.1), main = paste(&quot;n = &quot;, n), xlab = &quot;p&quot;, ylab = &quot;Coverage Probability&quot;)
    lines(c(1/n, 1 - 1/n), c(1 - alpha, 1 - alpha), col = &quot;red&quot;, lty = &quot;dashed&quot;)
    text(0.5, CL + 0.05, paste(&quot;Targeted Confidence Level =&quot;, CL))
}
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAnFBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OTk5OY85ZmU5ZrU5j9plAABlADllAGVlOQBlOTllOWVlOY9lZjllZmVlZrVltf2POQCPOTmPOWWPj7WP27WP2/21ZgC1Zjm1ZmW1j4+124+12/21/rW1/tq1/v3ajznatWXa/rXa/tra/v39tWX924/927X9/rX9/tr9/v3/AABYK1vMAAAANHRSTlP//////////////////////////////////////////////////////////////////wD/9XEwmgAAAAlwSFlzAAALEgAACxIB0t1+/AAAGYVJREFUeJztnQtjmzjWhldtnJl24jT7bacbz+yG2Usbtg1eW/v//9unC7qBEAInQj7nPG0SG4uDXl4kZCHBnziBkj9tnQFiG8h4pJDxSCHjkULGI4WMRwoZjxQyHilkPFLIeKSQ8Ugh45FCxiOFjEcKGY8UMh4pZDxSyHikkPFIIeORUpnxLWPvnjg/3qo/uCirvS7jj7e78+H98+l+x5ubl61zU5bC2jcy/nj7yy3bxz45H25eOvbIO7BFvg7tmxl/80Mc3lxVcAK7H0734mhX4sUPTOrQvpnxe94o8SPE4ha48TVo39z4wVHPpWroJb4G7ZsbP8KIB3yOr0F7XcZ3TC2G3aqvQ3tdxsvKTy4F/T2+Du11fY8nikHGI4WMRwoZjxQyHilkPFLIeKSQ8Ugh45FCxiOFjEcKGY8UMh4pZDxSyHikkPFIIeORQsYjhYxHSsr4070a/jsYHsaujjX7Bbz2ZIk/foyM9ly1H7dkXYaha09X9W1kYD8g8UmAa19+jgckfstQZSDjqwtVhkuMP/9uGjhz7YVKuSDDgLVTid8oVBnI+OpClYGMry5UGdYZP9GJ8Up5KsZrduC8SoYKQh04i4GunTpwpgCunc7xG4UqAxlfXagykPHVhSoDGV9dqDKQ8dWFKgMZX12oMryB8Z3q4Ji4Ed8/ve/Af6hbOB1v2fD+rc27vz88uxRxol+nOT89hD0rTX+nqPNBbkb/HmT4NSDjJcOd7zh9Hhp/+vQk7AgOE7f65cZ3Ny+dujdcuxMHwaP+Pcrw5ZDxEr3zG8Z2vP3w/tuBvf/1Sb7di187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" title="plot of chunk WilsonCover" alt="plot of chunk WilsonCover" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
</code></pre>

<p>Next consider the Agresti-Coull confidence intervals.</p>

<pre><code class="r">opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(2, 2))
for (alpha in c(0.01, 0.02, 0.05, 0.1)) {
    n &lt;- 30  # number of trials
    CL &lt;- 1 - alpha
    x &lt;- 0:n
    adj &lt;- 2  # 0 for large sample 2 for Agresti Coull
    z &lt;- qnorm(1 - alpha/2)
    sp &lt;- (x + adj)/(n + 2 * adj)
    m.err &lt;- z * sqrt(sp * (1 - sp)/(n + 2 * adj))
    lcl &lt;- sp - m.err
    ucl &lt;- sp + m.err
    m &lt;- 2000  # number of values of pp
    pp &lt;- seq(1/n, 1 - 1/n, length = m)
    p.cov &lt;- numeric(m)
    for (i in 1:m) {
        cover &lt;- (pp[i] &gt;= lcl) &amp; (pp[i] &lt;= ucl)  # vector of 0s and 1s
        p.rel &lt;- dbinom(x[cover], n, pp[i])
        p.cov[i] &lt;- sum(p.rel)
    }
    plot(pp, p.cov, type = &quot;l&quot;, ylim = c(0.6, 1.1), main = paste(&quot;n = &quot;, n), xlab = &quot;p&quot;, ylab = &quot;Coverage Probability&quot;)
    lines(c(1/n, 1 - 1/n), c(1 - alpha, 1 - alpha), col = &quot;red&quot;, lty = &quot;dashed&quot;)
    text(0.5, CL + 0.05, paste(&quot;Targeted Confidence Level =&quot;, CL))
}
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAnFBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OTk5OY85ZmU5ZrU5j9plAABlADllAGVlOQBlOTllOWVlOY9lZjllZmVlZrVltf2POQCPOTmPOWWPj7WP27WP2/21ZgC1Zjm1ZmW1j4+124+12/21/rW1/tq1/v3ajznatWXa/rXa/tra/v39tWX924/927X9/rX9/tr9/v3/AABYK1vMAAAANHRSTlP//////////////////////////////////////////////////////////////////wD/9XEwmgAAAAlwSFlzAAALEgAACxIB0t1+/AAAGSlJREFUeJztnQuD2yYWhUsynjbpeJJu0+y43R11H8lok5HXZv//f1seAoEE6GEboXvv145jy/iKowMISSD9wAmU/LB2Boh1IOORQsYjhYxHChmPFDIeKWQ8Ush4pJDxSCHjkULGI4WMRwoZjxQyHilkPFLIeKSQ8Ugh45FCxiOFjEdKYcbXjL155vx4r/7BRV7tZRl/vN+dD29fTo87Xt29rp2bvGTWvpLxx/uf79k+9M35cPfasCfegK3yZWhfzfi776J4c9XACex2OD2K0q7Eiz+YlKF9NeP3vFLiB4jFNXDjS9C+uvG9Us+laug1vgTtqxs/wIgHvI8vQXtZxjdMLYbdqy9De1nGy8ZPLgV9HF+G9rKO44lskPFIIeORQsYjhYxHChmPFDIeKWQ8Ush4pJDxSCHjkULGI4WMRwoZjxQyHilkPFLIeKSQ8Ugh45GSMv70qIb/9oaHsc2xZLuA156s8cf3gdGei7bjmizLMHTt6aa+DgzsByQ+CXDt8/fxgMSvGSoPZHxxofJwifHnP0wHZ6y/UCgXZBiwdqrxK4XKAxlfXKg8kPHFhcrDMuMjJzGulKdsXPMEzlUylBE6gTMb6NrpBE4M4NppH79SqDyQ8cWFygMZX1yoPJDxxYXKAxlfXKg8kPHFhcrDDYxv1AmOyI34/ukcA/+pbuF0vGf9+7dWb/7+8aVLESZ4OM356aN/ZqVq7xR1PsjV6Ndehq8BGS/pb/yO06e+8acPz8IOr5h0P7/c+ObutVH3hqt3ohA86ddBhi+HjJfojV8xtuP1u7dfD+ztb8/y41687PQb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" title="plot of chunk ACCover" alt="plot of chunk ACCover" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
</code></pre>

<p><strong>7.5 BOOTSTRAP \( t \) CONFIDENCE INTERVALS</strong></p>

<p>The bootstrap percentile confidence interval for giving a range of plausible values for a parameter was introduced earlier.  Another confidence interval is the bootstrap \( t \) interval that is based on estimating the actual distribution of the \( t \) statistic from the data, rather than just assuming that the \( t \) statistic has a Student&#39;s \( t \) distribution.</p>

<p>Recall the Bangladesh arsenic levels data.  The distribution of arsenic levels was skewed right.</p>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/Bangladesh.csv&quot;
Bangladesh &lt;- read.csv(file = url(site))
head(Bangladesh)
</code></pre>

<pre><code>  Arsenic Chlorine Cobalt
1    2400      6.2   0.42
2       6    116.0   0.45
3     904     14.8   0.63
4     321     35.9   0.68
5    1280     18.9   0.58
6     151      7.8   0.35
</code></pre>

<pre><code class="r">ggplot(data = Bangladesh, aes(x = Arsenic)) + geom_histogram()
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk BangladeshA" alt="plot of chunk BangladeshA" style="display: block; margin: auto;" /></p>

<p>To use the \( t \) interval formula for the mean \( \mu \) requires that the statistic \( T = (\bar{x} - \mu)/(S/\sqrt{n}) \) to follow a \( t_{\nu} \). That seems unlikely for data this skewed. Instead, we bootstrap the \( t \) statistic: for each of the \( 10^5 \) resamples, we compute the resample mean \( \bar{X}^* \), resample standard deviation \( S^* \), and then compute the resample \( T \) statistic \( T^* = (\bar{X}^* - \bar{x})/(S^*/\sqrt{n}) \)</p>

<pre><code class="r">Arsenic &lt;- subset(Bangladesh, select = Arsenic, drop = T)
xbar &lt;- mean(Arsenic)
S &lt;- sd(Arsenic)
N &lt;- 10^5
n &lt;- length(Arsenic)
Tstar &lt;- numeric(N)
Sstar &lt;- numeric(N)
Xbarstar &lt;- numeric(N)
set.seed(13)
for (i in 1:N) {
    x &lt;- sample(Arsenic, size = n, replace = T)
    Xbarstar[i] &lt;- mean(x)
    Sstar[i] &lt;- sd(x)
}
Tstar &lt;- (Xbarstar - xbar)/(Sstar/sqrt(n))
CIt &lt;- quantile(Tstar, c(0.025, 0.975))
names(CIt) &lt;- NULL
CIt
</code></pre>

<pre><code>[1] -2.648  1.656
</code></pre>

<pre><code class="r">opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(2, 2))
plot(Xbarstar, Sstar, ylab = &quot;S*&quot;, xlab = substitute(paste(bar(X), &quot;*&quot;)), col = rgb(1, 0, 0, 0.01))
qqnorm(Tstar, col = rgb(1, 0, 0, 0.01))
qqline(Tstar)
hist(Tstar, xlab = &quot;T*&quot;, main = &quot;Bootstrap distribution of T*&quot;, col = &quot;red&quot;, breaks = &quot;Scott&quot;)
hist(Xbarstar, xlab = substitute(paste(bar(X), &quot;*&quot;)), main = substitute(paste(&quot;Bootstrap Distribution of &quot;, 
    bar(X), &quot;*&quot;)), col = &quot;red&quot;, breaks = &quot;Scott&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAACalBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OTk5OWU5OY85ZmU5ZrU5j485j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVlZrVltdpltf2POQCPOTmPOWWPZgCPZo+PjzmPj2WPj7WPtY+P29qP2/21ZgC1Zjm1ZmW1jzm1j4+1tWW124+1/rW1/tq1/v3ajznaj2XatWXa24/a29ra/rXa/tra/v39Kir9Kyv9LCz9LS39Li79Ly/9MDD9MTH9MjL9MzP9NDT9NTX9Njb9Nzf9ODj9OTn9Ojr9Ozv9PDz9PT39Pj79Pz/9QED9QUH9QkL9Q0P9RET9RUX9Rkb9R0f9SEj9SUn9Skr9S0v9TEz9TU39Tk79T0/9UFD9UVH9UlL9U1P9VFT9VVX9Vlb9V1f9WFj9WVn9Wlr9W1v9XFz9XV39Xl79X1/9YGD9YWH9YmL9Y2P9ZGT9ZWX9Zmb9Z2f9aGj9aWn9amr9a2v9bGz9bW39bm79b2/9cHD9cXH9cnL9c3P9dHT9dXX9dnb9d3f9eHj9eXn9enr9e3v9fHz9fX39fn79gH/9goH9hIP9hoX9iIf9ion9jIv9jo39kI/9kpH9lJP9lpX9mJf9mpn9nJv9np39oJ/9oqH9pKP9pqX9qKf9qqn9rKv9rq39sK/9srH9tLP9tWX9trX9uLf9urn9vLv9vr39wL/9wsH9xMP9xsX9yMf9ysn9zMv9zs390M/90tH91NP919b92tn924/93dz94N/94+L95uX96ej97Ov97+798vH99fT9+Pf9+/r9/rX9/tr9/v3/AAB6Ta/aAAAAznRSTlP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/+sgs5MAAAAJcEhZcwAACxIAAAsSAdLd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" title="plot of chunk BOOTarsenic" alt="plot of chunk BOOTarsenic" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(opar)
</code></pre>

<p>Note that the bootstrap distribution for the \( t \) statistic is left skewed; in fact, it is more left skewed than the the bootstrap distribution of the mean is right skewed! The reason for this is the strong positive relationship between \( \bar{X}^* \) and \( S^* \).  If a bootstrap resample contains a large number of the big values from the right tail of the original data, then \( \bar{X}^* \) is large and hence \( S^* \) is especially large (standard deviations are computed by squaring distances from the mean, so they are affected even more by large observations than a mean is).  The large denominator thus keeps \( T^* \) from being particularly large.  Conversely, when there are relatively few of the big observations in the resample, then \( \bar{X}^* - \bar{x} \) is negative and the denominator can be especially small, thus resulting in a \( T \) ratio that is large negative. </p>

<p>The 2.5% and 97.5% percentiles of the bootstrap \( t \) distribution are -2.6476 and 1.6562, compared to \( \pm \) 1.9688 for the Student&#39;s \( t \) distribution.  This is a reflection of the skewed nature of the bootstrap \( t \) distribution compared to the symmetric Student&#39;s \( t \) distribution.</p>

<p>Before proceeding with the bootstrap \( t \), let us think about what skewness implies for the accuracy of the formula-based \( t \) confidence intervals \( (\bar{X} \pm t_{1 - \alpha/2, \nu} \times S/\sqrt{n}) \).  For right-skewed data, when \( \bar{X} < \mu \), typically \( S < \sigma \), so the confidence interval tends to be narrow, and the interval falls below \( \mu \) more often than \( \alpha/2 \times 100\% \) of the time.  This is bad.  Conversely, when \( \bar{X} > \mu \), typically \( S > \sigma \), so the intervals tend to be to wide and do not miss \( \mu \) often enough; this is also bad.  Overall, the intervals tend to be to the left of where they should be and give a biased picture of where the mean is likely to be.</p>

<p>We return to the bootstrap \( t \) and consider samples from nonnormal populations.  Let \( T = (\bar{X} - \mu)/(S/\sqrt{n}) \) and \( F \) be the cdf for the \( T \) statistic (the cdf of the sampling distribution).  Let \( Q_1 \) and \( Q_2 \) denote the \( \alpha/2 \) and \( (1 - \alpha/2) \) quantiles of this distribution; that is, \( Q_1 = F^{-1}(\alpha/2) \) and \( Q_2 = F^{-1}(1 - \alpha/2) \).  Then</p>

<p>\[ 1 - \alpha = P(Q_1 < T < Q_2)=P\left(Q_1 < \frac{\bar{X} - \mu}{S/\sqrt{n}} < Q_2 \right). \]</p>

<p>This suggest the confidence interval:</p>

<p>\[ CI_{1 - \alpha}(\mu) = \left(\bar{X} - Q_2\frac{S}{\sqrt{n}}, \bar{X} - Q_1\frac{S}{\sqrt{n}}  \right). \]</p>

<p>The quantiles \( Q_1 \) and \( Q_2 \) are unknown, but they can be estimated using quantiles of the bootstrap distribution of the \( t \) statistic:</p>

<p>\[ T^* = \frac{\bar{X}^* - \bar{x}}{S^*/\sqrt{n}}, \]</p>

<p>where \( \bar{X}^* \) and \( S^* \) are the mean and standard deviation of a bootstrap resample.  We use the standard error formula for every bootstrap sample because the bootstrap statistic should mimic \( T = (\bar{X} -\mu)/(S/\sqrt{n}) \). </p>

<p>Thus \( Q_1= \) -2.6476 and \( Q_2= \) 1.6562, so we compute</p>

<pre><code class="r">LL &lt;- xbar - CIt[2] * S/sqrt(n)
UL &lt;- xbar - CIt[1] * S/sqrt(n)
c(LL, UL)
</code></pre>

<pre><code>[1]  95.34 173.24
</code></pre>

<p>The 95% bootstrap percentile interval is (92.3224, 163.2506) while the formula \( t \) confidence interval is (89.6834, 160.9564).  The bootstrap \( t \) interval is stretched further to the right, reflecting the right-skewed distribution of the data.  Because of the large sample size, we report the 95% bootstrap \( t \) confidence interval (95.3418, 173.2431) \( \mu \) g/dL.</p>

<p><strong>Using the package <code>boot</code></strong></p>

<p>Next we consider computing the bootstrap percentile and \( t \) confidence intervals using the functions <code>boot()</code> and <code>boot.ci()</code> functions from the package <code>boot</code>. We write the function <code>mean.boot()</code> and use <code>mean.boot()</code> inside the <code>boot()</code> function storing the results in the object <code>boot.out</code>.  Finally, the function <code>boot.ci()</code> is applied to <code>boot.out</code> which results in the creation of the percentile and 
confidence intervals.</p>

<pre><code class="r">require(boot)
mean.boot &lt;- function(data, i) {
    d &lt;- data[i]
    M &lt;- mean(d)
    V &lt;- var(d)/length(i)
    return(c(M, V))
}
boot.out &lt;- boot(Arsenic, mean.boot, R = 10^5)
boot.ci(boot.out, conf = 0.95, type = c(&quot;perc&quot;, &quot;stud&quot;))
</code></pre>

<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 100000 bootstrap replicates

CALL : 
boot.ci(boot.out = boot.out, conf = 0.95, type = c(&quot;perc&quot;, &quot;stud&quot;))

Intervals : 
Level    Studentized          Percentile     
95%   ( 95.4, 173.3 )   ( 92.4, 163.1 )  
Calculations and Intervals on Original Scale
</code></pre>

<pre><code class="r">plot(boot.out)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAD8CAMAAACsEEbvAAAAmVBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlOY9lZgBlZjllZmVltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna/rXa/tra/v39tWX9tY/924/9/rX9/tr9/v2UKUQ2AAAAM3RSTlP//////////////////////////////////////////////////////////////////wBxnr2OAAAACXBIWXMAAAsSAAALEgHS3X78AAANeUlEQVR4nO2dDX/bthGHC7vJ5LbZrDbdJjtbV6tLzdaaLH7/Dze8kSIlAjwSbwfd/X9ObFMAdMSjAw4AAX/Tskjqm9IGsMqIwRMVgycqBk9UDJ6oGDxRMXiiYvBExeCJisETFYMnKgZPVAyeqBg8UTF4omLwRMXgiYrBExWDJyoGT1QMnqgYPFExeKJi8ETF4IkqJfj37f1r256e7l/NT532u4BCjw/i7iW8GPLKA350eS9CiPW5w4ohr4weL31V3L+enoQQm7Zt5LfHVr0s7r9uP76dnu7+IX35IC9Ljz6Iv8jrrzJRR9ek17k/vrVtVwxrpfKBf98KBe1PQ2yvfpHfNcBvHxR49eofJtHbQXSyzYVNz+BjKS34jp0Cf3xQwFrTRh8fpFu/b+9ejg+SbCM0+E2X7f71IFQGsVNJ1LU+PTf1kZQPvP5N+a8idtCUG7HTP7ybpv6ly6TAb/QHoLvap2fwkZS5jxfWZ13gdZoe/PnjwOBjK/Nwbm/RTTX1CnEjAzh16RI8N/WxlQ9858wqTpsM7hTig5j2+D79EDwHdwHK3NTb5lyGed1wTvbp3XBOIZY4H20PMALfp+/Bm2JYK4ViyvbACLOrNHgb+T8WNoOeSoM3vTp31tlVHDyrjBg8UTF4omLwRMXgiYrBExWDJyoGT1QMnqgYPFExeKJi8ETF4ImKwRMVgycqBk9UDJ6oGDxRMXiiYvBExeDXSeCX/wYYvE9m94+4ONlBaaZaESgYvPvmb16nJ7Nr53C93wMr+LOzh4L33Hw0Ya3F959eR98HQmqyxa6sCwXvuflwwT6cxVSZ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" title="plot of chunk packageboot" alt="plot of chunk packageboot" style="display: block; margin: auto;" /></p>

<pre><code class="r">hist(boot.out$t[, 1], col = &quot;pink&quot;, breaks = &quot;Scott&quot;, main = &quot;&quot;, xlab = substitute(paste(bar(X), &quot;*&quot;)), 
    freq = FALSE)
lines(density(boot.out$t[, 1]), lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk packageboot" alt="plot of chunk packageboot" style="display: block; margin: auto;" /></p>

<pre><code class="r">hist((boot.out$t[, 1] - boot.out$t0[1])/(boot.out$t[, 2])^0.5, col = &quot;pink&quot;, breaks = &quot;Scott&quot;, main = &quot;&quot;, 
    xlab = &quot;T*&quot;, freq = FALSE)
lines(density((boot.out$t[, 1] - boot.out$t0[1])/(boot.out$t[, 2])^0.5), lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk packageboot" alt="plot of chunk packageboot" style="display: block; margin: auto;" /></p>

<p>The bootstrap intervals for a difference in means follows the same idea.</p>

<p><strong>BOOTSTRAP \( t \) CONFIDENCE INTERVAL FOR \( \mu_1 - \mu_2 \)</strong>
 For each of many resamples, calculate the bootstrap \( t \) statistic</p>

<p>\[ T^* = \frac{\bar{X_1}^*- \bar{X_2}^* -(\bar{x_1} -\bar{x_2})}{\sqrt{S^{2*}_1/n_1 + S^{2*}_2/n_2}}, \]</p>

<p>Let \( Q^*_1 \) and \( Q^*_2 \) be the empirical \( \alpha/2 \) and \( (1 - \alpha/2) \) quantiles of the bootstrap \( t \) distribution, respectively.  The bootstrap \( t \) confidence interval is</p>

<p>\[ \left( (\bar{x_1} - \bar{x_2}) - Q^*_2 \times \sqrt{s_1^2/n_1 + s_2^2/n_2} , (\bar{x_1} - \bar{x_2}) - Q^*_1 \times \sqrt{s_1^2/n_1 + s_2^2/n_2} \right).  \] </p>

<p>Recall the Verizon example, where we considered the difference in means of two very skewed distributions of repair times for two very unbalanced samples (\( n_1 = 23 \) versus \( n_2 = 1664 \)).  Let us look at the data again.  </p>

<pre><code class="r">site &lt;- &quot;http://www1.appstate.edu/~arnholta/Data/Verizon.csv&quot;
Verizon &lt;- read.csv(file = url(site))
Time.ILEC &lt;- subset(Verizon, select = Time, Group == &quot;ILEC&quot;, drop = TRUE)
Time.CLEC &lt;- subset(Verizon, select = Time, Group == &quot;CLEC&quot;, drop = TRUE)
thetahat &lt;- mean(Time.ILEC) - mean(Time.CLEC)
nx &lt;- length(Time.ILEC)  #nx=1664
ny &lt;- length(Time.CLEC)  #ny=23
SE &lt;- sqrt(var(Time.ILEC)/nx + var(Time.CLEC)/ny)
N &lt;- 10^4
Tstar &lt;- numeric(N)
DM &lt;- numeric(N)
set.seed(1)
for (i in 1:N) {
    bootx &lt;- sample(Time.ILEC, nx, replace = TRUE)
    booty &lt;- sample(Time.CLEC, ny, replace = TRUE)
    Tstar[i] &lt;- (mean(bootx) - mean(booty) - thetahat)/sqrt(var(bootx)/nx + var(booty)/ny)
    DM[i] &lt;- mean(bootx) - mean(booty)
}
CItboot &lt;- thetahat - quantile(Tstar, c(0.975, 0.025)) * SE
names(CItboot) &lt;- NULL
CItboot
</code></pre>

<pre><code>[1] -22.375  -2.222
</code></pre>

<pre><code class="r">CIperct &lt;- quantile(DM, c(0.025, 0.975))
CIperct
</code></pre>

<pre><code>   2.5%   97.5% 
-16.644  -1.596 
</code></pre>

<pre><code class="r">t.test(Time.ILEC, Time.CLEC)$conf
</code></pre>

<pre><code>[1] -16.5569   0.3619
attr(,&quot;conf.level&quot;)
[1] 0.95
</code></pre>

<p>The 95% bootstrap \( t \) interval for the difference in means is (-22.3752, -2.2218).  For comparison, the formula \( t \) interval is (-16.5569, 0.3619) and the bootstrap percentile interval is (-16.6445, -1.5959).  The more accurate bootstrap \( t \) interval stretches farther in the negative direction, even more than the bootstrap percentile interval.</p>

<p>The same basic procedure can also be used for confidence intervals for statistics other than one or two means&mdash;to compute a \( t \) statistic for each of many resamples, using the appropriate standard error for \( \hat{\theta} \), find the quantiles of that bootstrap \( t \) distribution and create an estimate of the form \( (\hat{\theta} - Q^*_2 \times SE, \hat{\theta} - Q^*_1 \times SE). \)</p>

<p><strong>Using the package <code>boot</code> for the difference in means</strong></p>

<p>Bootstrap percentile and \( t \) confidence intervals using the functions <code>boot()</code> and <code>boot.ci()</code> functions from the package <code>boot</code> are constructed using the user created <code>mean2.boot()</code> function.</p>

<pre><code class="r">require(boot)
mean2.boot &lt;- function(data, i) {
    d &lt;- data[i, ]
    M &lt;- tapply(d$Time, d$Group, mean)
    V &lt;- tapply(d$Time, d$Group, var)/tapply(d$Time, d$Group, length)
    return(c(M[2] - M[1], V[2] + V[1]))
}
set.seed(1)
boot.out &lt;- boot(Verizon, mean2.boot, R = 10^4)
boot.ci(boot.out, conf = 0.95, type = c(&quot;perc&quot;, &quot;stud&quot;))
</code></pre>

<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 10000 bootstrap replicates

CALL : 
boot.ci(boot.out = boot.out, conf = 0.95, type = c(&quot;perc&quot;, &quot;stud&quot;))

Intervals : 
Level    Studentized          Percentile     
95%   (-22.686,  -2.130 )   (-17.260,  -1.536 )  
Calculations and Intervals on Original Scale
</code></pre>

<pre><code class="r">plot(boot.out)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk packageboot2m" alt="plot of chunk packageboot2m" style="display: block; margin: auto;" /></p>

<pre><code class="r">hist(boot.out$t[, 1], col = &quot;pink&quot;, breaks = &quot;Scott&quot;, main = &quot;&quot;, freq = FALSE, xlab = substitute(paste(bar(x)[1], 
    &quot;* - &quot;, bar(x)[2], &quot;*&quot;)))
lines(density(boot.out$t[, 1]), lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk packageboot2m" alt="plot of chunk packageboot2m" style="display: block; margin: auto;" /></p>

<pre><code class="r">qqnorm(boot.out$t[, 1], col = rgb(1, 0, 0, 0.05))
qqline(boot.out$t[, 1])
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAABQVBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlZgBlZjlltf2POQCPOTmPZgCPj2WP29qP2/21ZgC1tWW124+1/rW1/v3ajznatWXa24/a/rXa/v39CQn9Cgr9Cwv9DAz9DQ39Dg79Dw/9EBD9ERH9EhL9ExP9FBT9FRX9Fhb9Fxf9GBj9GRn9Ghr9Gxv9HBz9HR39Hx/9ISH9IyP9JSX9Jyf9KSn9Kyv9LS39Ly/9MjL9NTX9ODj9Ozv9Pj79QUH9RET9SEj9TEz9UFD9VFT9WFj9XV39YmL9Z2f9bW39c3P9eXn9gID9h4f9jo79lpb9np79p6f9sLD9tWX9tY/9ubn9w8P9zs392dj924/929r95eT98fD9/rX9/tr9/v1Z5if1AAAAa3RSTlP/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AHiZReEAAAAJcEhZcwAACxIAAAsSAdLdfvwAABC2SURBVHic7Z2NQ9vGFcAn2Cg0zaBpB9mK1+G1KM13UkJZkiZNSCAJEBwD/rZnSZ4F+v//gN2dPiwZWT7ppKev90scY0t6J/14eTrbp/OfDASEP6W9A2UBRQOBooFA0UCgaCBQNBAoGggUDQSKBgJFA4GigUDRQKBoIFA0ECgaCBQNBIoGAkUDgaKBQNFAoGggUDQQKBoIFA0EigYiQ6Iv16R1w7jaWNziWtle7WpDkqSlbWeJ5zGJSVl3rc+orMe225xkSzTxE1b0aIWpXNi0FngfW6IXNr2iK1LJRUurluiqRH8mDxb+Ji38Q/pqQ1rcqtLMNAamRVscyd9lg5qzcnjq8eUava9Iq+b6ZliW88vAR5cp0YvfL24x0RWWh8tWGfi3ZLO4Zabo0rYterTCjJLfiJnCU4+9oq2wKHrxx5VVKnq0wnJ2YdPMz4FEn5LW6TPWilu26IFlzC4GU489pcMJW/rSsbhVWfiBiDZtVaV1MzHpQ7rQfETd+Yqm1Zlkv49oq9Q4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" title="plot of chunk packageboot2m" alt="plot of chunk packageboot2m" style="display: block; margin: auto;" /></p>

<pre><code class="r"># ggplot2 Now
require(ggplot2)
BO &lt;- as.data.frame(boot.out$t)
ggplot(data = BO, aes(x = V1, y = ..density..)) + geom_histogram(fill = &quot;pink&quot;) + xlab(substitute(paste(bar(x)[1], 
    &quot;* - &quot;, bar(x)[2], &quot;*&quot;))) + geom_density(size = 1.5, color = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk packageboot2m" alt="plot of chunk packageboot2m" style="display: block; margin: auto;" /></p>

<pre><code class="r">p &lt;- ggplot(data = BO, aes(sample = V1)) + stat_qq(pch = &quot;.&quot;, color = rgb(1, 0, 0, 0.1))
p
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk packageboot2m" alt="plot of chunk packageboot2m" style="display: block; margin: auto;" /></p>

<pre><code class="r">hist((boot.out$t[, 1] - boot.out$t0[1])/(boot.out$t[, 2])^0.5, col = &quot;pink&quot;, breaks = &quot;Scott&quot;, main = &quot;&quot;, 
    xlab = &quot;T*&quot;, freq = FALSE)
lines(density((boot.out$t[, 1] - boot.out$t0[1])/(boot.out$t[, 2])^0.5), lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk packageboot2m" alt="plot of chunk packageboot2m" style="display: block; margin: auto;" /></p>

<pre><code class="r">qqnorm((boot.out$t[, 1] - boot.out$t0[1])/(boot.out$t[, 2])^0.5, col = rgb(1, 0, 0, 0.05))
qqline((boot.out$t[, 1] - boot.out$t0[1])/(boot.out$t[, 2])^0.5)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAABQVBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlZgBlZjlltf2POQCPOTmPZgCPj2WP29qP2/21ZgC1tWW124+1/rW1/v3ajznatWXa24/a/rXa/v39CQn9Cgr9Cwv9DAz9DQ39Dg79Dw/9EBD9ERH9EhL9ExP9FBT9FRX9Fhb9Fxf9GBj9GRn9Ghr9Gxv9HBz9HR39Hx/9ISH9IyP9JSX9Jyf9KSn9Kyv9LS39Ly/9MjL9NTX9ODj9Ozv9Pj79QUH9RET9SEj9TEz9UFD9VFT9WFj9XV39YmL9Z2f9bW39c3P9eXn9gID9h4f9jo79lpb9np79p6f9sLD9tWX9tY/9ubn9w8P9zs392dj924/929r95eT98fD9/rX9/tr9/v1Z5if1AAAAa3RSTlP/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AHiZReEAAAAJcEhZcwAACxIAAAsSAdLdfvwAABEhSURBVHic7Z0JQ9tGFoAr2KXQNAtNu5Dd4u3ibZmkuRMaaNqEYCAkIdzYxudaklcC/f8fsDMj2ZaNbI800tP1vgZsyXiOj+nTkxmNvrIQEL6KuwF5AUUDgaKBQNFAoGggUDQQKBoIFA0EigYCRQOBooFA0UCgaCBQNBAoGggUDQSKBgJFA4GigUDRQKBoIFA0ECgaCBQNBIoGIkGir5eUZcu6WZldE/rh3o/drCiKMrfef2Vom5bJWHb9PKewHFqzBUmWaOrHr+juAlc5s+q8MLztiJ5ZHRZdUHIuWll0RBcV9pxuzPxdmfmn8vWKMrtWZCPTatsWe+Lo+J23mDlnDI9sXy+xx4KyaP+8XSwf8/PAvUuU6NkfZte46AIfh/NOGPiP0mN2zR6ic+s90d0FbpT+RuwhPLI9LNopFkXP/rSwyER3F/iYnVm1x2dbYbuUZbbH+cG1nui2Y6wXDEa2h0JHv9jch47ZtcLMj1S0bauoLNsDk22yF+0t5s5TNIvOdPR7iHZC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" title="plot of chunk packageboot2m" alt="plot of chunk packageboot2m" style="display: block; margin: auto;" /></p>

<p><strong>7.5.1 Comparing Bootstrap \( t \) and Formula \( t \) Confidence Intervals</strong>
It is useful to compare the bootstrap distribution to classical statistical inferences.  With classical \( t \) intervals of the form \( \bar{x} \pm t \times s/\sqrt{n}, \) the confidence interval width varies substantially in small samples as the sample standard deviation \( s \) varies.  Correspondingly, the classical standard error \( s/\sqrt{n} \) varies as \( s \) varies.  The bootstrap is no different in this regard &mdash;bootstrap standard errors and widths of confidence intervals for the mean are proportional to \( s \).</p>

<p>Where the bootstrap does differ from classical inference is in how it handles skewness.  The bootstrap percentile interval and bootstrap \( t \) interval are in general asymmetrical, with asymmetry depending on the sample.  These intervals estimate the skewness of a population from the skewness of the sample.  In contrast, classical \( t \) intervals assume that the population has no underlying skewness (skewness is 0).</p>

<p>Which is preferred?  Frankly, neither, but rather something in between.  This is an area that needs attention from statistical researchers.  Until then, we will recommend the formula \( t \) if \( n \leq 10 \), and the bootstrap \( t \) otherwise; the reason being in large samples, we should put more trust in the data&mdash;in this case, the bootstrap \( t \) is preferred.  In small samples, the classical procedure is probably better&mdash;if the sample size is small then skewness cannot be estimated accurately from the sample, and it may be better to assume that there is no skewness (skewness is 0) in spite of the bias, rather than to use an estimate that has high variability.  Something between classical intervals and the bootstrap procedures would be best&mdash;something that makes a trade-off between bias and variance and transitions smoothly from being like the formula \( t \) for small \( n \) and bootstrap \( t \) for large \( n \).</p>

<p>The bootstrap percentile makes less of a skewness correction than does the bootstrap \( t \).  Hence, for smaller samples, it is less variable than the bootstrap \( t \).  For larger samples, the bootstrap \( t \) is preferred.  In the long run, increasing the sample size by a factor of 10 reduces the coverage errors of the bootstrap \( t \) intervals by a factor of 10 but reduces the errors of symmetric formula intervals and the bootstrap percentile interval only by a factor of \( \sqrt{10} \).</p>

<p>For comparing two samples, if the sample sizes are equal or nearly equal, you may use the formula \( t \) for every sample size unless there is reason to believe that the skewness differs between the two populations.  However, it is good to also do the bootstrap \( t \) interval except for small samples.</p>

<p><strong>Skewness</strong></p>

<p>You could write your own function to compute skewness or use one that has already been written.  The function <code>skewness()</code> in the <code>e1071</code> package will work just fine for your homework.</p>

<pre><code class="r">require(e1071)
skewness(Verizon$Time)
</code></pre>

<pre><code>[1] 4.522
</code></pre>

</body>

</html>

